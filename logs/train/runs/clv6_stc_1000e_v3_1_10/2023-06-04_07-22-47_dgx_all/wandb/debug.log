2023-06-04 07:22:52,022 INFO    MainThread:3847581 [wandb_setup.py:_flush():76] Configure stats pid to 3847581
2023-06-04 07:22:52,023 INFO    MainThread:3847581 [wandb_setup.py:_flush():76] Loading settings from /root/.config/wandb/settings
2023-06-04 07:22:52,023 INFO    MainThread:3847581 [wandb_setup.py:_flush():76] Loading settings from /workspace/slotaug/wandb/settings
2023-06-04 07:22:52,023 INFO    MainThread:3847581 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2023-06-04 07:22:52,023 INFO    MainThread:3847581 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2023-06-04 07:22:52,023 INFO    MainThread:3847581 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'src/train.py', 'program': 'src/train.py'}
2023-06-04 07:22:52,023 INFO    MainThread:3847581 [wandb_setup.py:_flush():76] Applying login settings: {'mode': 'offline'}
2023-06-04 07:22:52,023 INFO    MainThread:3847581 [wandb_init.py:_log_setup():507] Logging user logs to /workspace/slotaug/logs/train/runs/clv6_stc_1000e_v3_1_10/2023-06-04_07-22-47_dgx_all/wandb/offline-run-20230604_072252-puyfmzyj/logs/debug.log
2023-06-04 07:22:52,023 INFO    MainThread:3847581 [wandb_init.py:_log_setup():508] Logging internal logs to /workspace/slotaug/logs/train/runs/clv6_stc_1000e_v3_1_10/2023-06-04_07-22-47_dgx_all/wandb/offline-run-20230604_072252-puyfmzyj/logs/debug-internal.log
2023-06-04 07:22:52,023 INFO    MainThread:3847581 [wandb_init.py:init():547] calling init triggers
2023-06-04 07:22:52,023 INFO    MainThread:3847581 [wandb_init.py:init():554] wandb.init called with sweep_config: {}
config: {}
2023-06-04 07:22:52,023 INFO    MainThread:3847581 [wandb_init.py:init():595] starting backend
2023-06-04 07:22:52,024 INFO    MainThread:3847581 [wandb_init.py:init():599] setting up manager
2023-06-04 07:22:52,026 INFO    MainThread:3847581 [backend.py:_multiprocessing_setup():106] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2023-06-04 07:22:52,029 INFO    MainThread:3847581 [wandb_init.py:init():605] backend started and connected
2023-06-04 07:22:52,032 INFO    MainThread:3847581 [wandb_init.py:init():695] updated telemetry
2023-06-04 07:22:52,055 INFO    MainThread:3847581 [wandb_init.py:init():782] starting run threads in backend
2023-06-04 07:22:54,688 INFO    MainThread:3847581 [wandb_run.py:_console_start():2157] atexit reg
2023-06-04 07:22:54,688 INFO    MainThread:3847581 [wandb_run.py:_redirect():2012] redirect: SettingsConsole.WRAP_RAW
2023-06-04 07:22:54,689 INFO    MainThread:3847581 [wandb_run.py:_redirect():2077] Wrapping output streams.
2023-06-04 07:22:54,689 INFO    MainThread:3847581 [wandb_run.py:_redirect():2102] Redirects installed.
2023-06-04 07:22:54,690 INFO    MainThread:3847581 [wandb_init.py:init():824] run started, returning control to user process
2023-06-04 07:22:54,798 INFO    MainThread:3847581 [wandb_run.py:_config_callback():1285] config_cb None None {'model/_target_': 'src.models.slotaug_ae_module.LitSlotAugAutoEncoder', 'model/name': 'v3_1_10', 'model/optimizer/_target_': 'torch.optim.AdamW', 'model/optimizer/_partial_': True, 'model/optimizer/lr': 0.0004, 'model/scheduler/scheduler/_target_': 'torch.optim.lr_scheduler.LambdaLR', 'model/scheduler/scheduler/_partial_': True, 'model/scheduler/warmup_steps': 20, 'model/scheduler/decay_steps': 200, 'model/scheduler/decay_rate': 0.5, 'model/net/_target_': 'src.models.components.slotaug.slotaug_ae.SlotAugAutoEncoder', 'model/net/num_slots': 7, 'model/net/num_iter': 3, 'model/net/num_iter_insts': 1, 'model/net/num_attn_heads': 1, 'model/net/slot_dim': 64, 'model/net/hid_dim': 64, 'model/net/mlp_hid_dim': 128, 'model/net/eps': 1e-08, 'model/net/enc_depth': 4, 'model/net/dec_init_size': 8, 'model/net/dec_depth': 6, 'model/net/dec_hid_dim': 64, 'model/net/aux_identity': True, 'model/loss_sc_weight': 0.1, 'model/params/total': 2996301, 'model/params/trainable': 2996301, 'model/params/non_trainable': 0, 'data/_target_': 'src.data.clevr6_aug_datamodule.CLEVR6AugDataModule', 'data/name': 'clv6_stc_1000e', 'data/data_dir': '/workspace/dataset/clevr_with_masks/CLEVR6', 'data/img_size': 128, 'data/crop_size': 192, 'data/template_size': 240, 'data/batch_size': 64, 'data/num_workers': 4, 'data/pin_memory': False, 'data/transform_contents': 'scale,translate,color', 'trainer/_target_': 'pytorch_lightning.Trainer', 'trainer/default_root_dir': '/workspace/slotaug/logs/train/runs/clv6_stc_1000e_v3_1_10/2023-06-04_07-22-47_dgx_all', 'trainer/min_epochs': 1, 'trainer/max_epochs': 1000, 'trainer/accelerator': 'gpu', 'trainer/devices': 1, 'trainer/precision': 16, 'trainer/check_val_every_n_epoch': 20, 'trainer/deterministic': False, 'trainer/gradient_clip_val': 5.0, 'callbacks/model_checkpoint/_target_': 'pytorch_lightning.callbacks.ModelCheckpoint', 'callbacks/model_checkpoint/dirpath': '/workspace/slotaug/logs/train/runs/clv6_stc_1000e_v3_1_10/2023-06-04_07-22-47_dgx_all/checkpoints', 'callbacks/model_checkpoint/filename': 'epoch={epoch:03d}_val_ari={val/ari_aug:.4f}', 'callbacks/model_checkpoint/monitor': 'val/ari_aug', 'callbacks/model_checkpoint/verbose': False, 'callbacks/model_checkpoint/save_last': True, 'callbacks/model_checkpoint/save_top_k': -1, 'callbacks/model_checkpoint/mode': 'max', 'callbacks/model_checkpoint/auto_insert_metric_name': False, 'callbacks/model_checkpoint/save_weights_only': False, 'callbacks/model_checkpoint/every_n_train_steps': None, 'callbacks/model_checkpoint/train_time_interval': None, 'callbacks/model_checkpoint/every_n_epochs': 40, 'callbacks/model_checkpoint/save_on_train_epoch_end': False, 'callbacks/model_summary/_target_': 'pytorch_lightning.callbacks.RichModelSummary', 'callbacks/model_summary/max_depth': -1, 'callbacks/rich_progress_bar/_target_': 'pytorch_lightning.callbacks.RichProgressBar', 'callbacks/learning_rate_monitor/_target_': 'pytorch_lightning.callbacks.LearningRateMonitor', 'callbacks/learning_rate_monitor/logging_interval': 'epoch', 'extras/ignore_warnings': False, 'extras/enforce_tags': True, 'extras/print_config': True, 'task_name': 'train', 'tags': ['clv6_stc_1000e', 'v3_1_10'], 'ckpt_path': None, 'seed': None}
2023-06-04 07:23:08,744 INFO    MainThread:3847581 [wandb_run.py:_finish():1892] finishing run neurips2023/puyfmzyj
2023-06-04 07:23:08,744 INFO    MainThread:3847581 [wandb_run.py:_atexit_cleanup():2126] got exitcode: 0
2023-06-04 07:23:08,744 INFO    MainThread:3847581 [wandb_run.py:_restore():2109] restore
2023-06-04 07:23:08,744 INFO    MainThread:3847581 [wandb_run.py:_restore():2115] restore done
