[2023-04-06 10:02:25,029][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-06 10:02:25,039][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-06 10:02:25,160][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-06 10:02:25,169][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-06 10:02:25,424][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpmt2kyx4k
[2023-04-06 10:02:25,425][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpmt2kyx4k/_remote_module_non_sriptable.py
[2023-04-06 10:02:25,456][__main__][INFO] - Instantiating callbacks...
[2023-04-06 10:02:25,456][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-06 10:02:25,462][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-06 10:02:25,463][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-06 10:02:25,464][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-06 10:02:25,465][__main__][INFO] - Instantiating loggers...
[2023-04-06 10:02:25,465][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-06 10:03:06,377][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-06 10:03:06,432][__main__][INFO] - Logging hyperparameters!
[2023-04-06 10:03:06,444][__main__][INFO] - Starting training!
[2023-04-06 10:07:50,684][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-06 10:07:50,692][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-06 10:07:50,797][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-06 10:07:50,804][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-06 10:07:51,047][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpc34qt6o1
[2023-04-06 10:07:51,047][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpc34qt6o1/_remote_module_non_sriptable.py
[2023-04-06 10:07:51,106][__main__][INFO] - Instantiating callbacks...
[2023-04-06 10:07:51,107][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-06 10:07:51,112][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-06 10:07:51,113][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-06 10:07:51,114][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-06 10:07:51,115][__main__][INFO] - Instantiating loggers...
[2023-04-06 10:07:51,115][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-06 10:08:35,647][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-06 10:08:35,704][__main__][INFO] - Logging hyperparameters!
[2023-04-06 10:08:35,716][__main__][INFO] - Starting training!
[2023-04-06 10:09:01,718][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-06 10:09:01,727][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-06 10:09:01,834][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-06 10:09:01,840][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-06 10:09:02,031][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpeum493w1
[2023-04-06 10:09:02,032][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpeum493w1/_remote_module_non_sriptable.py
[2023-04-06 10:09:02,076][__main__][INFO] - Instantiating callbacks...
[2023-04-06 10:09:02,077][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-06 10:09:02,082][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-06 10:09:02,083][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-06 10:09:02,084][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-06 10:09:02,085][__main__][INFO] - Instantiating loggers...
[2023-04-06 10:09:02,086][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-06 10:09:33,051][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-06 10:09:33,107][__main__][INFO] - Logging hyperparameters!
[2023-04-06 10:09:33,120][__main__][INFO] - Starting training!
[2023-04-06 10:09:41,701][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 127, in validation_step
    loss_ori, loss_aug, outputs = self.model_step(batch, train=False)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 99, in model_step
    outputs = self.forward(img_ori, img_aug, instruction, train=train)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 82, in forward
    outputs = self.net(img_ori, img_aug, instruction, train=train)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug_ae.py", line 76, in forward
    slota_outputs = self.slot_attention(inputs=x, instruction=instruction, train=train)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug.py", line 183, in forward
    outputs["attn_aug"] = attn_aug
UnboundLocalError: local variable 'attn_aug' referenced before assignment
[2023-04-06 10:09:41,707][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_aug_parallel_ippe_31/2023-04-06_10-09-01_dgx_gpu7
[2023-04-06 10:09:41,707][src.utils.utils][INFO] - Closing loggers...
[2023-04-06 10:09:41,708][src.utils.utils][INFO] - Closing wandb!
[2023-04-06 10:19:32,023][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-06 10:19:32,032][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-06 10:19:32,150][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-06 10:19:32,156][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-06 10:19:32,422][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp7k4mw6sh
[2023-04-06 10:19:32,423][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp7k4mw6sh/_remote_module_non_sriptable.py
[2023-04-06 10:19:32,451][__main__][INFO] - Instantiating callbacks...
[2023-04-06 10:19:32,451][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-06 10:19:32,456][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-06 10:19:32,457][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-06 10:19:32,458][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-06 10:19:32,459][__main__][INFO] - Instantiating loggers...
[2023-04-06 10:19:32,459][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-06 10:19:56,566][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-06 10:19:56,620][__main__][INFO] - Logging hyperparameters!
[2023-04-06 10:19:56,632][__main__][INFO] - Starting training!
[2023-04-06 10:20:12,911][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1214, in _run_train
    self.fit_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 267, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 213, in advance
    batch_output = self.batch_loop.run(kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 88, in advance
    outputs = self.optimizer_loop.run(optimizers, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 202, in advance
    result = self._run_optimization(kwargs, self._optimizers[self.optim_progress.optimizer_position])
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 249, in _run_optimization
    self._optimizer_step(optimizer, opt_idx, kwargs.get("batch_idx", 0), closure)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 370, in _optimizer_step
    self.trainer._call_lightning_module_hook(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1356, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/core/module.py", line 1742, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/core/optimizer.py", line 169, in step
    step_output = self._strategy.optimizer_step(self._optimizer, self._optimizer_idx, closure, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 234, in optimizer_step
    return self.precision_plugin.optimizer_step(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/plugins/precision/native_amp.py", line 75, in optimizer_step
    closure_result = closure()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 149, in __call__
    self._result = self.closure(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 135, in closure
    step_output = self._step_fn()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 419, in _training_step
    training_step_output = self.trainer._call_strategy_hook("training_step", *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in training_step
    return self.model.training_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 106, in training_step
    loss_ori, loss_aug, outputs = self.model_step(batch, train=True)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 99, in model_step
    outputs = self.forward(img_ori, img_aug, instruction, train=train)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 82, in forward
    outputs = self.net(img_ori, img_aug, instruction, train=train)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug_ae.py", line 76, in forward
    slota_outputs = self.slot_attention(inputs=x, instruction=instruction, train=train)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug.py", line 177, in forward
    attns_aug = attns[-1:]
TypeError: 'NoneType' object is not subscriptable
[2023-04-06 10:20:12,918][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_aug_parallel_ippe_31/2023-04-06_10-19-31_dgx_gpu7
[2023-04-06 10:20:12,918][src.utils.utils][INFO] - Closing loggers...
[2023-04-06 10:20:12,919][src.utils.utils][INFO] - Closing wandb!
[2023-04-06 10:25:48,700][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-06 10:25:48,709][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-06 10:25:48,815][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-06 10:25:48,820][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-06 10:25:49,019][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp7drgduai
[2023-04-06 10:25:49,020][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp7drgduai/_remote_module_non_sriptable.py
[2023-04-06 10:25:49,049][__main__][INFO] - Instantiating callbacks...
[2023-04-06 10:25:49,050][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-06 10:25:49,054][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-06 10:25:49,055][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-06 10:25:49,056][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-06 10:25:49,057][__main__][INFO] - Instantiating loggers...
[2023-04-06 10:25:49,057][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-06 10:26:13,203][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-06 10:26:13,260][__main__][INFO] - Logging hyperparameters!
[2023-04-06 10:26:13,273][__main__][INFO] - Starting training!
[2023-04-07 10:04:52,161][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_aug_serial_ippe_21/2023-04-06_10-02-24_dgx_gpu5
[2023-04-07 10:04:52,162][src.utils.utils][INFO] - Closing loggers...
[2023-04-07 10:04:52,162][src.utils.utils][INFO] - Closing wandb!
[2023-04-07 10:05:28,093][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-07 10:07:33,951][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-07 10:07:33,960][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-07 10:07:34,086][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-07 10:07:34,094][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-07 10:07:34,338][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmplk3jxabs
[2023-04-07 10:07:34,339][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmplk3jxabs/_remote_module_non_sriptable.py
[2023-04-07 10:07:34,395][__main__][INFO] - Instantiating callbacks...
[2023-04-07 10:07:34,396][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-07 10:07:34,401][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-07 10:07:34,402][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-07 10:07:34,403][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-07 10:07:34,404][__main__][INFO] - Instantiating loggers...
[2023-04-07 10:07:34,404][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-07 10:07:58,786][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-07 10:07:58,851][__main__][INFO] - Logging hyperparameters!
[2023-04-07 10:07:58,864][__main__][INFO] - Starting training!
[2023-04-07 10:10:42,943][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_aug_serial_31/2023-04-07_10-07-33_dgx_gpu5
[2023-04-07 10:10:42,944][src.utils.utils][INFO] - Closing loggers...
[2023-04-07 10:10:42,944][src.utils.utils][INFO] - Closing wandb!
[2023-04-07 10:11:02,537][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-07 10:33:19,288][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-07 10:33:19,298][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-07 10:33:19,421][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-07 10:33:19,429][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-07 10:33:19,679][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmprw_ctlrz
[2023-04-07 10:33:19,680][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmprw_ctlrz/_remote_module_non_sriptable.py
[2023-04-07 10:33:19,723][__main__][INFO] - Instantiating callbacks...
[2023-04-07 10:33:19,724][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-07 10:33:19,730][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-07 10:33:19,731][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-07 10:33:19,732][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-07 10:33:19,733][__main__][INFO] - Instantiating loggers...
[2023-04-07 10:33:19,733][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-07 10:33:44,211][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-07 10:33:44,292][__main__][INFO] - Logging hyperparameters!
[2023-04-07 10:33:44,306][__main__][INFO] - Starting training!
[2023-04-07 11:05:06,703][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_aug_parallel_ippe_32/2023-04-06_10-07-50_dgx_gpu6
[2023-04-07 11:05:06,704][src.utils.utils][INFO] - Closing loggers...
[2023-04-07 11:05:06,704][src.utils.utils][INFO] - Closing wandb!
[2023-04-07 11:05:35,991][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-07 11:06:01,817][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-07 11:06:01,827][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-07 11:06:01,944][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-07 11:06:01,950][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-07 11:06:02,230][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpfqw74632
[2023-04-07 11:06:02,231][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpfqw74632/_remote_module_non_sriptable.py
[2023-04-07 11:06:02,262][__main__][INFO] - Instantiating callbacks...
[2023-04-07 11:06:02,263][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-07 11:06:02,268][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-07 11:06:02,269][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-07 11:06:02,270][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-07 11:06:02,271][__main__][INFO] - Instantiating loggers...
[2023-04-07 11:06:02,271][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-07 11:06:26,744][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-07 11:06:26,813][__main__][INFO] - Logging hyperparameters!
[2023-04-07 11:06:26,828][__main__][INFO] - Starting training!
[2023-04-07 11:06:34,030][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_aug_parallel_ippe_31/2023-04-06_10-25-48_dgx_gpu7
[2023-04-07 11:06:34,032][src.utils.utils][INFO] - Closing loggers...
[2023-04-07 11:06:34,032][src.utils.utils][INFO] - Closing wandb!
[2023-04-07 11:07:04,481][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-07 11:07:35,963][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-07 11:07:35,974][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-07 11:07:36,100][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-07 11:07:36,107][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-07 11:07:36,380][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp7_40b25f
[2023-04-07 11:07:36,381][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp7_40b25f/_remote_module_non_sriptable.py
[2023-04-07 11:07:36,455][__main__][INFO] - Instantiating callbacks...
[2023-04-07 11:07:36,455][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-07 11:07:36,461][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-07 11:07:36,462][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-07 11:07:36,463][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-07 11:07:36,464][__main__][INFO] - Instantiating loggers...
[2023-04-07 11:07:36,464][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-07 11:08:00,961][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-07 11:08:01,028][__main__][INFO] - Logging hyperparameters!
[2023-04-07 11:08:01,042][__main__][INFO] - Starting training!
[2023-04-09 07:54:37,860][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_aug_serial_22/2023-04-07_11-07-35_dgx_gpu7
[2023-04-09 07:54:37,860][src.utils.utils][INFO] - Closing loggers...
[2023-04-09 07:54:37,861][src.utils.utils][INFO] - Closing wandb!
[2023-04-09 07:55:13,582][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-09 07:56:28,713][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-09 07:56:28,721][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-09 07:56:28,822][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-09 07:56:28,830][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-09 07:56:29,063][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpbfqw_cqq
[2023-04-09 07:56:29,063][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpbfqw_cqq/_remote_module_non_sriptable.py
[2023-04-09 07:56:29,107][__main__][INFO] - Instantiating callbacks...
[2023-04-09 07:56:29,107][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-09 07:56:29,112][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-09 07:56:29,112][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-09 07:56:29,113][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-09 07:56:29,114][__main__][INFO] - Instantiating loggers...
[2023-04-09 07:56:29,114][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-09 07:56:53,182][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-09 07:56:53,238][__main__][INFO] - Logging hyperparameters!
[2023-04-09 07:56:53,251][__main__][INFO] - Starting training!
[2023-04-09 20:38:17,913][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_aug_serial_31/2023-04-07_10-33-19_dgx_gpu5
[2023-04-09 20:38:17,914][src.utils.utils][INFO] - Closing loggers...
[2023-04-09 20:38:17,914][src.utils.utils][INFO] - Closing wandb!
[2023-04-09 20:38:27,884][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-09 22:44:49,751][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_aug_serial_31/2023-04-07_11-06-01_dgx_gpu6
[2023-04-09 22:44:49,752][src.utils.utils][INFO] - Closing loggers...
[2023-04-09 22:44:49,753][src.utils.utils][INFO] - Closing wandb!
[2023-04-09 22:44:59,802][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-10 04:15:28,872][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-10 04:15:28,881][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-10 04:15:28,996][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-10 04:15:29,005][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-10 04:15:29,314][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpy3d3dsei
[2023-04-10 04:15:29,315][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpy3d3dsei/_remote_module_non_sriptable.py
[2023-04-10 04:15:29,347][__main__][INFO] - Instantiating callbacks...
[2023-04-10 04:15:29,347][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-10 04:15:29,352][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-10 04:15:29,353][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-10 04:15:29,355][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-10 04:15:29,356][__main__][INFO] - Instantiating loggers...
[2023-04-10 04:15:29,356][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-10 04:15:53,842][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-10 04:15:53,900][__main__][INFO] - Logging hyperparameters!
[2023-04-10 04:15:53,913][__main__][INFO] - Starting training!
[2023-04-11 05:32:53,788][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-11 05:32:53,797][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-11 05:32:53,912][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-11 05:32:53,921][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-11 05:32:54,349][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpbu5bxc4z
[2023-04-11 05:32:54,349][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpbu5bxc4z/_remote_module_non_sriptable.py
[2023-04-11 05:32:54,384][__main__][INFO] - Instantiating callbacks...
[2023-04-11 05:32:54,385][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-11 05:32:54,390][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-11 05:32:54,391][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-11 05:32:54,392][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-11 05:32:54,393][__main__][INFO] - Instantiating loggers...
[2023-04-11 05:32:54,394][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-11 05:33:18,890][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-11 05:33:18,944][__main__][INFO] - Logging hyperparameters!
[2023-04-11 05:33:18,957][__main__][INFO] - Starting training!
[2023-04-11 06:31:45,165][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_aug_curry100_serial_31/2023-04-09_07-56-28_dgx_gpu7
[2023-04-11 06:31:45,166][src.utils.utils][INFO] - Closing loggers...
[2023-04-11 06:31:45,166][src.utils.utils][INFO] - Closing wandb!
[2023-04-11 06:34:00,299][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-11 06:34:00,308][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-11 06:34:00,424][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-11 06:34:00,433][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-11 06:34:00,832][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpdofl0_0g
[2023-04-11 06:34:00,833][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpdofl0_0g/_remote_module_non_sriptable.py
[2023-04-11 06:34:00,886][__main__][INFO] - Instantiating callbacks...
[2023-04-11 06:34:00,887][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-11 06:34:00,892][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-11 06:34:00,893][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-11 06:34:00,895][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-11 06:34:00,896][__main__][INFO] - Instantiating loggers...
[2023-04-11 06:34:00,896][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-11 06:34:21,806][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-11 06:34:21,828][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/argparse.py", line 348, in insert_env_defaults
    return fn(self, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 420, in __init__
    self._accelerator_connector = AcceleratorConnector(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py", line 202, in __init__
    self._accelerator_flag = self._choose_gpu_accelerator_backend()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py", line 537, in _choose_gpu_accelerator_backend
    raise MisconfigurationException("No supported gpu backend found!")
lightning_fabric.utilities.exceptions.MisconfigurationException: No supported gpu backend found!

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 65, in train
    trainer: Trainer = hydra.utils.instantiate(cfg.trainer, callbacks=callbacks, logger=logger)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'pytorch_lightning.trainer.trainer.Trainer':
MisconfigurationException('No supported gpu backend found!')
full_key: trainer
[2023-04-11 06:34:21,833][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_tran_pdoat_slot_commu_31/2023-04-11_06-34-00_dgx_gpu7
[2023-04-11 06:34:21,833][src.utils.utils][INFO] - Closing loggers...
[2023-04-11 06:34:21,834][src.utils.utils][INFO] - Closing wandb!
[2023-04-11 06:38:35,381][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-11 06:38:35,394][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-11 06:38:35,516][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-11 06:38:35,525][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-11 06:38:35,784][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpzebnjptl
[2023-04-11 06:38:35,785][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpzebnjptl/_remote_module_non_sriptable.py
[2023-04-11 06:38:35,833][__main__][INFO] - Instantiating callbacks...
[2023-04-11 06:38:35,834][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-11 06:38:35,840][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-11 06:38:35,841][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-11 06:38:35,843][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-11 06:38:35,844][__main__][INFO] - Instantiating loggers...
[2023-04-11 06:38:35,845][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-11 06:39:00,238][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-11 06:39:00,316][__main__][INFO] - Logging hyperparameters!
[2023-04-11 06:39:00,332][__main__][INFO] - Starting training!
[2023-04-12 08:02:38,366][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_aug_para_dummy_only_at_tran/2023-04-10_04-15-28_dgx_gpu6
[2023-04-12 08:02:38,367][src.utils.utils][INFO] - Closing loggers...
[2023-04-12 08:02:38,367][src.utils.utils][INFO] - Closing wandb!
[2023-04-12 08:08:22,668][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-12 08:08:22,677][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-12 08:08:22,796][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-12 08:08:22,806][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
TypeError: __init__() got an unexpected keyword argument 'transform_contents'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 53, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.data)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.data.clevr6_aug_datamodule.CLEVR6AugDataModule':
TypeError("__init__() got an unexpected keyword argument 'transform_contents'")
full_key: data
[2023-04-12 08:08:22,808][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_tran_model_v4_31/2023-04-12_08-08-22_dgx_gpu6
[2023-04-12 08:08:22,808][src.utils.utils][INFO] - Closing loggers...
[2023-04-12 08:13:21,009][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-12 08:13:21,018][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-12 08:13:21,126][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-12 08:13:21,133][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-12 08:13:21,353][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmply5lw4z8
[2023-04-12 08:13:21,354][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmply5lw4z8/_remote_module_non_sriptable.py
[2023-04-12 08:13:21,420][__main__][INFO] - Instantiating callbacks...
[2023-04-12 08:13:21,421][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-12 08:13:21,425][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-12 08:13:21,426][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-12 08:13:21,427][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-12 08:13:21,428][__main__][INFO] - Instantiating loggers...
[2023-04-12 08:13:21,429][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-12 08:13:39,361][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-12 08:13:39,419][__main__][INFO] - Logging hyperparameters!
[2023-04-12 08:13:39,438][__main__][INFO] - Starting training!
[2023-04-12 08:13:49,660][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 133, in validation_step
    loss_ori, loss_aug, outputs = self.model_step(batch, train=False)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 101, in model_step
    outputs = self.forward(img_ori, img_aug, insts, train=train)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 84, in forward
    outputs = self.net(img_ori, img_aug, insts, train=train)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug_ae.py", line 77, in forward
    slota_outputs = self.slot_attention(inputs=x, insts=insts, train=train)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug.py", line 227, in forward
    slots, attn, attns = self.update_slots(k, v, slots, attns, dummy_insts)
  File "/workspace/slotaug/src/models/components/slotaug.py", line 154, in update_slots
    slots = self.apply_instructions(slots, insts)
  File "/workspace/slotaug/src/models/components/slotaug.py", line 140, in apply_instructions
    slots = torch.cat([slots.clone(), self.norm_inst_list[content_idx](inst_slots)], dim=-1)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/normalization.py", line 189, in forward
    return F.layer_norm(
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/functional.py", line 2486, in layer_norm
    return torch.layer_norm(input, normalized_shape, weight, bias, eps, torch.backends.cudnn.enabled)
RuntimeError: Given normalized_shape=[9], expected input with shape [*, 9], but got input of size[64, 7, 72]
[2023-04-12 08:13:49,668][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_tran_model_v4_31/2023-04-12_08-13-20_dgx_gpu6
[2023-04-12 08:13:49,669][src.utils.utils][INFO] - Closing loggers...
[2023-04-12 08:13:49,669][src.utils.utils][INFO] - Closing wandb!
[2023-04-12 08:15:27,253][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-12 08:15:27,262][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-12 08:15:27,372][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-12 08:15:27,379][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-12 08:15:27,612][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp6sif4vps
[2023-04-12 08:15:27,613][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp6sif4vps/_remote_module_non_sriptable.py
[2023-04-12 08:15:27,652][__main__][INFO] - Instantiating callbacks...
[2023-04-12 08:15:27,652][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-12 08:15:27,657][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-12 08:15:27,658][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-12 08:15:27,659][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-12 08:15:27,660][__main__][INFO] - Instantiating loggers...
[2023-04-12 08:15:27,661][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-12 08:15:52,253][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-12 08:15:52,325][__main__][INFO] - Logging hyperparameters!
[2023-04-12 08:15:52,341][__main__][INFO] - Starting training!
[2023-04-12 08:21:07,533][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_tran_pdoat_slot_commu_31/2023-04-11_06-38-35_dgx_gpu7
[2023-04-12 08:21:07,534][src.utils.utils][INFO] - Closing loggers...
[2023-04-12 08:21:07,534][src.utils.utils][INFO] - Closing wandb!
[2023-04-12 08:22:11,609][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-12 08:22:11,619][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-12 08:22:11,728][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-12 08:22:11,736][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-12 08:22:11,968][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpnr5rr16i
[2023-04-12 08:22:11,968][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpnr5rr16i/_remote_module_non_sriptable.py
[2023-04-12 08:22:12,009][__main__][INFO] - Instantiating callbacks...
[2023-04-12 08:22:12,010][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-12 08:22:12,014][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-12 08:22:12,016][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-12 08:22:12,017][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-12 08:22:12,018][__main__][INFO] - Instantiating loggers...
[2023-04-12 08:22:12,018][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-12 08:22:36,245][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-12 08:22:36,301][__main__][INFO] - Logging hyperparameters!
[2023-04-12 08:22:36,315][__main__][INFO] - Starting training!
[2023-04-13 16:30:43,190][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_tran_model_v3_2_31/2023-04-12_08-22-11_dgx_gpu7
[2023-04-13 16:30:43,191][src.utils.utils][INFO] - Closing loggers...
[2023-04-13 16:30:43,191][src.utils.utils][INFO] - Closing wandb!
[2023-04-13 16:35:21,351][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-13 16:35:21,359][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-13 16:35:21,468][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-13 16:35:21,479][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-13 16:35:21,699][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmptdysxknq
[2023-04-13 16:35:21,699][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmptdysxknq/_remote_module_non_sriptable.py
[2023-04-13 16:35:21,733][__main__][INFO] - Instantiating callbacks...
[2023-04-13 16:35:21,734][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-13 16:35:21,738][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-13 16:35:21,739][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-13 16:35:21,740][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-13 16:35:21,741][__main__][INFO] - Instantiating loggers...
[2023-04-13 16:35:21,741][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-13 16:35:49,999][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-13 16:35:50,055][__main__][INFO] - Logging hyperparameters!
[2023-04-13 16:35:50,068][__main__][INFO] - Starting training!
[2023-04-13 16:36:07,511][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1214, in _run_train
    self.fit_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 267, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 213, in advance
    batch_output = self.batch_loop.run(kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 88, in advance
    outputs = self.optimizer_loop.run(optimizers, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 202, in advance
    result = self._run_optimization(kwargs, self._optimizers[self.optim_progress.optimizer_position])
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 249, in _run_optimization
    self._optimizer_step(optimizer, opt_idx, kwargs.get("batch_idx", 0), closure)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 370, in _optimizer_step
    self.trainer._call_lightning_module_hook(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1356, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/core/module.py", line 1742, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/core/optimizer.py", line 169, in step
    step_output = self._strategy.optimizer_step(self._optimizer, self._optimizer_idx, closure, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 234, in optimizer_step
    return self.precision_plugin.optimizer_step(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/plugins/precision/native_amp.py", line 75, in optimizer_step
    closure_result = closure()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 149, in __call__
    self._result = self.closure(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 135, in closure
    step_output = self._step_fn()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 419, in _training_step
    training_step_output = self.trainer._call_strategy_hook("training_step", *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in training_step
    return self.model.training_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 108, in training_step
    loss_ori, loss_aug, outputs = self.model_step(batch, train=True, inference=False)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 101, in model_step
    outputs = self.forward(img_ori, img_aug, insts, train=train, inference=inference)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 84, in forward
    outputs = self.net(img_ori, img_aug, insts, train=train)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug_ae.py", line 77, in forward
    slota_outputs = self.slot_attention(inputs=x, insts=insts, train=train, inference=inference)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug.py", line 282, in forward
    attn_prev=attns_aug[-1])
TypeError: 'NoneType' object is not subscriptable
[2023-04-13 16:36:07,523][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_tran_model_v3_31/2023-04-13_16-35-21_dgx_gpu7
[2023-04-13 16:36:07,524][src.utils.utils][INFO] - Closing loggers...
[2023-04-13 16:36:07,524][src.utils.utils][INFO] - Closing wandb!
[2023-04-13 16:39:53,683][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-13 16:39:53,691][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-13 16:39:53,791][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-13 16:39:53,796][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-13 16:39:54,041][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpcuuogstj
[2023-04-13 16:39:54,042][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpcuuogstj/_remote_module_non_sriptable.py
[2023-04-13 16:39:54,091][__main__][INFO] - Instantiating callbacks...
[2023-04-13 16:39:54,092][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-13 16:39:54,096][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-13 16:39:54,097][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-13 16:39:54,098][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-13 16:39:54,099][__main__][INFO] - Instantiating loggers...
[2023-04-13 16:39:54,100][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-13 16:40:19,075][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-13 16:40:19,129][__main__][INFO] - Logging hyperparameters!
[2023-04-13 16:40:19,142][__main__][INFO] - Starting training!
[2023-04-13 16:40:36,421][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1214, in _run_train
    self.fit_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 267, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 213, in advance
    batch_output = self.batch_loop.run(kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 88, in advance
    outputs = self.optimizer_loop.run(optimizers, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 202, in advance
    result = self._run_optimization(kwargs, self._optimizers[self.optim_progress.optimizer_position])
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 249, in _run_optimization
    self._optimizer_step(optimizer, opt_idx, kwargs.get("batch_idx", 0), closure)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 370, in _optimizer_step
    self.trainer._call_lightning_module_hook(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1356, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/core/module.py", line 1742, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/core/optimizer.py", line 169, in step
    step_output = self._strategy.optimizer_step(self._optimizer, self._optimizer_idx, closure, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 234, in optimizer_step
    return self.precision_plugin.optimizer_step(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/plugins/precision/native_amp.py", line 75, in optimizer_step
    closure_result = closure()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 149, in __call__
    self._result = self.closure(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 135, in closure
    step_output = self._step_fn()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 419, in _training_step
    training_step_output = self.trainer._call_strategy_hook("training_step", *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in training_step
    return self.model.training_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 108, in training_step
    loss_ori, loss_aug, outputs = self.model_step(batch, train=True, inference=False)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 101, in model_step
    outputs = self.forward(img_ori, img_aug, insts, train=train, inference=inference)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 84, in forward
    outputs = self.net(img_ori, img_aug, insts, train=train)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug_ae.py", line 77, in forward
    slota_outputs = self.slot_attention(inputs=x, insts=insts, train=train, inference=inference)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug.py", line 257, in forward
    attns_aug = attns[-1:] # if not train else None
TypeError: 'NoneType' object is not subscriptable
[2023-04-13 16:40:36,428][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_tran_model_v3_31/2023-04-13_16-39-53_dgx_gpu7
[2023-04-13 16:40:36,428][src.utils.utils][INFO] - Closing loggers...
[2023-04-13 16:40:36,429][src.utils.utils][INFO] - Closing wandb!
[2023-04-13 16:42:03,552][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-13 16:42:03,566][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-13 16:42:03,680][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-13 16:42:03,686][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-13 16:42:03,939][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmprx6z2vo5
[2023-04-13 16:42:03,940][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmprx6z2vo5/_remote_module_non_sriptable.py
[2023-04-13 16:42:03,969][__main__][INFO] - Instantiating callbacks...
[2023-04-13 16:42:03,970][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-13 16:42:03,975][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-13 16:42:03,976][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-13 16:42:03,977][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-13 16:42:03,978][__main__][INFO] - Instantiating loggers...
[2023-04-13 16:42:03,979][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-13 16:42:25,451][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-13 16:42:25,527][__main__][INFO] - Logging hyperparameters!
[2023-04-13 16:42:25,541][__main__][INFO] - Starting training!
[2023-04-13 16:58:49,844][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_para_dummy_tran_31/2023-04-11_05-32-53_dgx_gpu5
[2023-04-13 16:58:49,845][src.utils.utils][INFO] - Closing loggers...
[2023-04-13 16:58:49,845][src.utils.utils][INFO] - Closing wandb!
[2023-04-13 16:59:07,373][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-14 21:12:47,464][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_tran_model_v4_31/2023-04-12_08-15-27_dgx_gpu6
[2023-04-14 21:12:47,465][src.utils.utils][INFO] - Closing loggers...
[2023-04-14 21:12:47,465][src.utils.utils][INFO] - Closing wandb!
[2023-04-14 21:13:08,362][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-15 08:21:21,595][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_tran_model_v3_31/2023-04-13_16-42-03_dgx_gpu7
[2023-04-15 08:21:21,596][src.utils.utils][INFO] - Closing loggers...
[2023-04-15 08:21:21,597][src.utils.utils][INFO] - Closing wandb!
[2023-04-15 08:22:50,335][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-15 08:22:50,342][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-15 08:22:50,441][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-15 08:22:50,450][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-15 08:22:50,668][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp9n2rrr3u
[2023-04-15 08:22:50,669][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp9n2rrr3u/_remote_module_non_sriptable.py
[2023-04-15 08:22:50,700][__main__][INFO] - Instantiating callbacks...
[2023-04-15 08:22:50,701][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-15 08:22:50,705][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-15 08:22:50,706][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-15 08:22:50,707][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-15 08:22:50,708][__main__][INFO] - Instantiating loggers...
[2023-04-15 08:22:50,709][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-15 08:23:10,050][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-15 08:23:10,106][__main__][INFO] - Logging hyperparameters!
[2023-04-15 08:23:10,121][__main__][INFO] - Starting training!
[2023-04-15 08:23:16,065][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 121, in advance
    batch = next(data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 184, in __next__
    return self.fetching_function()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 265, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 280, in _fetch_next_batch
    batch = next(iterator)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 530, in __next__
    data = self._next_data()
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1224, in _next_data
    return self._process_data(data)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1250, in _process_data
    data.reraise()
  File "/opt/conda/lib/python3.8/site-packages/torch/_utils.py", line 457, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 287, in _worker_loop
    data = fetcher.fetch(index)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/workspace/slotaug/src/data/components/clevr6_aug.py", line 195, in __getitem__
    tranform_content = random.choice(self.tranform_contents)
AttributeError: 'CLEVR6Aug' object has no attribute 'tranform_contents'

[2023-04-15 08:23:16,072][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_tran_color_hsl_v3_31/2023-04-15_08-22-50_dgx_gpu7
[2023-04-15 08:23:16,072][src.utils.utils][INFO] - Closing loggers...
[2023-04-15 08:23:16,073][src.utils.utils][INFO] - Closing wandb!
[2023-04-15 08:25:30,786][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-15 08:25:30,794][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-15 08:25:30,894][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-15 08:25:30,901][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-15 08:25:31,097][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpoats36ww
[2023-04-15 08:25:31,098][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpoats36ww/_remote_module_non_sriptable.py
[2023-04-15 08:25:31,128][__main__][INFO] - Instantiating callbacks...
[2023-04-15 08:25:31,129][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-15 08:25:31,133][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-15 08:25:31,134][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-15 08:25:31,136][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-15 08:25:31,137][__main__][INFO] - Instantiating loggers...
[2023-04-15 08:25:31,137][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-15 08:25:55,217][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-15 08:25:55,267][__main__][INFO] - Logging hyperparameters!
[2023-04-15 08:25:55,281][__main__][INFO] - Starting training!
[2023-04-17 07:51:50,476][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-17 07:51:50,485][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-17 07:51:50,591][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-17 07:51:50,601][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-17 07:51:50,897][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp04vejuwp
[2023-04-17 07:51:50,898][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp04vejuwp/_remote_module_non_sriptable.py
[2023-04-17 07:51:50,929][__main__][INFO] - Instantiating callbacks...
[2023-04-17 07:51:50,929][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-17 07:51:50,934][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-17 07:51:50,935][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-17 07:51:50,936][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-17 07:51:50,937][__main__][INFO] - Instantiating loggers...
[2023-04-17 07:51:50,937][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-17 07:52:08,732][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-17 07:52:08,781][__main__][INFO] - Logging hyperparameters!
[2023-04-17 07:52:08,793][__main__][INFO] - Starting training!
[2023-04-17 07:52:37,720][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-17 07:52:37,728][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-17 07:52:37,845][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-17 07:52:37,851][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-17 07:52:38,077][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp3p9hix64
[2023-04-17 07:52:38,078][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp3p9hix64/_remote_module_non_sriptable.py
[2023-04-17 07:52:38,108][__main__][INFO] - Instantiating callbacks...
[2023-04-17 07:52:38,109][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-17 07:52:38,113][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-17 07:52:38,114][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-17 07:52:38,115][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-17 07:52:38,116][__main__][INFO] - Instantiating loggers...
[2023-04-17 07:52:38,116][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-17 07:52:55,921][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-17 07:52:55,971][__main__][INFO] - Logging hyperparameters!
[2023-04-17 07:52:55,983][__main__][INFO] - Starting training!
[2023-04-17 21:58:54,399][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_tran_color_hsl_v3_31/2023-04-15_08-25-30_dgx_gpu7
[2023-04-17 21:58:54,400][src.utils.utils][INFO] - Closing loggers...
[2023-04-17 21:58:54,401][src.utils.utils][INFO] - Closing wandb!
[2023-04-17 21:59:16,610][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-18 17:18:23,715][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-18 17:18:23,723][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-18 17:18:23,836][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-18 17:18:23,847][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-18 17:18:24,095][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpz9mdnslp
[2023-04-18 17:18:24,095][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpz9mdnslp/_remote_module_non_sriptable.py
[2023-04-18 17:18:24,169][__main__][INFO] - Instantiating callbacks...
[2023-04-18 17:18:24,170][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-18 17:18:24,175][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-18 17:18:24,175][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-18 17:18:24,176][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-18 17:18:24,177][__main__][INFO] - Instantiating loggers...
[2023-04-18 17:18:24,178][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-18 17:18:42,049][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-18 17:18:42,125][__main__][INFO] - Logging hyperparameters!
[2023-04-18 17:18:42,144][__main__][INFO] - Starting training!
[2023-04-18 17:19:07,567][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-18 17:19:07,579][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-18 17:19:07,691][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-18 17:19:07,699][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-18 17:19:07,930][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp5wdkby7u
[2023-04-18 17:19:07,931][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp5wdkby7u/_remote_module_non_sriptable.py
[2023-04-18 17:19:07,988][__main__][INFO] - Instantiating callbacks...
[2023-04-18 17:19:07,989][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-18 17:19:07,999][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-18 17:19:08,001][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-18 17:19:08,003][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-18 17:19:08,004][__main__][INFO] - Instantiating loggers...
[2023-04-18 17:19:08,005][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-18 17:20:54,613][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-18 17:20:54,742][__main__][INFO] - Logging hyperparameters!
[2023-04-18 17:20:54,756][__main__][INFO] - Starting training!
[2023-04-18 17:21:14,379][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 127, in validation_step
    loss_ori, loss_aug, outputs = self.model_step(batch, train=False, inference=False)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 95, in model_step
    outputs = self.forward(img_ori, img_aug, insts, train=train, inference=inference)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 78, in forward
    outputs = self.net(img_ori, img_aug, insts, train=train)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug_ae.py", line 82, in forward
    x = self.decoder_cnn(slots)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slota_utils.py", line 128, in forward
    x = self.deconvs(x)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/container.py", line 141, in forward
    input = module(input)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/activation.py", line 98, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/functional.py", line 1442, in relu
    result = torch.relu(input)
RuntimeError: CUDA out of memory. Tried to allocate 1008.00 MiB (GPU 0; 15.78 GiB total capacity; 1.40 GiB already allocated; 730.75 MiB free; 2.18 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2023-04-18 17:21:14,385][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3_commu_31/2023-04-18_17-19-07_dgx_gpu4
[2023-04-18 17:21:14,385][src.utils.utils][INFO] - Closing loggers...
[2023-04-18 17:21:14,385][src.utils.utils][INFO] - Closing wandb!
[2023-04-18 17:26:59,928][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-18 17:26:59,937][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-18 17:27:00,052][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-18 17:27:00,059][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-18 17:27:00,277][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpzykhathx
[2023-04-18 17:27:00,277][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpzykhathx/_remote_module_non_sriptable.py
[2023-04-18 17:27:00,313][__main__][INFO] - Instantiating callbacks...
[2023-04-18 17:27:00,314][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-18 17:27:00,319][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-18 17:27:00,320][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-18 17:27:00,321][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-18 17:27:00,322][__main__][INFO] - Instantiating loggers...
[2023-04-18 17:27:00,322][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-18 17:27:33,410][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-18 17:27:33,466][__main__][INFO] - Logging hyperparameters!
[2023-04-18 17:27:33,480][__main__][INFO] - Starting training!
[2023-04-19 15:55:18,359][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_tran_v4_31/2023-04-17_07-51-50_dgx_gpu5
[2023-04-19 15:55:18,360][src.utils.utils][INFO] - Closing loggers...
[2023-04-19 15:55:18,361][src.utils.utils][INFO] - Closing wandb!
[2023-04-19 15:55:24,845][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hsl_v4_31/2023-04-17_07-52-37_dgx_gpu6
[2023-04-19 15:55:24,846][src.utils.utils][INFO] - Closing loggers...
[2023-04-19 15:55:24,847][src.utils.utils][INFO] - Closing wandb!
[2023-04-19 15:58:04,299][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-19 15:58:04,308][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-19 15:58:04,425][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-19 15:58:04,436][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-19 15:58:04,681][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpcuy_g_gr
[2023-04-19 15:58:04,682][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpcuy_g_gr/_remote_module_non_sriptable.py
[2023-04-19 15:58:04,718][__main__][INFO] - Instantiating callbacks...
[2023-04-19 15:58:04,718][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-19 15:58:04,724][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-19 15:58:04,725][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-19 15:58:04,726][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-19 15:58:04,727][__main__][INFO] - Instantiating loggers...
[2023-04-19 15:58:04,727][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-19 15:58:22,938][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-19 15:58:23,008][__main__][INFO] - Logging hyperparameters!
[2023-04-19 15:58:23,024][__main__][INFO] - Starting training!
[2023-04-19 16:01:47,017][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-19 16:01:47,027][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-19 16:01:47,155][__main__][INFO] - Instantiating datamodule <src.data.clevr6_datamodule.CLEVR6DataModule>
[2023-04-19 16:01:47,163][__main__][INFO] - Instantiating model <src.models.slota_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-19 16:01:47,425][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpwhbppoeo
[2023-04-19 16:01:47,426][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpwhbppoeo/_remote_module_non_sriptable.py
[2023-04-19 16:01:47,441][__main__][INFO] - Instantiating callbacks...
[2023-04-19 16:01:47,441][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-19 16:01:47,446][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-19 16:01:47,448][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-19 16:01:47,449][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-19 16:01:47,450][__main__][INFO] - Instantiating loggers...
[2023-04-19 16:01:47,450][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-19 16:02:05,673][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-19 16:02:05,745][__main__][INFO] - Logging hyperparameters!
[2023-04-19 16:02:05,758][__main__][INFO] - Starting training!
[2023-04-20 11:14:17,786][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_tran_v3_curry500/2023-04-19_15-58-04_dgx_gpu5
[2023-04-20 11:14:17,787][src.utils.utils][INFO] - Closing loggers...
[2023-04-20 11:14:17,787][src.utils.utils][INFO] - Closing wandb!
[2023-04-20 11:14:33,425][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-20 11:14:33,433][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-20 11:14:33,546][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-20 11:14:33,552][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-20 11:14:33,772][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpv4j2gay1
[2023-04-20 11:14:33,772][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpv4j2gay1/_remote_module_non_sriptable.py
[2023-04-20 11:14:33,823][__main__][INFO] - Instantiating callbacks...
[2023-04-20 11:14:33,824][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-20 11:14:33,829][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-20 11:14:33,830][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-20 11:14:33,831][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-20 11:14:33,832][__main__][INFO] - Instantiating loggers...
[2023-04-20 11:14:33,832][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-20 11:14:51,675][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-20 11:14:51,726][__main__][INFO] - Logging hyperparameters!
[2023-04-20 11:14:51,738][__main__][INFO] - Starting training!
[2023-04-20 11:22:42,949][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_slota/2023-04-19_16-01-46_dgx_gpu6
[2023-04-20 11:22:42,950][src.utils.utils][INFO] - Closing loggers...
[2023-04-20 11:22:42,951][src.utils.utils][INFO] - Closing wandb!
[2023-04-20 11:22:58,694][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-20 11:35:33,479][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-20 11:35:33,489][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-20 11:35:33,607][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-20 11:35:33,615][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-20 11:35:33,884][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpbbpmwfrr
[2023-04-20 11:35:33,885][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpbbpmwfrr/_remote_module_non_sriptable.py
[2023-04-20 11:35:33,925][__main__][INFO] - Instantiating callbacks...
[2023-04-20 11:35:33,926][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-20 11:35:33,931][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-20 11:35:33,932][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-20 11:35:33,933][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-20 11:35:33,934][__main__][INFO] - Instantiating loggers...
[2023-04-20 11:35:33,934][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-20 11:35:52,038][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-20 11:35:52,106][__main__][INFO] - Logging hyperparameters!
[2023-04-20 11:35:52,120][__main__][INFO] - Starting training!
[2023-04-20 14:01:46,128][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1214, in _run_train
    self.fit_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 267, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.on_advance_end()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 250, in on_advance_end
    self._run_validation()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 308, in _run_validation
    self.val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 125, in validation_step
    loss_ori, loss_aug, outputs = self.model_step(batch, train=False, inference=False)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 93, in model_step
    outputs = self.forward(img_ori, img_aug, insts, train=train, inference=inference)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 83, in forward
    outputs = self.net(img_ori, img_aug, insts, train=train)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug_ae.py", line 82, in forward
    x = self.decoder_cnn(slots)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slota_utils.py", line 128, in forward
    x = self.deconvs(x)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/container.py", line 141, in forward
    input = module(input)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/activation.py", line 98, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/functional.py", line 1442, in relu
    result = torch.relu(input)
RuntimeError: CUDA out of memory. Tried to allocate 1008.00 MiB (GPU 0; 15.78 GiB total capacity; 12.15 GiB already allocated; 193.75 MiB free; 14.34 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2023-04-20 14:01:46,135][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_indi_soft_v3_31/2023-04-20_11-35-33_dgx_gpu6
[2023-04-20 14:01:46,135][src.utils.utils][INFO] - Closing loggers...
[2023-04-20 14:01:46,136][src.utils.utils][INFO] - Closing wandb!
[2023-04-20 16:04:01,275][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-20 16:04:01,284][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-20 16:04:01,397][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-20 16:04:01,403][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-20 16:04:01,617][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpcdjg1k3t
[2023-04-20 16:04:01,617][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpcdjg1k3t/_remote_module_non_sriptable.py
[2023-04-20 16:04:01,701][__main__][INFO] - Instantiating callbacks...
[2023-04-20 16:04:01,702][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-20 16:04:01,708][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-20 16:04:01,709][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-20 16:04:01,711][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-20 16:04:01,712][__main__][INFO] - Instantiating loggers...
[2023-04-20 16:04:01,713][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-20 16:04:19,609][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-20 16:04:19,665][__main__][INFO] - Logging hyperparameters!
[2023-04-20 16:04:19,679][__main__][INFO] - Starting training!
[2023-04-20 16:49:22,725][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3_commu_31/2023-04-18_17-26-59_dgx_gpu4
[2023-04-20 16:49:22,726][src.utils.utils][INFO] - Closing loggers...
[2023-04-20 16:49:22,727][src.utils.utils][INFO] - Closing wandb!
[2023-04-20 16:51:59,379][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-20 16:51:59,388][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-20 16:51:59,499][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-20 16:51:59,505][__main__][INFO] - Instantiating model <src.models.slotaug_ae_unidec_module.LitSlotAttentionAutoEncoderUnifiedDecoder>
[2023-04-20 16:51:59,709][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/utils.py", line 644, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.models.components' has no attribute 'slotaug_ae'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
  File "/opt/conda/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/workspace/slotaug/src/models/components/slotaug_ae.py", line 8, in <module>
    from src.models.components.slota_utils import GlobalDecoder, Encoder
ImportError: cannot import name 'GlobalDecoder' from 'src.models.components.slota_utils' (/workspace/slotaug/src/models/components/slota_utils.py)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/utils.py", line 658, in _locate
    raise ImportError(
ImportError: Error loading 'src.models.components.slotaug_ae.SlotAttentionAutoEncoderUnifiedDecoder':
ImportError("cannot import name 'GlobalDecoder' from 'src.models.components.slota_utils' (/workspace/slotaug/src/models/components/slota_utils.py)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 56, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.models.components.slotaug_ae.SlotAttentionAutoEncoderUnifiedDecoder', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: model.net
[2023-04-20 16:51:59,712][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3_unidec_31/2023-04-20_16-51-59_dgx_gpu4
[2023-04-20 16:51:59,712][src.utils.utils][INFO] - Closing loggers...
[2023-04-20 16:54:00,381][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-20 16:54:00,391][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-20 16:54:00,508][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-20 16:54:00,514][__main__][INFO] - Instantiating model <src.models.slotaug_ae_unidec_module.LitSlotAttentionAutoEncoderUnifiedDecoder>
[2023-04-20 16:54:00,683][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/utils.py", line 644, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.models.components' has no attribute 'slotaug_ae'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
  File "/opt/conda/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/workspace/slotaug/src/models/components/slotaug_ae.py", line 8, in <module>
    from src.models.components.slota_utils import GlobalDecoder, Encoder
ImportError: cannot import name 'GlobalDecoder' from 'src.models.components.slota_utils' (/workspace/slotaug/src/models/components/slota_utils.py)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/utils.py", line 658, in _locate
    raise ImportError(
ImportError: Error loading 'src.models.components.slotaug_ae.SlotAttentionAutoEncoderUnifiedDecoder':
ImportError("cannot import name 'GlobalDecoder' from 'src.models.components.slota_utils' (/workspace/slotaug/src/models/components/slota_utils.py)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 56, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.models.components.slotaug_ae.SlotAttentionAutoEncoderUnifiedDecoder', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: model.net
[2023-04-20 16:54:00,686][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3_unidec_31/2023-04-20_16-54-00_dgx_gpu4
[2023-04-20 16:54:00,686][src.utils.utils][INFO] - Closing loggers...
[2023-04-20 16:59:49,614][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-20 16:59:49,624][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-20 16:59:49,738][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-20 16:59:49,746][__main__][INFO] - Instantiating model <src.models.slotaug_ae_unidec_module.LitSlotAttentionAutoEncoderUnifiedDecoder>
[2023-04-20 16:59:49,981][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug_ae_unidec.py", line 53, in __init__
    self.slot_attention = SlotAttention(
  File "/workspace/slotaug/src/models/components/slotaug_unidec.py", line 71, in __init__
    self.slot_unifier = nn.TransformerEncoder(unifier_layer, num_layers=unifier_layer)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/transformer.py", line 184, in __init__
    self.layers = _get_clones(encoder_layer, num_layers)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/transformer.py", line 488, in _get_clones
    return ModuleList([copy.deepcopy(module) for i in range(N)])
TypeError: 'TransformerEncoderLayer' object cannot be interpreted as an integer

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 56, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.components.slotaug_ae_unidec.SlotAttentionAutoEncoderUnifiedDecoder':
TypeError("'TransformerEncoderLayer' object cannot be interpreted as an integer")
full_key: model.net
[2023-04-20 16:59:49,985][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3_unidec_31/2023-04-20_16-59-49_dgx_gpu4
[2023-04-20 16:59:49,985][src.utils.utils][INFO] - Closing loggers...
[2023-04-20 17:05:46,792][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-20 17:05:46,802][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-20 17:05:46,927][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-20 17:05:46,933][__main__][INFO] - Instantiating model <src.models.slotaug_ae_unidec_module.LitSlotAttentionAutoEncoderUnifiedDecoder>
[2023-04-20 17:05:47,139][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug_ae_unidec.py", line 61, in __init__
    unifier_layer=unifier_layer,
NameError: name 'unifier_layer' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 56, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.components.slotaug_ae_unidec.SlotAttentionAutoEncoderUnifiedDecoder':
NameError("name 'unifier_layer' is not defined")
full_key: model.net
[2023-04-20 17:05:47,142][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3_unidec_31/2023-04-20_17-05-46_dgx_gpu4
[2023-04-20 17:05:47,142][src.utils.utils][INFO] - Closing loggers...
[2023-04-20 17:06:33,244][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-20 17:06:33,254][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-20 17:06:33,369][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-20 17:06:33,377][__main__][INFO] - Instantiating model <src.models.slotaug_ae_unidec_module.LitSlotAttentionAutoEncoderUnifiedDecoder>
[2023-04-20 17:06:33,611][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug_ae_unidec.py", line 53, in __init__
    self.slot_attention = SlotAttention(
TypeError: __init__() got an unexpected keyword argument 'unifier_layer'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 56, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.components.slotaug_ae_unidec.SlotAttentionAutoEncoderUnifiedDecoder':
TypeError("__init__() got an unexpected keyword argument 'unifier_layer'")
full_key: model.net
[2023-04-20 17:06:33,613][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3_unidec_31/2023-04-20_17-06-33_dgx_gpu4
[2023-04-20 17:06:33,613][src.utils.utils][INFO] - Closing loggers...
[2023-04-20 17:08:37,805][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-20 17:08:37,814][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-20 17:08:37,940][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-20 17:08:37,948][__main__][INFO] - Instantiating model <src.models.slotaug_ae_unidec_module.LitSlotAttentionAutoEncoderUnifiedDecoder>
[2023-04-20 17:08:38,190][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp0s1u73jd
[2023-04-20 17:08:38,191][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp0s1u73jd/_remote_module_non_sriptable.py
[2023-04-20 17:08:38,241][__main__][INFO] - Instantiating callbacks...
[2023-04-20 17:08:38,242][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-20 17:08:38,247][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-20 17:08:38,248][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-20 17:08:38,249][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-20 17:08:38,250][__main__][INFO] - Instantiating loggers...
[2023-04-20 17:08:38,250][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-20 17:08:56,092][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-20 17:08:56,147][__main__][INFO] - Logging hyperparameters!
[2023-04-20 17:08:56,161][__main__][INFO] - Starting training!
[2023-04-20 17:09:07,333][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_unidec_module.py", line 126, in validation_step
    loss_ori, loss_aug, outputs = self.model_step(batch, train=False, inference=False)
  File "/workspace/slotaug/src/models/slotaug_ae_unidec_module.py", line 94, in model_step
    outputs = self.forward(img_ori, img_aug, insts, train=train, inference=inference)
  File "/workspace/slotaug/src/models/slotaug_ae_unidec_module.py", line 84, in forward
    outputs = self.net(img_ori, img_aug, insts, train=train)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug_ae_unidec.py", line 83, in forward
    slota_outputs = self.slot_attention(inputs=x, insts=insts, train=train, inference=inference)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug_unidec.py", line 303, in forward
    uni_slots = self.slot_unifier(torch.cat([torch.zeros_like(slots[:, 0:1, :]), slots]), dim=1)[:, 0:1, :] # (B, 1, N_uni_slots)
RuntimeError: Sizes of tensors must match except in dimension 0. Expected size 1 but got size 7 for tensor number 1 in the list.
[2023-04-20 17:09:07,339][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3_unidec_31/2023-04-20_17-08-37_dgx_gpu4
[2023-04-20 17:09:07,339][src.utils.utils][INFO] - Closing loggers...
[2023-04-20 17:09:07,340][src.utils.utils][INFO] - Closing wandb!
[2023-04-20 17:12:54,676][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-20 17:12:54,685][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-20 17:12:54,798][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-20 17:12:54,804][__main__][INFO] - Instantiating model <src.models.slotaug_ae_unidec_module.LitSlotAttentionAutoEncoderUnifiedDecoder>
[2023-04-20 17:12:55,080][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpg9sqjsoe
[2023-04-20 17:12:55,080][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpg9sqjsoe/_remote_module_non_sriptable.py
[2023-04-20 17:12:55,120][__main__][INFO] - Instantiating callbacks...
[2023-04-20 17:12:55,121][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-20 17:12:55,125][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-20 17:12:55,126][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-20 17:12:55,127][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-20 17:12:55,128][__main__][INFO] - Instantiating loggers...
[2023-04-20 17:12:55,129][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-20 17:13:13,217][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-20 17:13:13,270][__main__][INFO] - Logging hyperparameters!
[2023-04-20 17:13:13,283][__main__][INFO] - Starting training!
[2023-04-20 17:13:23,875][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_unidec_module.py", line 126, in validation_step
    loss_ori, loss_aug, outputs = self.model_step(batch, train=False, inference=False)
  File "/workspace/slotaug/src/models/slotaug_ae_unidec_module.py", line 94, in model_step
    outputs = self.forward(img_ori, img_aug, insts, train=train, inference=inference)
  File "/workspace/slotaug/src/models/slotaug_ae_unidec_module.py", line 84, in forward
    outputs = self.net(img_ori, img_aug, insts, train=train)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug_ae_unidec.py", line 83, in forward
    slota_outputs = self.slot_attention(inputs=x, insts=insts, train=train, inference=inference)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug_unidec.py", line 304, in forward
    uni_slots = self.slot_unifier(torch.cat([torch.zeros(B, 1, D_slot), slots]), dim=1)[:, 0:1, :] # (B, 1, N_uni_slot)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument tensors in method wrapper___cat)
[2023-04-20 17:13:23,883][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3_unidec_31/2023-04-20_17-12-54_dgx_gpu4
[2023-04-20 17:13:23,883][src.utils.utils][INFO] - Closing loggers...
[2023-04-20 17:13:23,884][src.utils.utils][INFO] - Closing wandb!
[2023-04-20 17:14:36,646][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-20 17:14:36,655][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-20 17:14:36,763][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-20 17:14:36,769][__main__][INFO] - Instantiating model <src.models.slotaug_ae_unidec_module.LitSlotAttentionAutoEncoderUnifiedDecoder>
[2023-04-20 17:14:37,027][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp46ifuzxa
[2023-04-20 17:14:37,028][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp46ifuzxa/_remote_module_non_sriptable.py
[2023-04-20 17:14:37,071][__main__][INFO] - Instantiating callbacks...
[2023-04-20 17:14:37,072][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-20 17:14:37,076][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-20 17:14:37,077][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-20 17:14:37,078][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-20 17:14:37,079][__main__][INFO] - Instantiating loggers...
[2023-04-20 17:14:37,080][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-20 17:14:54,787][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-20 17:14:54,847][__main__][INFO] - Logging hyperparameters!
[2023-04-20 17:14:54,861][__main__][INFO] - Starting training!
[2023-04-20 17:15:05,443][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_unidec_module.py", line 126, in validation_step
    loss_ori, loss_aug, outputs = self.model_step(batch, train=False, inference=False)
  File "/workspace/slotaug/src/models/slotaug_ae_unidec_module.py", line 94, in model_step
    outputs = self.forward(img_ori, img_aug, insts, train=train, inference=inference)
  File "/workspace/slotaug/src/models/slotaug_ae_unidec_module.py", line 84, in forward
    outputs = self.net(img_ori, img_aug, insts, train=train)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug_ae_unidec.py", line 83, in forward
    slota_outputs = self.slot_attention(inputs=x, insts=insts, train=train, inference=inference)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug_unidec.py", line 303, in forward
    uni_slots = self.slot_unifier(torch.cat([torch.zeros(B, 1, D_slot).to(slots.device), slots]), dim=1)[:, 0:1, :] # (B, 1, N_uni_slot)
RuntimeError: Sizes of tensors must match except in dimension 0. Expected size 1 but got size 7 for tensor number 1 in the list.
[2023-04-20 17:15:05,449][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3_unidec_31/2023-04-20_17-14-36_dgx_gpu4
[2023-04-20 17:15:05,449][src.utils.utils][INFO] - Closing loggers...
[2023-04-20 17:15:05,449][src.utils.utils][INFO] - Closing wandb!
[2023-04-20 17:16:59,136][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-20 17:16:59,146][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-20 17:16:59,264][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-20 17:16:59,270][__main__][INFO] - Instantiating model <src.models.slotaug_ae_unidec_module.LitSlotAttentionAutoEncoderUnifiedDecoder>
[2023-04-20 17:16:59,525][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpuvgtvrfk
[2023-04-20 17:16:59,526][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpuvgtvrfk/_remote_module_non_sriptable.py
[2023-04-20 17:16:59,571][__main__][INFO] - Instantiating callbacks...
[2023-04-20 17:16:59,572][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-20 17:16:59,576][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-20 17:16:59,578][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-20 17:16:59,579][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-20 17:16:59,580][__main__][INFO] - Instantiating loggers...
[2023-04-20 17:16:59,580][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-20 17:17:17,343][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-20 17:17:17,394][__main__][INFO] - Logging hyperparameters!
[2023-04-20 17:17:17,406][__main__][INFO] - Starting training!
[2023-04-20 17:17:27,849][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_unidec_module.py", line 126, in validation_step
    loss_ori, loss_aug, outputs = self.model_step(batch, train=False, inference=False)
  File "/workspace/slotaug/src/models/slotaug_ae_unidec_module.py", line 94, in model_step
    outputs = self.forward(img_ori, img_aug, insts, train=train, inference=inference)
  File "/workspace/slotaug/src/models/slotaug_ae_unidec_module.py", line 84, in forward
    outputs = self.net(img_ori, img_aug, insts, train=train)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug_ae_unidec.py", line 83, in forward
    slota_outputs = self.slot_attention(inputs=x, insts=insts, train=train, inference=inference)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug_unidec.py", line 303, in forward
    uni_slots = self.slot_unifier(torch.cat([torch.zeros(B, 1, D_slot).to(slots.device), slots], dim=1))[:, 0:1, :] # (B, 1, N_uni_slot)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/transformer.py", line 202, in forward
    output = mod(output, src_mask=mask, src_key_padding_mask=src_key_padding_mask)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/transformer.py", line 344, in forward
    x = self.norm1(x + self._sa_block(x, src_mask, src_key_padding_mask))
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/transformer.py", line 352, in _sa_block
    x = self.self_attn(x, x, x,
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/activation.py", line 1038, in forward
    attn_output, attn_output_weights = F.multi_head_attention_forward(
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/functional.py", line 5226, in multi_head_attention_forward
    assert embed_dim == embed_dim_to_check, \
AssertionError: was expecting embedding dimension of 144, but got 72
[2023-04-20 17:17:27,857][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3_unidec_31/2023-04-20_17-16-58_dgx_gpu4
[2023-04-20 17:17:27,857][src.utils.utils][INFO] - Closing loggers...
[2023-04-20 17:17:27,857][src.utils.utils][INFO] - Closing wandb!
[2023-04-20 17:25:37,791][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-20 17:25:37,800][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-20 17:25:37,916][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-20 17:25:37,924][__main__][INFO] - Instantiating model <src.models.slotaug_ae_unidec_module.LitSlotAttentionAutoEncoderUnifiedDecoder>
[2023-04-20 17:25:38,153][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpqmh2e08o
[2023-04-20 17:25:38,154][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpqmh2e08o/_remote_module_non_sriptable.py
[2023-04-20 17:25:38,198][__main__][INFO] - Instantiating callbacks...
[2023-04-20 17:25:38,199][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-20 17:25:38,203][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-20 17:25:38,205][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-20 17:25:38,206][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-20 17:25:38,207][__main__][INFO] - Instantiating loggers...
[2023-04-20 17:25:38,207][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-20 17:25:55,948][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-20 17:25:55,999][__main__][INFO] - Logging hyperparameters!
[2023-04-20 17:25:56,012][__main__][INFO] - Starting training!
[2023-04-20 17:26:06,508][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_unidec_module.py", line 126, in validation_step
    loss_ori, loss_aug, outputs = self.model_step(batch, train=False, inference=False)
  File "/workspace/slotaug/src/models/slotaug_ae_unidec_module.py", line 94, in model_step
    outputs = self.forward(img_ori, img_aug, insts, train=train, inference=inference)
  File "/workspace/slotaug/src/models/slotaug_ae_unidec_module.py", line 84, in forward
    outputs = self.net(img_ori, img_aug, insts, train=train)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug_ae_unidec.py", line 94, in forward
    recons = x.reshape(B, self.num_slots, H, W, C) # no alpha map in unidec
RuntimeError: shape '[64, 7, 128, 128, 3]' is invalid for input of size 3145728
[2023-04-20 17:26:06,513][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3_unidec_31/2023-04-20_17-25-37_dgx_gpu4
[2023-04-20 17:26:06,514][src.utils.utils][INFO] - Closing loggers...
[2023-04-20 17:26:06,514][src.utils.utils][INFO] - Closing wandb!
[2023-04-20 17:27:39,198][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-20 17:27:39,206][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-20 17:27:39,314][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-20 17:27:39,319][__main__][INFO] - Instantiating model <src.models.slotaug_ae_unidec_module.LitSlotAttentionAutoEncoderUnifiedDecoder>
[2023-04-20 17:27:39,566][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmppkkxiw1z
[2023-04-20 17:27:39,567][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmppkkxiw1z/_remote_module_non_sriptable.py
[2023-04-20 17:27:39,624][__main__][INFO] - Instantiating callbacks...
[2023-04-20 17:27:39,625][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-20 17:27:39,630][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-20 17:27:39,631][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-20 17:27:39,632][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-20 17:27:39,633][__main__][INFO] - Instantiating loggers...
[2023-04-20 17:27:39,634][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-20 17:27:57,398][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-20 17:27:57,464][__main__][INFO] - Logging hyperparameters!
[2023-04-20 17:27:57,477][__main__][INFO] - Starting training!
[2023-04-20 17:28:08,067][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_unidec_module.py", line 126, in validation_step
    loss_ori, loss_aug, outputs = self.model_step(batch, train=False, inference=False)
  File "/workspace/slotaug/src/models/slotaug_ae_unidec_module.py", line 94, in model_step
    outputs = self.forward(img_ori, img_aug, insts, train=train, inference=inference)
  File "/workspace/slotaug/src/models/slotaug_ae_unidec_module.py", line 84, in forward
    outputs = self.net(img_ori, img_aug, insts, train=train)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug_ae_unidec.py", line 107, in forward
    recon_combined = recon_combined.permute(0, 3, 1, 2)
RuntimeError: number of dims don't match in permute
[2023-04-20 17:28:08,072][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3_unidec_31/2023-04-20_17-27-39_dgx_gpu4
[2023-04-20 17:28:08,072][src.utils.utils][INFO] - Closing loggers...
[2023-04-20 17:28:08,073][src.utils.utils][INFO] - Closing wandb!
[2023-04-20 17:28:36,788][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-20 17:28:36,798][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-20 17:28:36,915][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-20 17:28:36,921][__main__][INFO] - Instantiating model <src.models.slotaug_ae_unidec_module.LitSlotAttentionAutoEncoderUnifiedDecoder>
[2023-04-20 17:28:37,166][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp09_qwaf4
[2023-04-20 17:28:37,167][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp09_qwaf4/_remote_module_non_sriptable.py
[2023-04-20 17:28:37,247][__main__][INFO] - Instantiating callbacks...
[2023-04-20 17:28:37,248][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-20 17:28:37,252][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-20 17:28:37,254][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-20 17:28:37,255][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-20 17:28:37,256][__main__][INFO] - Instantiating loggers...
[2023-04-20 17:28:37,256][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-20 17:28:55,028][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-20 17:28:55,079][__main__][INFO] - Logging hyperparameters!
[2023-04-20 17:28:55,091][__main__][INFO] - Starting training!
[2023-04-20 17:29:05,805][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_unidec_module.py", line 126, in validation_step
    loss_ori, loss_aug, outputs = self.model_step(batch, train=False, inference=False)
  File "/workspace/slotaug/src/models/slotaug_ae_unidec_module.py", line 94, in model_step
    outputs = self.forward(img_ori, img_aug, insts, train=train, inference=inference)
  File "/workspace/slotaug/src/models/slotaug_ae_unidec_module.py", line 84, in forward
    outputs = self.net(img_ori, img_aug, insts, train=train)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug_ae_unidec.py", line 117, in forward
    outputs["masks"] = ["attns"][:, -1:].unsqueeze(0) # no alpha mask in unidec
TypeError: list indices must be integers or slices, not tuple
[2023-04-20 17:29:05,811][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3_unidec_31/2023-04-20_17-28-36_dgx_gpu4
[2023-04-20 17:29:05,811][src.utils.utils][INFO] - Closing loggers...
[2023-04-20 17:29:05,812][src.utils.utils][INFO] - Closing wandb!
[2023-04-20 17:31:32,802][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-20 17:31:32,812][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-20 17:31:32,928][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-20 17:31:32,935][__main__][INFO] - Instantiating model <src.models.slotaug_ae_unidec_module.LitSlotAttentionAutoEncoderUnifiedDecoder>
[2023-04-20 17:31:33,245][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpw7cw3kgz
[2023-04-20 17:31:33,246][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpw7cw3kgz/_remote_module_non_sriptable.py
[2023-04-20 17:31:33,286][__main__][INFO] - Instantiating callbacks...
[2023-04-20 17:31:33,287][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-20 17:31:33,291][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-20 17:31:33,292][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-20 17:31:33,293][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-20 17:31:33,294][__main__][INFO] - Instantiating loggers...
[2023-04-20 17:31:33,295][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-20 17:31:51,138][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-20 17:31:51,194][__main__][INFO] - Logging hyperparameters!
[2023-04-20 17:31:51,207][__main__][INFO] - Starting training!
[2023-04-20 17:32:01,760][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_unidec_module.py", line 126, in validation_step
    loss_ori, loss_aug, outputs = self.model_step(batch, train=False, inference=False)
  File "/workspace/slotaug/src/models/slotaug_ae_unidec_module.py", line 94, in model_step
    outputs = self.forward(img_ori, img_aug, insts, train=train, inference=inference)
  File "/workspace/slotaug/src/models/slotaug_ae_unidec_module.py", line 84, in forward
    outputs = self.net(img_ori, img_aug, insts, train=train)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug_ae_unidec.py", line 117, in forward
    outputs["masks"] = ["attns"][:, -1:].unsqueeze(0) # no alpha mask in unidec
TypeError: list indices must be integers or slices, not tuple
[2023-04-20 17:32:01,765][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3_unidec_31/2023-04-20_17-31-32_dgx_gpu4
[2023-04-20 17:32:01,766][src.utils.utils][INFO] - Closing loggers...
[2023-04-20 17:32:01,766][src.utils.utils][INFO] - Closing wandb!
[2023-04-20 17:36:04,440][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-20 17:36:04,451][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-20 17:36:04,566][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-20 17:36:04,572][__main__][INFO] - Instantiating model <src.models.slotaug_ae_unidec_module.LitSlotAttentionAutoEncoderUnifiedDecoder>
[2023-04-20 17:36:04,800][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmptqd64m5u
[2023-04-20 17:36:04,801][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmptqd64m5u/_remote_module_non_sriptable.py
[2023-04-20 17:36:04,840][__main__][INFO] - Instantiating callbacks...
[2023-04-20 17:36:04,841][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-20 17:36:04,845][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-20 17:36:04,846][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-20 17:36:04,847][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-20 17:36:04,848][__main__][INFO] - Instantiating loggers...
[2023-04-20 17:36:04,849][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-20 17:36:22,572][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-20 17:36:22,625][__main__][INFO] - Logging hyperparameters!
[2023-04-20 17:36:22,638][__main__][INFO] - Starting training!
[2023-04-20 17:36:33,123][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_unidec_module.py", line 137, in validation_step
    self.val_fg_ari_ori.evaluate(outputs["masks"].squeeze(-1), batch["masks_ori"][:, 1:].squeeze(-1))
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1185, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'LitSlotAttentionAutoEncoderUnifiedDecoder' object has no attribute 'val_fg_ari_ori'
[2023-04-20 17:36:33,128][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3_unidec_31/2023-04-20_17-36-04_dgx_gpu4
[2023-04-20 17:36:33,128][src.utils.utils][INFO] - Closing loggers...
[2023-04-20 17:36:33,129][src.utils.utils][INFO] - Closing wandb!
[2023-04-20 17:38:12,188][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-20 17:38:12,197][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-20 17:38:12,307][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-20 17:38:12,313][__main__][INFO] - Instantiating model <src.models.slotaug_ae_unidec_module.LitSlotAttentionAutoEncoderUnifiedDecoder>
[2023-04-20 17:38:12,545][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmprhyxry1p
[2023-04-20 17:38:12,545][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmprhyxry1p/_remote_module_non_sriptable.py
[2023-04-20 17:38:12,597][__main__][INFO] - Instantiating callbacks...
[2023-04-20 17:38:12,598][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-20 17:38:12,602][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-20 17:38:12,603][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-20 17:38:12,604][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-20 17:38:12,605][__main__][INFO] - Instantiating loggers...
[2023-04-20 17:38:12,606][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-20 17:38:21,170][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3_commu_31/2023-04-18_17-18-23_dgx_gpu7
[2023-04-20 17:38:21,171][src.utils.utils][INFO] - Closing loggers...
[2023-04-20 17:38:21,171][src.utils.utils][INFO] - Closing wandb!
[2023-04-20 17:38:30,380][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-20 17:38:30,431][__main__][INFO] - Logging hyperparameters!
[2023-04-20 17:38:30,444][__main__][INFO] - Starting training!
[2023-04-20 17:38:40,838][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_unidec_module.py", line 150, in validation_step
    vis_ori = visualize(
  File "/workspace/slotaug/src/utils/vis_utils.py", line 23, in visualize
    _, K, H, W, _ = pred_masks.shape
ValueError: not enough values to unpack (expected 5, got 4)
[2023-04-20 17:38:40,842][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3_unidec_31/2023-04-20_17-38-12_dgx_gpu4
[2023-04-20 17:38:40,843][src.utils.utils][INFO] - Closing loggers...
[2023-04-20 17:38:40,843][src.utils.utils][INFO] - Closing wandb!
[2023-04-20 17:39:49,849][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-20 17:39:49,858][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-20 17:39:49,968][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-20 17:39:49,974][__main__][INFO] - Instantiating model <src.models.slotaug_ae_unidec_module.LitSlotAttentionAutoEncoderUnifiedDecoder>
[2023-04-20 17:39:50,219][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp2qb28v2y
[2023-04-20 17:39:50,220][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp2qb28v2y/_remote_module_non_sriptable.py
[2023-04-20 17:39:50,259][__main__][INFO] - Instantiating callbacks...
[2023-04-20 17:39:50,260][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-20 17:39:50,265][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-20 17:39:50,267][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-20 17:39:50,268][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-20 17:39:50,269][__main__][INFO] - Instantiating loggers...
[2023-04-20 17:39:50,269][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-20 17:40:07,994][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-20 17:40:08,051][__main__][INFO] - Logging hyperparameters!
[2023-04-20 17:40:08,064][__main__][INFO] - Starting training!
[2023-04-20 17:40:18,419][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_unidec_module.py", line 150, in validation_step
    vis_ori = visualize(
  File "/workspace/slotaug/src/utils/vis_utils.py", line 123, in visualize
    picture[-1] = recons[:, k, :, :, :] * pred_seg_masks[:, k, :, :, :] + (
IndexError: too many indices for tensor of dimension 4
[2023-04-20 17:40:18,425][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3_unidec_31/2023-04-20_17-39-49_dgx_gpu4
[2023-04-20 17:40:18,426][src.utils.utils][INFO] - Closing loggers...
[2023-04-20 17:40:18,426][src.utils.utils][INFO] - Closing wandb!
[2023-04-20 17:43:05,469][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-20 17:43:05,479][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-20 17:43:05,588][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-20 17:43:05,594][__main__][INFO] - Instantiating model <src.models.slotaug_ae_unidec_module.LitSlotAttentionAutoEncoderUnifiedDecoder>
[2023-04-20 17:43:05,841][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp5pna3tqv
[2023-04-20 17:43:05,842][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp5pna3tqv/_remote_module_non_sriptable.py
[2023-04-20 17:43:05,881][__main__][INFO] - Instantiating callbacks...
[2023-04-20 17:43:05,881][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-20 17:43:05,886][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-20 17:43:05,887][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-20 17:43:05,888][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-20 17:43:05,889][__main__][INFO] - Instantiating loggers...
[2023-04-20 17:43:05,890][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-20 17:43:23,630][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-20 17:43:23,686][__main__][INFO] - Logging hyperparameters!
[2023-04-20 17:43:23,699][__main__][INFO] - Starting training!
[2023-04-20 17:43:34,012][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_unidec_module.py", line 150, in validation_step
    vis_ori = visualize(
  File "/workspace/slotaug/src/utils/vis_utils.py", line 123, in visualize
    picture[-1] = recons[:, k, :, :, :] * pred_seg_masks[:, k, :, :, :] + (
IndexError: index 3 is out of bounds for dimension 1 with size 3
[2023-04-20 17:43:34,017][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3_unidec_31/2023-04-20_17-43-05_dgx_gpu4
[2023-04-20 17:43:34,017][src.utils.utils][INFO] - Closing loggers...
[2023-04-20 17:43:34,017][src.utils.utils][INFO] - Closing wandb!
[2023-04-20 17:44:19,561][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-20 17:44:19,569][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-20 17:44:19,678][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-20 17:44:19,684][__main__][INFO] - Instantiating model <src.models.slotaug_ae_unidec_module.LitSlotAttentionAutoEncoderUnifiedDecoder>
[2023-04-20 17:44:19,933][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp66zp_bgg
[2023-04-20 17:44:19,934][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp66zp_bgg/_remote_module_non_sriptable.py
[2023-04-20 17:44:19,979][__main__][INFO] - Instantiating callbacks...
[2023-04-20 17:44:19,979][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-20 17:44:19,984][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-20 17:44:19,985][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-20 17:44:19,986][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-20 17:44:19,987][__main__][INFO] - Instantiating loggers...
[2023-04-20 17:44:19,988][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-20 17:44:37,698][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-20 17:44:37,752][__main__][INFO] - Logging hyperparameters!
[2023-04-20 17:44:37,765][__main__][INFO] - Starting training!
[2023-04-20 17:44:54,643][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 206, in run
    output = self.on_run_end()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 180, in on_run_end
    self._evaluation_epoch_end(self._outputs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 288, in _evaluation_epoch_end
    self.trainer._call_lightning_module_hook(hook_name, output_or_outputs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1356, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_unidec_module.py", line 202, in validation_epoch_end
    self.log_dict(
TypeError: log_dict() missing 1 required positional argument: 'dictionary'
[2023-04-20 17:44:54,647][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3_unidec_31/2023-04-20_17-44-19_dgx_gpu4
[2023-04-20 17:44:54,648][src.utils.utils][INFO] - Closing loggers...
[2023-04-20 17:44:54,648][src.utils.utils][INFO] - Closing wandb!
[2023-04-20 17:46:09,707][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-20 17:46:09,717][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-20 17:46:09,840][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-20 17:46:09,846][__main__][INFO] - Instantiating model <src.models.slotaug_ae_unidec_module.LitSlotAttentionAutoEncoderUnifiedDecoder>
[2023-04-20 17:46:10,079][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpq_ofhc8w
[2023-04-20 17:46:10,080][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpq_ofhc8w/_remote_module_non_sriptable.py
[2023-04-20 17:46:10,122][__main__][INFO] - Instantiating callbacks...
[2023-04-20 17:46:10,123][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-20 17:46:10,128][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-20 17:46:10,129][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-20 17:46:10,130][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-20 17:46:10,131][__main__][INFO] - Instantiating loggers...
[2023-04-20 17:46:10,131][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-20 17:46:28,060][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-20 17:46:28,111][__main__][INFO] - Logging hyperparameters!
[2023-04-20 17:46:28,124][__main__][INFO] - Starting training!
[2023-04-20 17:48:47,698][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-20 17:48:47,707][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-20 17:48:47,825][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-20 17:48:47,832][__main__][INFO] - Instantiating model <src.models.slotaug_ae_unidec_module.LitSlotAttentionAutoEncoderUnifiedDecoder>
[2023-04-20 17:48:48,101][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp_11ztyie
[2023-04-20 17:48:48,101][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp_11ztyie/_remote_module_non_sriptable.py
[2023-04-20 17:48:48,142][__main__][INFO] - Instantiating callbacks...
[2023-04-20 17:48:48,142][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-20 17:48:48,146][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-20 17:48:48,147][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-20 17:48:48,148][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-20 17:48:48,149][__main__][INFO] - Instantiating loggers...
[2023-04-20 17:48:48,150][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-20 17:49:06,008][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-20 17:49:06,078][__main__][INFO] - Logging hyperparameters!
[2023-04-20 17:49:06,095][__main__][INFO] - Starting training!
[2023-04-20 19:30:06,919][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1214, in _run_train
    self.fit_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 267, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.on_advance_end()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 250, in on_advance_end
    self._run_validation()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 308, in _run_validation
    self.val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 206, in run
    output = self.on_run_end()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 198, in on_run_end
    self._on_evaluation_end()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 262, in _on_evaluation_end
    self.trainer._call_callback_hooks(hook_name, *args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1394, in _call_callback_hooks
    fn(self, self.lightning_module, *args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/callbacks/model_checkpoint.py", line 312, in on_validation_end
    self._save_topk_checkpoint(trainer, monitor_candidates)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/callbacks/model_checkpoint.py", line 359, in _save_topk_checkpoint
    raise MisconfigurationException(m)
lightning_fabric.utilities.exceptions.MisconfigurationException: `ModelCheckpoint(monitor='val/ari_aug')` could not find the monitored key in the returned metrics: ['train/loss_ori', 'train/loss_aug', 'train/loss_total', 'val/loss_ori', 'val/loss_aug', 'val/loss_total', 'epoch', 'step']. HINT: Did you call `log('val/ari_aug', value)` in the `LightningModule`?
[2023-04-20 19:30:06,924][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3_unidec_31/2023-04-20_17-46-09_dgx_gpu4
[2023-04-20 19:30:06,924][src.utils.utils][INFO] - Closing loggers...
[2023-04-20 19:30:06,925][src.utils.utils][INFO] - Closing wandb!
[2023-04-20 19:34:13,291][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1214, in _run_train
    self.fit_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 267, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.on_advance_end()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 250, in on_advance_end
    self._run_validation()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 308, in _run_validation
    self.val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 206, in run
    output = self.on_run_end()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 198, in on_run_end
    self._on_evaluation_end()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 262, in _on_evaluation_end
    self.trainer._call_callback_hooks(hook_name, *args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1394, in _call_callback_hooks
    fn(self, self.lightning_module, *args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/callbacks/model_checkpoint.py", line 312, in on_validation_end
    self._save_topk_checkpoint(trainer, monitor_candidates)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/callbacks/model_checkpoint.py", line 359, in _save_topk_checkpoint
    raise MisconfigurationException(m)
lightning_fabric.utilities.exceptions.MisconfigurationException: `ModelCheckpoint(monitor='val/ari_aug')` could not find the monitored key in the returned metrics: ['train/loss_ori', 'train/loss_aug', 'train/loss_total', 'val/loss_ori', 'val/loss_aug', 'val/loss_total', 'epoch', 'step']. HINT: Did you call `log('val/ari_aug', value)` in the `LightningModule`?
[2023-04-20 19:34:13,305][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3_unidec_x4_x2_31/2023-04-20_17-48-47_dgx_gpu7
[2023-04-20 19:34:13,305][src.utils.utils][INFO] - Closing loggers...
[2023-04-20 19:34:13,306][src.utils.utils][INFO] - Closing wandb!
[2023-04-21 04:50:37,913][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-21 04:50:37,922][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-21 04:50:38,030][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-21 04:50:38,038][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-21 04:50:38,246][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp1lk20n68
[2023-04-21 04:50:38,247][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp1lk20n68/_remote_module_non_sriptable.py
[2023-04-21 04:50:38,292][__main__][INFO] - Instantiating callbacks...
[2023-04-21 04:50:38,293][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-21 04:50:38,299][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-21 04:50:38,300][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-21 04:50:38,302][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-21 04:50:38,303][__main__][INFO] - Instantiating loggers...
[2023-04-21 04:50:38,303][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-21 04:50:56,233][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-21 04:50:56,284][__main__][INFO] - Logging hyperparameters!
[2023-04-21 04:50:56,297][__main__][INFO] - Starting training!
[2023-04-21 04:52:02,686][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_aug_slotaug_fid_test/2023-04-21_04-50-37_dgx_gpu7
[2023-04-21 04:52:02,687][src.utils.utils][INFO] - Closing loggers...
[2023-04-21 04:52:02,687][src.utils.utils][INFO] - Closing wandb!
[2023-04-21 04:52:24,714][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-21 06:00:37,709][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-21 06:00:37,718][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-21 06:00:37,829][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-21 06:00:37,838][__main__][INFO] - Instantiating model <src.models.slotaug_ae_unidec_module.LitSlotAttentionAutoEncoderUnifiedDecoder>
[2023-04-21 06:00:38,055][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpj42s7k5i
[2023-04-21 06:00:38,056][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpj42s7k5i/_remote_module_non_sriptable.py
[2023-04-21 06:00:38,094][__main__][INFO] - Instantiating callbacks...
[2023-04-21 06:00:38,094][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-21 06:00:38,099][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-21 06:00:38,100][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-21 06:00:38,101][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-21 06:00:38,102][__main__][INFO] - Instantiating loggers...
[2023-04-21 06:00:38,102][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-21 06:00:55,853][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-21 06:00:55,902][__main__][INFO] - Logging hyperparameters!
[2023-04-21 06:00:55,914][__main__][INFO] - Starting training!
[2023-04-21 06:01:18,153][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-21 06:01:18,162][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-21 06:01:18,269][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-21 06:01:18,275][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-21 06:01:18,499][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpummmz88w
[2023-04-21 06:01:18,499][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpummmz88w/_remote_module_non_sriptable.py
[2023-04-21 06:01:18,541][__main__][INFO] - Instantiating callbacks...
[2023-04-21 06:01:18,542][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-21 06:01:18,546][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-21 06:01:18,547][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-21 06:01:18,549][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-21 06:01:18,550][__main__][INFO] - Instantiating loggers...
[2023-04-21 06:01:18,550][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-21 06:01:36,300][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-21 06:01:36,356][__main__][INFO] - Logging hyperparameters!
[2023-04-21 06:01:36,368][__main__][INFO] - Starting training!
[2023-04-21 06:05:52,595][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_aug_slotaug_fid_test/2023-04-21_06-01-17_dgx_gpu7
[2023-04-21 06:05:52,596][src.utils.utils][INFO] - Closing loggers...
[2023-04-21 06:05:52,596][src.utils.utils][INFO] - Closing wandb!
[2023-04-21 06:06:04,959][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-21 06:06:04,967][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-21 06:06:05,083][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-21 06:06:05,088][__main__][INFO] - Instantiating model <src.models.slotaug_ae_unidec_module.LitSlotAttentionAutoEncoderUnifiedDecoder>
[2023-04-21 06:06:05,335][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmptdyww0_r
[2023-04-21 06:06:05,336][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmptdyww0_r/_remote_module_non_sriptable.py
[2023-04-21 06:06:05,385][__main__][INFO] - Instantiating callbacks...
[2023-04-21 06:06:05,385][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-21 06:06:05,390][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-21 06:06:05,391][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-21 06:06:05,392][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-21 06:06:05,393][__main__][INFO] - Instantiating loggers...
[2023-04-21 06:06:05,394][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-21 06:06:23,169][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-21 06:06:23,221][__main__][INFO] - Logging hyperparameters!
[2023-04-21 06:06:23,234][__main__][INFO] - Starting training!
[2023-04-21 11:03:20,958][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_tran_v3_curry500/2023-04-20_11-14-33_dgx_gpu5
[2023-04-21 11:03:20,959][src.utils.utils][INFO] - Closing loggers...
[2023-04-21 11:03:20,959][src.utils.utils][INFO] - Closing wandb!
[2023-04-21 11:03:33,573][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-21 11:03:33,582][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-21 11:03:33,701][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-21 11:03:33,708][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-21 11:03:33,897][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpj7mcjm8x
[2023-04-21 11:03:33,898][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpj7mcjm8x/_remote_module_non_sriptable.py
[2023-04-21 11:03:33,935][__main__][INFO] - Instantiating callbacks...
[2023-04-21 11:03:33,936][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-21 11:03:33,940][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-21 11:03:33,941][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-21 11:03:33,943][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-21 11:03:33,944][__main__][INFO] - Instantiating loggers...
[2023-04-21 11:03:33,944][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-21 11:03:51,985][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-21 11:03:52,044][__main__][INFO] - Logging hyperparameters!
[2023-04-21 11:03:52,057][__main__][INFO] - Starting training!
[2023-04-22 23:48:54,846][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3_unidec_31/2023-04-21_06-00-37_dgx_gpu4
[2023-04-22 23:48:54,847][src.utils.utils][INFO] - Closing loggers...
[2023-04-22 23:48:54,847][src.utils.utils][INFO] - Closing wandb!
[2023-04-22 23:49:13,510][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-23 00:41:20,846][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3_unidec_x4_x2_31/2023-04-21_06-06-04_dgx_gpu7
[2023-04-23 00:41:20,847][src.utils.utils][INFO] - Closing loggers...
[2023-04-23 00:41:20,847][src.utils.utils][INFO] - Closing wandb!
[2023-04-23 00:41:39,086][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-23 04:09:20,257][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_indi_soft_v3_31/2023-04-20_16-04-01_dgx_gpu6
[2023-04-23 04:09:20,258][src.utils.utils][INFO] - Closing loggers...
[2023-04-23 04:09:20,258][src.utils.utils][INFO] - Closing wandb!
[2023-04-23 04:09:39,277][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-23 08:46:57,145][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-23 08:46:57,153][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-23 08:46:57,254][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-23 08:46:57,260][__main__][INFO] - Instantiating model <src.models.slotaug_ae_unidec_module.LitSlotAttentionAutoEncoderUnifiedDecoder>
[2023-04-23 08:46:57,645][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpzuhu14f9
[2023-04-23 08:46:57,646][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpzuhu14f9/_remote_module_non_sriptable.py
[2023-04-23 08:46:57,695][__main__][INFO] - Instantiating callbacks...
[2023-04-23 08:46:57,696][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-23 08:46:57,700][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-23 08:46:57,701][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-23 08:46:57,702][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-23 08:46:57,703][__main__][INFO] - Instantiating loggers...
[2023-04-23 08:46:57,703][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-23 08:47:15,467][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-23 08:47:15,517][__main__][INFO] - Logging hyperparameters!
[2023-04-23 08:47:15,532][__main__][INFO] - Starting training!
[2023-04-23 08:47:35,323][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1214, in _run_train
    self.fit_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 267, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 213, in advance
    batch_output = self.batch_loop.run(kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 88, in advance
    outputs = self.optimizer_loop.run(optimizers, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 202, in advance
    result = self._run_optimization(kwargs, self._optimizers[self.optim_progress.optimizer_position])
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 249, in _run_optimization
    self._optimizer_step(optimizer, opt_idx, kwargs.get("batch_idx", 0), closure)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 370, in _optimizer_step
    self.trainer._call_lightning_module_hook(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1356, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/core/module.py", line 1742, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/core/optimizer.py", line 169, in step
    step_output = self._strategy.optimizer_step(self._optimizer, self._optimizer_idx, closure, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 234, in optimizer_step
    return self.precision_plugin.optimizer_step(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/plugins/precision/native_amp.py", line 75, in optimizer_step
    closure_result = closure()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 149, in __call__
    self._result = self.closure(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 135, in closure
    step_output = self._step_fn()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 419, in _training_step
    training_step_output = self.trainer._call_strategy_hook("training_step", *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in training_step
    return self.model.training_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_unidec_module.py", line 101, in training_step
    loss_ori, loss_aug, outputs = self.model_step(batch, train=True, inference=False)
  File "/workspace/slotaug/src/models/slotaug_ae_unidec_module.py", line 94, in model_step
    outputs = self.forward(img_ori, img_aug, insts, train=train, inference=inference)
  File "/workspace/slotaug/src/models/slotaug_ae_unidec_module.py", line 84, in forward
    outputs = self.net(img_ori, img_aug, insts, train=train)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug_ae_unidec.py", line 89, in forward
    x_aug = self.decoder_cnn(slots_aug)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slota_utils.py", line 191, in forward
    x = self.deconvs(x)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/container.py", line 141, in forward
    input = module(input)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/activation.py", line 98, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/functional.py", line 1442, in relu
    result = torch.relu(input)
RuntimeError: CUDA out of memory. Tried to allocate 576.00 MiB (GPU 0; 15.78 GiB total capacity; 13.69 GiB already allocated; 305.75 MiB free; 14.24 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2023-04-23 08:47:35,334][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3_unidec_x2_uni288_31/2023-04-23_08-46-56_dgx_gpu6
[2023-04-23 08:47:35,334][src.utils.utils][INFO] - Closing loggers...
[2023-04-23 08:47:35,335][src.utils.utils][INFO] - Closing wandb!
[2023-04-23 08:48:57,456][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-23 08:48:57,464][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-23 08:48:57,566][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-23 08:48:57,572][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-23 08:48:57,795][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpa6s1h7jm
[2023-04-23 08:48:57,796][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpa6s1h7jm/_remote_module_non_sriptable.py
[2023-04-23 08:48:57,831][__main__][INFO] - Instantiating callbacks...
[2023-04-23 08:48:57,831][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-23 08:48:57,836][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-23 08:48:57,837][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-23 08:48:57,838][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-23 08:48:57,839][__main__][INFO] - Instantiating loggers...
[2023-04-23 08:48:57,839][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-23 08:49:12,735][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3_ms3_31/2023-04-23_08-48-57_dgx_gpu6
[2023-04-23 08:49:12,736][src.utils.utils][INFO] - Closing loggers...
[2023-04-23 08:49:23,648][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-23 08:49:23,656][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-23 08:49:23,763][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-23 08:49:23,769][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-23 08:49:23,981][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp8hu83rjv
[2023-04-23 08:49:23,982][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp8hu83rjv/_remote_module_non_sriptable.py
[2023-04-23 08:49:24,018][__main__][INFO] - Instantiating callbacks...
[2023-04-23 08:49:24,018][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-23 08:49:24,022][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-23 08:49:24,024][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-23 08:49:24,026][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-23 08:49:24,027][__main__][INFO] - Instantiating loggers...
[2023-04-23 08:49:24,027][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-23 08:49:38,657][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-23 08:49:38,667][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-23 08:49:38,774][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-23 08:49:38,779][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-23 08:49:38,970][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmphf99y4r3
[2023-04-23 08:49:38,971][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmphf99y4r3/_remote_module_non_sriptable.py
[2023-04-23 08:49:39,009][__main__][INFO] - Instantiating callbacks...
[2023-04-23 08:49:39,009][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-23 08:49:39,014][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-23 08:49:39,015][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-23 08:49:39,017][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-23 08:49:39,018][__main__][INFO] - Instantiating loggers...
[2023-04-23 08:49:39,018][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-23 08:49:41,670][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-23 08:49:41,720][__main__][INFO] - Logging hyperparameters!
[2023-04-23 08:49:41,734][__main__][INFO] - Starting training!
[2023-04-23 08:49:56,707][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-23 08:49:56,760][__main__][INFO] - Logging hyperparameters!
[2023-04-23 08:49:56,775][__main__][INFO] - Starting training!
[2023-04-23 09:44:24,247][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3_ms2_31/2023-04-23_08-49-23_dgx_gpu6
[2023-04-23 09:44:24,247][src.utils.utils][INFO] - Closing loggers...
[2023-04-23 09:44:24,248][src.utils.utils][INFO] - Closing wandb!
[2023-04-23 09:44:24,616][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3_ms4_31/2023-04-23_08-49-38_dgx_gpu7
[2023-04-23 09:44:24,617][src.utils.utils][INFO] - Closing loggers...
[2023-04-23 09:44:24,617][src.utils.utils][INFO] - Closing wandb!
[2023-04-23 09:51:04,312][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-23 09:51:04,321][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-23 09:51:04,425][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-23 09:51:04,431][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-23 09:51:04,655][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp5ulpy89l
[2023-04-23 09:51:04,655][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp5ulpy89l/_remote_module_non_sriptable.py
[2023-04-23 09:51:04,689][__main__][INFO] - Instantiating callbacks...
[2023-04-23 09:51:04,690][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-23 09:51:04,694][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-23 09:51:04,695][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-23 09:51:04,696][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-23 09:51:04,697][__main__][INFO] - Instantiating loggers...
[2023-04-23 09:51:04,697][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-23 09:51:08,124][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-23 09:51:08,132][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-23 09:51:08,236][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-23 09:51:08,243][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-23 09:51:08,459][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpmd3dmjuw
[2023-04-23 09:51:08,459][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpmd3dmjuw/_remote_module_non_sriptable.py
[2023-04-23 09:51:08,494][__main__][INFO] - Instantiating callbacks...
[2023-04-23 09:51:08,495][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-23 09:51:08,499][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-23 09:51:08,501][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-23 09:51:08,502][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-23 09:51:08,503][__main__][INFO] - Instantiating loggers...
[2023-04-23 09:51:08,503][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-23 09:52:13,069][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loggers/wandb.py", line 357, in __init__
    _ = self.experiment
  File "/opt/conda/lib/python3.8/site-packages/lightning_fabric/loggers/logger.py", line 117, in experiment
    return get_experiment() or _DummyExperiment()
  File "/opt/conda/lib/python3.8/site-packages/lightning_utilities/core/rank_zero.py", line 27, in wrapped_fn
    return fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/lightning_fabric/loggers/logger.py", line 115, in get_experiment
    return fn(self)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loggers/wandb.py", line 405, in experiment
    self._experiment = wandb.init(**self._wandb_init)
  File "/opt/conda/lib/python3.8/site-packages/wandb/sdk/wandb_init.py", line 1164, in init
    raise e
  File "/opt/conda/lib/python3.8/site-packages/wandb/sdk/wandb_init.py", line 1145, in init
    run = wi.init()
  File "/opt/conda/lib/python3.8/site-packages/wandb/sdk/wandb_init.py", line 764, in init
    raise error
wandb.errors.CommError: Run initialization has timed out after 60.0 sec. 
Please refer to the documentation for additional information: https://docs.wandb.ai/guides/track/tracking-faq#initstarterror-error-communicating-with-wandb-process-

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 62, in train
    logger: List[Logger] = utils.instantiate_loggers(cfg.get("logger"))
  File "/workspace/slotaug/src/utils/utils.py", line 127, in instantiate_loggers
    logger.append(hydra.utils.instantiate(lg_conf))
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'pytorch_lightning.loggers.wandb.WandbLogger':
CommError('Run initialization has timed out after 60.0 sec. \nPlease refer to the documentation for additional information: https://docs.wandb.ai/guides/track/tracking-faq#initstarterror-error-communicating-with-wandb-process-')
full_key: logger.wandb
[2023-04-23 09:52:13,071][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3_ms2_31/2023-04-23_09-51-04_dgx_gpu6
[2023-04-23 09:52:13,071][src.utils.utils][INFO] - Closing loggers...
[2023-04-23 09:52:16,900][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loggers/wandb.py", line 357, in __init__
    _ = self.experiment
  File "/opt/conda/lib/python3.8/site-packages/lightning_fabric/loggers/logger.py", line 117, in experiment
    return get_experiment() or _DummyExperiment()
  File "/opt/conda/lib/python3.8/site-packages/lightning_utilities/core/rank_zero.py", line 27, in wrapped_fn
    return fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/lightning_fabric/loggers/logger.py", line 115, in get_experiment
    return fn(self)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loggers/wandb.py", line 405, in experiment
    self._experiment = wandb.init(**self._wandb_init)
  File "/opt/conda/lib/python3.8/site-packages/wandb/sdk/wandb_init.py", line 1164, in init
    raise e
  File "/opt/conda/lib/python3.8/site-packages/wandb/sdk/wandb_init.py", line 1145, in init
    run = wi.init()
  File "/opt/conda/lib/python3.8/site-packages/wandb/sdk/wandb_init.py", line 764, in init
    raise error
wandb.errors.CommError: Run initialization has timed out after 60.0 sec. 
Please refer to the documentation for additional information: https://docs.wandb.ai/guides/track/tracking-faq#initstarterror-error-communicating-with-wandb-process-

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 62, in train
    logger: List[Logger] = utils.instantiate_loggers(cfg.get("logger"))
  File "/workspace/slotaug/src/utils/utils.py", line 127, in instantiate_loggers
    logger.append(hydra.utils.instantiate(lg_conf))
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'pytorch_lightning.loggers.wandb.WandbLogger':
CommError('Run initialization has timed out after 60.0 sec. \nPlease refer to the documentation for additional information: https://docs.wandb.ai/guides/track/tracking-faq#initstarterror-error-communicating-with-wandb-process-')
full_key: logger.wandb
[2023-04-23 09:52:16,903][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3_ms4_31/2023-04-23_09-51-07_dgx_gpu7
[2023-04-23 09:52:16,903][src.utils.utils][INFO] - Closing loggers...
[2023-04-23 10:13:13,113][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_tran_v3_curry500/2023-04-21_11-03-33_dgx_gpu5
[2023-04-23 10:13:13,114][src.utils.utils][INFO] - Closing loggers...
[2023-04-23 10:13:13,115][src.utils.utils][INFO] - Closing wandb!
[2023-04-23 10:13:30,406][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-24 08:58:42,245][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-24 08:58:42,253][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-24 08:58:42,353][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-24 08:58:42,359][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-24 08:58:42,757][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpolidggkd
[2023-04-24 08:58:42,758][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpolidggkd/_remote_module_non_sriptable.py
[2023-04-24 08:58:42,798][__main__][INFO] - Instantiating callbacks...
[2023-04-24 08:58:42,798][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-24 08:58:42,802][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-24 08:58:42,803][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-24 08:58:42,804][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-24 08:58:42,805][__main__][INFO] - Instantiating loggers...
[2023-04-24 08:58:42,805][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-24 08:59:00,713][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-24 08:59:00,759][__main__][INFO] - Logging hyperparameters!
[2023-04-24 08:59:00,773][__main__][INFO] - Starting training!
[2023-04-24 08:59:48,512][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-24 08:59:48,522][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-24 08:59:48,627][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-24 08:59:48,635][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-24 08:59:49,029][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpgr8tkpaz
[2023-04-24 08:59:49,029][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpgr8tkpaz/_remote_module_non_sriptable.py
[2023-04-24 08:59:49,068][__main__][INFO] - Instantiating callbacks...
[2023-04-24 08:59:49,069][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-24 08:59:49,073][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-24 08:59:49,074][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-24 08:59:49,075][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-24 08:59:49,076][__main__][INFO] - Instantiating loggers...
[2023-04-24 08:59:49,076][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-24 09:00:06,765][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-24 09:00:06,818][__main__][INFO] - Logging hyperparameters!
[2023-04-24 09:00:06,830][__main__][INFO] - Starting training!
[2023-04-24 09:03:48,928][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-24 09:03:48,936][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-24 09:03:49,045][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-24 09:03:49,053][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-24 09:03:49,478][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp675mdzn5
[2023-04-24 09:03:49,479][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp675mdzn5/_remote_module_non_sriptable.py
[2023-04-24 09:03:49,513][__main__][INFO] - Instantiating callbacks...
[2023-04-24 09:03:49,514][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-24 09:03:49,518][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-24 09:03:49,519][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-24 09:03:49,520][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-24 09:03:49,521][__main__][INFO] - Instantiating loggers...
[2023-04-24 09:03:49,521][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-24 09:04:07,253][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-24 09:04:07,303][__main__][INFO] - Logging hyperparameters!
[2023-04-24 09:04:07,315][__main__][INFO] - Starting training!
[2023-04-24 09:04:45,810][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-24 09:04:45,818][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-24 09:04:45,928][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-24 09:04:45,934][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-24 09:04:46,327][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpidmsww69
[2023-04-24 09:04:46,328][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpidmsww69/_remote_module_non_sriptable.py
[2023-04-24 09:04:46,368][__main__][INFO] - Instantiating callbacks...
[2023-04-24 09:04:46,369][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-24 09:04:46,374][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-24 09:04:46,375][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-24 09:04:46,377][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-24 09:04:46,378][__main__][INFO] - Instantiating loggers...
[2023-04-24 09:04:46,378][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-24 09:05:04,396][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-24 09:05:04,458][__main__][INFO] - Logging hyperparameters!
[2023-04-24 09:05:04,472][__main__][INFO] - Starting training!
[2023-04-24 15:43:47,287][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_flip_hv_indi_soft_v3_/2023-04-24_08-59-48_dgx_gpu5
[2023-04-24 15:43:47,288][src.utils.utils][INFO] - Closing loggers...
[2023-04-24 15:43:47,289][src.utils.utils][INFO] - Closing wandb!
[2023-04-24 15:43:53,582][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-24 15:43:53,591][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-24 15:43:53,699][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-24 15:43:53,708][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-24 15:43:53,930][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpuc5m6ift
[2023-04-24 15:43:53,931][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpuc5m6ift/_remote_module_non_sriptable.py
[2023-04-24 15:43:53,972][__main__][INFO] - Instantiating callbacks...
[2023-04-24 15:43:53,973][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-24 15:43:53,978][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-24 15:43:53,979][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-24 15:43:53,980][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-24 15:43:53,981][__main__][INFO] - Instantiating loggers...
[2023-04-24 15:43:53,981][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-24 15:44:11,834][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-24 15:44:11,888][__main__][INFO] - Logging hyperparameters!
[2023-04-24 15:44:11,901][__main__][INFO] - Starting training!
[2023-04-24 15:52:29,640][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3__ms3/2023-04-24_09-03-48_dgx_gpu6
[2023-04-24 15:52:29,640][src.utils.utils][INFO] - Closing loggers...
[2023-04-24 15:52:29,641][src.utils.utils][INFO] - Closing wandb!
[2023-04-24 15:53:26,211][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-24 15:53:26,220][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-24 15:53:26,330][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-24 15:53:26,338][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAttentionAutoEncoder>
[2023-04-24 15:53:26,542][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpqoci7x9c
[2023-04-24 15:53:26,542][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpqoci7x9c/_remote_module_non_sriptable.py
[2023-04-24 15:53:26,619][__main__][INFO] - Instantiating callbacks...
[2023-04-24 15:53:26,620][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-24 15:53:26,624][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-24 15:53:26,625][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-24 15:53:26,626][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-24 15:53:26,627][__main__][INFO] - Instantiating loggers...
[2023-04-24 15:53:26,627][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-24 15:53:44,466][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-24 15:53:44,521][__main__][INFO] - Logging hyperparameters!
[2023-04-24 15:53:44,534][__main__][INFO] - Starting training!
[2023-04-25 06:58:45,025][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3_/2023-04-24_08-58-42_dgx_gpu4
[2023-04-25 06:58:45,026][src.utils.utils][INFO] - Closing loggers...
[2023-04-25 06:58:45,026][src.utils.utils][INFO] - Closing wandb!
[2023-04-25 06:58:54,632][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3__ms3/2023-04-24_15-53-26_dgx_gpu6
[2023-04-25 06:58:54,633][src.utils.utils][INFO] - Closing loggers...
[2023-04-25 06:58:54,634][src.utils.utils][INFO] - Closing wandb!
[2023-04-25 07:05:09,100][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-25 07:05:09,108][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-25 07:05:09,208][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR10AugDataModule>
[2023-04-25 07:05:09,214][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
  File "/opt/conda/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 970, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'src.data.clevr6_aug_datamodule.CLEVR10AugDataModule'; 'src.data.clevr6_aug_datamodule' is not a package

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/utils.py", line 653, in _locate
    raise ImportError(
ImportError: Error loading 'src.data.clevr6_aug_datamodule.CLEVR10AugDataModule':
ModuleNotFoundError("No module named 'src.data.clevr6_aug_datamodule.CLEVR10AugDataModule'; 'src.data.clevr6_aug_datamodule' is not a package")
Are you sure that 'CLEVR10AugDataModule' is importable from module 'src.data.clevr6_aug_datamodule'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 53, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.data)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.data.clevr6_aug_datamodule.CLEVR10AugDataModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: data
[2023-04-25 07:05:09,217][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv10_stc_slotaug/2023-04-25_07-05-08_dgx_gpu4
[2023-04-25 07:05:09,217][src.utils.utils][INFO] - Closing loggers...
[2023-04-25 07:06:20,153][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-25 07:06:20,161][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-25 07:06:20,267][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR10AugDataModule>
[2023-04-25 07:06:20,272][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
  File "/opt/conda/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 970, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'src.data.clevr6_aug_datamodule.CLEVR10AugDataModule'; 'src.data.clevr6_aug_datamodule' is not a package

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/utils.py", line 653, in _locate
    raise ImportError(
ImportError: Error loading 'src.data.clevr6_aug_datamodule.CLEVR10AugDataModule':
ModuleNotFoundError("No module named 'src.data.clevr6_aug_datamodule.CLEVR10AugDataModule'; 'src.data.clevr6_aug_datamodule' is not a package")
Are you sure that 'CLEVR10AugDataModule' is importable from module 'src.data.clevr6_aug_datamodule'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 53, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.data)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.data.clevr6_aug_datamodule.CLEVR10AugDataModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: data
[2023-04-25 07:06:20,274][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv10_stc_slotaug/2023-04-25_07-06-19_dgx_gpu4
[2023-04-25 07:06:20,274][src.utils.utils][INFO] - Closing loggers...
[2023-04-25 07:06:43,808][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-25 07:06:43,816][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-25 07:06:43,921][__main__][INFO] - Instantiating datamodule <src.data.clevr10_aug_datamodule.CLEVR10AugDataModule>
[2023-04-25 07:06:43,929][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-25 07:06:44,112][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/utils.py", line 644, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.models' has no attribute 'slotaug_ae_module'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
  File "/opt/conda/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 13, in <module>
    from src.utils.vis_utils import visualize
  File "/workspace/slotaug/src/utils/vis_utils.py", line 5, in <module>
    import matplotlib.pyplot as plt
ModuleNotFoundError: No module named 'matplotlib'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/utils.py", line 653, in _locate
    raise ImportError(
ImportError: Error loading 'src.models.slotaug_ae_module.LitSlotAugAutoEncoder':
ModuleNotFoundError("No module named 'matplotlib'")
Are you sure that 'slotaug_ae_module' is importable from module 'src.models'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 56, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.models.slotaug_ae_module.LitSlotAugAutoEncoder', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: model
[2023-04-25 07:06:44,114][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv10_stc_slotaug/2023-04-25_07-06-43_dgx_gpu4
[2023-04-25 07:06:44,114][src.utils.utils][INFO] - Closing loggers...
[2023-04-25 07:08:20,457][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-25 07:08:20,465][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-25 07:08:20,567][__main__][INFO] - Instantiating datamodule <src.data.clevr10_aug_datamodule.CLEVR10AugDataModule>
[2023-04-25 07:08:20,572][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-25 07:08:20,756][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/utils.py", line 644, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.models' has no attribute 'slotaug_ae_module'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
  File "/opt/conda/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 13, in <module>
    from src.utils.vis_utils import visualize
  File "/workspace/slotaug/src/utils/vis_utils.py", line 5, in <module>
    import matplotlib.pyplot as plt
ModuleNotFoundError: No module named 'matplotlib'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/utils.py", line 653, in _locate
    raise ImportError(
ImportError: Error loading 'src.models.slotaug_ae_module.LitSlotAugAutoEncoder':
ModuleNotFoundError("No module named 'matplotlib'")
Are you sure that 'slotaug_ae_module' is importable from module 'src.models'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 56, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.models.slotaug_ae_module.LitSlotAugAutoEncoder', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: model
[2023-04-25 07:08:20,759][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv10_stc_slotaug/2023-04-25_07-08-20_dgx_gpu4
[2023-04-25 07:08:20,759][src.utils.utils][INFO] - Closing loggers...
[2023-04-25 07:12:34,365][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-25 07:12:34,375][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-25 07:12:34,484][__main__][INFO] - Instantiating datamodule <src.data.clevr10_aug_datamodule.CLEVR10AugDataModule>
[2023-04-25 07:12:34,490][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-25 07:12:35,030][matplotlib.font_manager][INFO] - generated new fontManager
[2023-04-25 07:12:35,436][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp93g97p3n
[2023-04-25 07:12:35,436][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp93g97p3n/_remote_module_non_sriptable.py
[2023-04-25 07:12:35,492][__main__][INFO] - Instantiating callbacks...
[2023-04-25 07:12:35,492][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-25 07:12:35,496][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-25 07:12:35,497][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-25 07:12:35,498][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-25 07:12:35,499][__main__][INFO] - Instantiating loggers...
[2023-04-25 07:12:35,500][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-25 07:12:53,307][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-25 07:12:53,375][__main__][INFO] - Logging hyperparameters!
[2023-04-25 07:12:53,388][__main__][INFO] - Starting training!
[2023-04-25 07:13:09,436][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 148, in validation_step
    loss, outputs = self._shared_eval_step(batch, batch_idx)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 126, in _shared_eval_step
    loss_ori, loss_aug, outputs = self.model_step(batch)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 90, in model_step
    outputs = self.forward(img_ori, img_aug, insts)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 83, in forward
    outputs = self.net(img_ori, img_aug, insts)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug/slotaug_ae.py", line 77, in forward
    slota_outputs = self.slotaug(inputs=x, insts=insts)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug/slotaug.py", line 187, in forward
    insts = adjust_instrutions(
  File "/workspace/slotaug/src/models/components/slotaug/slotaug_utils.py", line 27, in adjust_instrutions
    adjusted_insts[:, :, 3:5] = insts[:, :, 3:5] + ((0.5 + (obj_pos - 0.5) * insts[:, :, 5:6]) - obj_pos)
RuntimeError: The size of tensor a (7) must match the size of tensor b (11) at non-singleton dimension 1
[2023-04-25 07:13:09,443][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv10_stc_slotaug/2023-04-25_07-12-34_dgx_gpu4
[2023-04-25 07:13:09,444][src.utils.utils][INFO] - Closing loggers...
[2023-04-25 07:13:09,444][src.utils.utils][INFO] - Closing wandb!
[2023-04-25 07:15:28,977][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-25 07:15:28,986][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-25 07:15:29,097][__main__][INFO] - Instantiating datamodule <src.data.clevr10_aug_datamodule.CLEVR10AugDataModule>
[2023-04-25 07:15:29,102][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-25 07:15:29,805][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpcw6eqwnu
[2023-04-25 07:15:29,806][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpcw6eqwnu/_remote_module_non_sriptable.py
[2023-04-25 07:15:29,852][__main__][INFO] - Instantiating callbacks...
[2023-04-25 07:15:29,853][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-25 07:15:29,858][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-25 07:15:29,859][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-25 07:15:29,860][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-25 07:15:29,860][__main__][INFO] - Instantiating loggers...
[2023-04-25 07:15:29,861][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-25 07:15:47,595][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-25 07:15:47,646][__main__][INFO] - Logging hyperparameters!
[2023-04-25 07:15:47,657][__main__][INFO] - Starting training!
[2023-04-25 07:18:36,347][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-25 07:18:36,357][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-25 07:18:36,472][__main__][INFO] - Instantiating datamodule <src.data.clevr10_aug_datamodule.CLEVR10AugDataModule>
[2023-04-25 07:18:36,478][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-25 07:18:37,044][matplotlib.font_manager][INFO] - generated new fontManager
[2023-04-25 07:18:37,473][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp1iz7fx0h
[2023-04-25 07:18:37,474][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp1iz7fx0h/_remote_module_non_sriptable.py
[2023-04-25 07:18:37,559][__main__][INFO] - Instantiating callbacks...
[2023-04-25 07:18:37,560][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-25 07:18:37,565][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-25 07:18:37,566][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-25 07:18:37,568][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-25 07:18:37,569][__main__][INFO] - Instantiating loggers...
[2023-04-25 07:18:37,569][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-25 07:18:55,358][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-25 07:18:55,433][__main__][INFO] - Logging hyperparameters!
[2023-04-25 07:18:55,446][__main__][INFO] - Starting training!
[2023-04-25 09:37:10,553][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-25 09:37:10,562][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-25 09:37:10,674][__main__][INFO] - Instantiating datamodule <src.data.clevrtex_aug_datamodule.ClevrTexAugDataModule>
[2023-04-25 09:37:10,681][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-25 09:37:11,309][matplotlib.font_manager][INFO] - generated new fontManager
[2023-04-25 09:37:11,740][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpupezy3_w
[2023-04-25 09:37:11,741][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpupezy3_w/_remote_module_non_sriptable.py
[2023-04-25 09:37:11,779][__main__][INFO] - Instantiating callbacks...
[2023-04-25 09:37:11,779][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-25 09:37:11,784][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-25 09:37:11,785][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-25 09:37:11,786][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-25 09:37:11,787][__main__][INFO] - Instantiating loggers...
[2023-04-25 09:37:11,787][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-25 09:37:43,068][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-25 09:37:43,124][__main__][INFO] - Logging hyperparameters!
[2023-04-25 09:37:43,136][__main__][INFO] - Starting training!
[2023-04-25 09:38:26,001][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clvt_stc_slotaug/2023-04-25_09-37-10_dgx_gpu3
[2023-04-25 09:38:26,002][src.utils.utils][INFO] - Closing loggers...
[2023-04-25 09:38:26,002][src.utils.utils][INFO] - Closing wandb!
[2023-04-25 09:38:49,095][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-25 11:41:28,436][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-25 11:41:28,446][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-25 11:41:28,563][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-25 11:41:28,573][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-25 11:41:29,287][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmprsvrah9s
[2023-04-25 11:41:29,288][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmprsvrah9s/_remote_module_non_sriptable.py
[2023-04-25 11:41:29,333][__main__][INFO] - Instantiating callbacks...
[2023-04-25 11:41:29,333][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-25 11:41:29,338][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-25 11:41:29,339][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-25 11:41:29,340][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-25 11:41:29,341][__main__][INFO] - Instantiating loggers...
[2023-04-25 11:41:29,342][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-25 11:41:57,146][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-25 11:41:57,209][__main__][INFO] - Logging hyperparameters!
[2023-04-25 11:41:57,224][__main__][INFO] - Starting training!
[2023-04-25 11:42:08,127][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 205, in validation_step
    loss, outputs = self._shared_eval_step(batch, batch_idx)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 164, in _shared_eval_step
    loss_ori_ori, loss_ori_aug, loss_aug_ori, loss_aug_aug, outputs = self.model_step(batch)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 112, in model_step
    insts_ori = batch["insts_ori"]
KeyError: 'insts_ori'
[2023-04-25 11:42:08,131][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stc_cycle_naive/2023-04-25_11-41-28_dgx_gpu3
[2023-04-25 11:42:08,132][src.utils.utils][INFO] - Closing loggers...
[2023-04-25 11:42:08,132][src.utils.utils][INFO] - Closing wandb!
[2023-04-25 11:43:49,533][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-25 11:43:49,542][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-25 11:43:49,655][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-25 11:43:49,661][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-25 11:43:50,353][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmplow34ilx
[2023-04-25 11:43:50,353][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmplow34ilx/_remote_module_non_sriptable.py
[2023-04-25 11:43:50,395][__main__][INFO] - Instantiating callbacks...
[2023-04-25 11:43:50,396][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-25 11:43:50,400][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-25 11:43:50,401][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-25 11:43:50,402][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-25 11:43:50,403][__main__][INFO] - Instantiating loggers...
[2023-04-25 11:43:50,404][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-25 11:44:08,200][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-25 11:44:08,256][__main__][INFO] - Logging hyperparameters!
[2023-04-25 11:44:08,269][__main__][INFO] - Starting training!
[2023-04-25 11:44:19,638][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 203, in validation_step
    loss, outputs = self._shared_eval_step(batch, batch_idx)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 162, in _shared_eval_step
    loss_ori_ori, loss_ori_aug, loss_aug_ori, loss_aug_aug, outputs = self.model_step(batch)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 112, in model_step
    outputs = self.forward(img_ori, img_aug, insts)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 105, in forward
    outputs = self.net(img_ori, img_aug, insts)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug/slotaug_ae.py", line 141, in forward
    outputs["attns_ori_aug"] = slotaug_outputs_ori["attns_aug"]
KeyError: 'attns_aug'
[2023-04-25 11:44:19,644][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stc_cycle_naive/2023-04-25_11-43-49_dgx_gpu3
[2023-04-25 11:44:19,644][src.utils.utils][INFO] - Closing loggers...
[2023-04-25 11:44:19,644][src.utils.utils][INFO] - Closing wandb!
[2023-04-25 11:50:49,555][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-25 11:50:49,564][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-25 11:50:49,676][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-25 11:50:49,682][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-25 11:50:50,372][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpqwsuws2r
[2023-04-25 11:50:50,373][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpqwsuws2r/_remote_module_non_sriptable.py
[2023-04-25 11:50:50,417][__main__][INFO] - Instantiating callbacks...
[2023-04-25 11:50:50,417][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-25 11:50:50,422][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-25 11:50:50,423][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-25 11:50:50,424][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-25 11:50:50,425][__main__][INFO] - Instantiating loggers...
[2023-04-25 11:50:50,425][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-25 11:51:08,314][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-25 11:51:08,377][__main__][INFO] - Logging hyperparameters!
[2023-04-25 11:51:08,391][__main__][INFO] - Starting training!
[2023-04-25 11:51:28,533][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1214, in _run_train
    self.fit_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 267, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 213, in advance
    batch_output = self.batch_loop.run(kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 88, in advance
    outputs = self.optimizer_loop.run(optimizers, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 202, in advance
    result = self._run_optimization(kwargs, self._optimizers[self.optim_progress.optimizer_position])
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 249, in _run_optimization
    self._optimizer_step(optimizer, opt_idx, kwargs.get("batch_idx", 0), closure)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 370, in _optimizer_step
    self.trainer._call_lightning_module_hook(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1356, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/core/module.py", line 1742, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/core/optimizer.py", line 169, in step
    step_output = self._strategy.optimizer_step(self._optimizer, self._optimizer_idx, closure, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 234, in optimizer_step
    return self.precision_plugin.optimizer_step(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/plugins/precision/native_amp.py", line 75, in optimizer_step
    closure_result = closure()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 149, in __call__
    self._result = self.closure(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 144, in closure
    self._backward_fn(step_output.closure_loss)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 305, in backward_fn
    self.trainer._call_strategy_hook("backward", loss, optimizer, opt_idx)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 207, in backward
    self.precision_plugin.backward(closure_loss, self.lightning_module, optimizer, optimizer_idx, *args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/plugins/precision/precision_plugin.py", line 67, in backward
    model.backward(tensor, optimizer, optimizer_idx, *args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/core/module.py", line 1486, in backward
    loss.backward(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/torch/_tensor.py", line 363, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/opt/conda/lib/python3.8/site-packages/torch/autograd/__init__.py", line 173, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
RuntimeError: CUDA out of memory. Tried to allocate 896.00 MiB (GPU 0; 15.78 GiB total capacity; 13.05 GiB already allocated; 845.75 MiB free; 13.71 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2023-04-25 11:51:28,538][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stc_cycle_naive/2023-04-25_11-50-49_dgx_gpu3
[2023-04-25 11:51:28,538][src.utils.utils][INFO] - Closing loggers...
[2023-04-25 11:51:28,539][src.utils.utils][INFO] - Closing wandb!
[2023-04-25 11:53:06,508][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-25 11:53:06,518][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-25 11:53:06,631][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-25 11:53:06,637][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-25 11:53:07,379][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpgivthnsp
[2023-04-25 11:53:07,379][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpgivthnsp/_remote_module_non_sriptable.py
[2023-04-25 11:53:07,426][__main__][INFO] - Instantiating callbacks...
[2023-04-25 11:53:07,427][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-25 11:53:07,435][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-25 11:53:07,436][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-25 11:53:07,438][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-25 11:53:07,439][__main__][INFO] - Instantiating loggers...
[2023-04-25 11:53:07,440][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-25 11:53:25,281][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-25 11:53:25,708][__main__][INFO] - Logging hyperparameters!
[2023-04-25 11:53:25,722][__main__][INFO] - Starting training!
[2023-04-25 11:53:52,783][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stc_cycle_naive/2023-04-25_11-53-06_dgx_gpu3
[2023-04-25 11:53:52,783][src.utils.utils][INFO] - Closing loggers...
[2023-04-25 11:53:52,784][src.utils.utils][INFO] - Closing wandb!
[2023-04-25 11:54:08,313][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-25 16:01:33,183][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv10_stc_slotaug/2023-04-25_07-15-28_dgx_gpu4
[2023-04-25 16:01:33,184][src.utils.utils][INFO] - Closing loggers...
[2023-04-25 16:01:33,184][src.utils.utils][INFO] - Closing wandb!
[2023-04-25 16:01:34,713][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv10_stc_slotaug/2023-04-25_07-18-36_dgx_gpu6
[2023-04-25 16:01:34,714][src.utils.utils][INFO] - Closing loggers...
[2023-04-25 16:01:34,714][src.utils.utils][INFO] - Closing wandb!
[2023-04-25 16:02:01,199][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-25 16:02:01,207][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-25 16:02:01,315][__main__][INFO] - Instantiating datamodule <src.data.clevr10_aug_datamodule.CLEVR10AugDataModule>
[2023-04-25 16:02:01,321][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-25 16:02:02,016][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmphgqidjy6
[2023-04-25 16:02:02,017][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmphgqidjy6/_remote_module_non_sriptable.py
[2023-04-25 16:02:02,055][__main__][INFO] - Instantiating callbacks...
[2023-04-25 16:02:02,056][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-25 16:02:02,060][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-25 16:02:02,061][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-25 16:02:02,062][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-25 16:02:02,063][__main__][INFO] - Instantiating loggers...
[2023-04-25 16:02:02,063][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-25 16:02:05,960][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv10_stc_slotaug/2023-04-25_16-02-01_dgx_gpu4
[2023-04-25 16:02:05,961][src.utils.utils][INFO] - Closing loggers...
[2023-04-25 16:07:44,222][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-25 16:07:44,231][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-25 16:07:44,339][__main__][INFO] - Instantiating datamodule <src.data.clevr10_aug_datamodule.CLEVR10AugDataModule>
[2023-04-25 16:07:44,348][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-25 16:07:44,990][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmphf6awyb3
[2023-04-25 16:07:44,991][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmphf6awyb3/_remote_module_non_sriptable.py
[2023-04-25 16:07:45,034][__main__][INFO] - Instantiating callbacks...
[2023-04-25 16:07:45,035][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-25 16:07:45,039][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-25 16:07:45,040][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-25 16:07:45,041][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-25 16:07:45,041][__main__][INFO] - Instantiating loggers...
[2023-04-25 16:07:45,042][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-25 16:08:02,765][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-25 16:08:02,823][__main__][INFO] - Logging hyperparameters!
[2023-04-25 16:08:02,835][__main__][INFO] - Starting training!
[2023-04-25 16:08:54,164][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-25 16:08:54,173][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-25 16:08:54,278][__main__][INFO] - Instantiating datamodule <src.data.clevr10_aug_datamodule.CLEVR10AugDataModule>
[2023-04-25 16:08:54,284][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-25 16:08:55,002][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpg2widn4p
[2023-04-25 16:08:55,003][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpg2widn4p/_remote_module_non_sriptable.py
[2023-04-25 16:08:55,041][__main__][INFO] - Instantiating callbacks...
[2023-04-25 16:08:55,041][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-25 16:08:55,046][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-25 16:08:55,047][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-25 16:08:55,048][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-25 16:08:55,049][__main__][INFO] - Instantiating loggers...
[2023-04-25 16:08:55,049][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-25 16:09:12,853][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-25 16:09:12,909][__main__][INFO] - Logging hyperparameters!
[2023-04-25 16:09:12,923][__main__][INFO] - Starting training!
[2023-04-25 16:24:20,096][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_flip_hv_indi_soft_v3_/2023-04-24_15-43-53_dgx_gpu5
[2023-04-25 16:24:20,097][src.utils.utils][INFO] - Closing loggers...
[2023-04-25 16:24:20,097][src.utils.utils][INFO] - Closing wandb!
[2023-04-25 16:24:39,297][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-25 16:24:39,307][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-25 16:24:39,423][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-25 16:24:39,432][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-25 16:24:39,599][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/utils.py", line 644, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.models' has no attribute 'slotaug_ae_module'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
  File "/opt/conda/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 13, in <module>
    from src.utils.vis_utils import visualize
  File "/workspace/slotaug/src/utils/vis_utils.py", line 5, in <module>
    import matplotlib.pyplot as plt
ModuleNotFoundError: No module named 'matplotlib'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/utils.py", line 653, in _locate
    raise ImportError(
ImportError: Error loading 'src.models.slotaug_ae_module.LitSlotAugAutoEncoder':
ModuleNotFoundError("No module named 'matplotlib'")
Are you sure that 'slotaug_ae_module' is importable from module 'src.models'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 56, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.models.slotaug_ae_module.LitSlotAugAutoEncoder', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: model
[2023-04-25 16:24:39,603][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_is_slotaug/2023-04-25_16-24-39_dgx_gpu5
[2023-04-25 16:24:39,603][src.utils.utils][INFO] - Closing loggers...
[2023-04-25 16:31:59,626][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-25 16:31:59,635][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-25 16:31:59,751][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-25 16:31:59,757][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-25 16:32:00,334][matplotlib.font_manager][INFO] - generated new fontManager
[2023-04-25 16:32:00,752][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpvki4d6i0
[2023-04-25 16:32:00,753][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpvki4d6i0/_remote_module_non_sriptable.py
[2023-04-25 16:32:00,790][__main__][INFO] - Instantiating callbacks...
[2023-04-25 16:32:00,791][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-25 16:32:00,796][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-25 16:32:00,797][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-25 16:32:00,798][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-25 16:32:00,799][__main__][INFO] - Instantiating loggers...
[2023-04-25 16:32:00,799][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-25 16:32:18,671][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-25 16:32:18,729][__main__][INFO] - Logging hyperparameters!
[2023-04-25 16:32:18,744][__main__][INFO] - Starting training!
[2023-04-26 09:37:36,134][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv10_stcf_is_slotaug/2023-04-25_16-07-44_dgx_gpu4
[2023-04-26 09:37:36,135][src.utils.utils][INFO] - Closing loggers...
[2023-04-26 09:37:36,135][src.utils.utils][INFO] - Closing wandb!
[2023-04-26 09:37:41,373][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-26 09:37:41,383][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-26 09:37:41,500][__main__][INFO] - Instantiating datamodule <src.data.clevr10_aug_datamodule.CLEVR10AugDataModule>
[2023-04-26 09:37:41,507][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-26 09:37:42,246][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp7e3ait8n
[2023-04-26 09:37:42,247][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp7e3ait8n/_remote_module_non_sriptable.py
[2023-04-26 09:37:42,286][__main__][INFO] - Instantiating callbacks...
[2023-04-26 09:37:42,287][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-26 09:37:42,292][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-26 09:37:42,292][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-26 09:37:42,293][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-26 09:37:42,294][__main__][INFO] - Instantiating loggers...
[2023-04-26 09:37:42,295][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-26 09:38:00,400][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-26 09:38:00,462][__main__][INFO] - Logging hyperparameters!
[2023-04-26 09:38:00,476][__main__][INFO] - Starting training!
[2023-04-26 16:48:45,242][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_scale_tran_color_hs_v3__ms2/2023-04-24_09-04-45_dgx_gpu7
[2023-04-26 16:48:45,243][src.utils.utils][INFO] - Closing loggers...
[2023-04-26 16:48:45,244][src.utils.utils][INFO] - Closing wandb!
[2023-04-26 16:49:22,809][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-26 16:49:22,819][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-26 16:49:22,908][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_is_slotaug_cycle/2023-04-26_16-49-22_dgx_gpu7
[2023-04-26 16:49:22,908][src.utils.utils][INFO] - Closing loggers...
[2023-04-26 16:51:43,933][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-26 16:51:43,941][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-26 16:51:44,057][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-26 16:51:44,066][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-26 16:51:44,725][matplotlib.font_manager][INFO] - generated new fontManager
[2023-04-26 16:51:45,135][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp2p5cd9ge
[2023-04-26 16:51:45,136][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp2p5cd9ge/_remote_module_non_sriptable.py
[2023-04-26 16:51:45,193][__main__][INFO] - Instantiating callbacks...
[2023-04-26 16:51:45,193][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-26 16:51:45,198][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-26 16:51:45,199][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-26 16:51:45,200][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-26 16:51:45,201][__main__][INFO] - Instantiating loggers...
[2023-04-26 16:51:45,202][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-26 16:52:03,059][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-26 16:52:03,114][__main__][INFO] - Logging hyperparameters!
[2023-04-26 16:52:03,127][__main__][INFO] - Starting training!
[2023-04-26 16:52:23,883][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1214, in _run_train
    self.fit_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 267, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 213, in advance
    batch_output = self.batch_loop.run(kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 88, in advance
    outputs = self.optimizer_loop.run(optimizers, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 202, in advance
    result = self._run_optimization(kwargs, self._optimizers[self.optim_progress.optimizer_position])
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 249, in _run_optimization
    self._optimizer_step(optimizer, opt_idx, kwargs.get("batch_idx", 0), closure)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 370, in _optimizer_step
    self.trainer._call_lightning_module_hook(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1356, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/core/module.py", line 1742, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/core/optimizer.py", line 169, in step
    step_output = self._strategy.optimizer_step(self._optimizer, self._optimizer_idx, closure, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 234, in optimizer_step
    return self.precision_plugin.optimizer_step(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/plugins/precision/native_amp.py", line 75, in optimizer_step
    closure_result = closure()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 149, in __call__
    self._result = self.closure(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 144, in closure
    self._backward_fn(step_output.closure_loss)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 305, in backward_fn
    self.trainer._call_strategy_hook("backward", loss, optimizer, opt_idx)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 207, in backward
    self.precision_plugin.backward(closure_loss, self.lightning_module, optimizer, optimizer_idx, *args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/plugins/precision/precision_plugin.py", line 67, in backward
    model.backward(tensor, optimizer, optimizer_idx, *args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/core/module.py", line 1486, in backward
    loss.backward(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/torch/_tensor.py", line 363, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/opt/conda/lib/python3.8/site-packages/torch/autograd/__init__.py", line 173, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
RuntimeError: CUDA out of memory. Tried to allocate 896.00 MiB (GPU 0; 15.78 GiB total capacity; 13.06 GiB already allocated; 843.75 MiB free; 13.71 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2023-04-26 16:52:23,892][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_is_slotaug_cycle/2023-04-26_16-51-43_dgx_gpu7
[2023-04-26 16:52:23,893][src.utils.utils][INFO] - Closing loggers...
[2023-04-26 16:52:23,893][src.utils.utils][INFO] - Closing wandb!
[2023-04-26 17:19:22,152][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-26 17:19:22,161][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-26 17:19:22,275][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-26 17:19:22,284][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-26 17:19:22,992][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp09js68_t
[2023-04-26 17:19:22,993][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp09js68_t/_remote_module_non_sriptable.py
[2023-04-26 17:19:23,030][__main__][INFO] - Instantiating callbacks...
[2023-04-26 17:19:23,031][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-26 17:19:23,035][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-26 17:19:23,036][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-26 17:19:23,037][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-26 17:19:23,038][__main__][INFO] - Instantiating loggers...
[2023-04-26 17:19:23,039][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-26 17:19:41,057][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-26 17:19:41,123][__main__][INFO] - Logging hyperparameters!
[2023-04-26 17:19:41,137][__main__][INFO] - Starting training!
[2023-04-26 17:19:48,392][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 121, in advance
    batch = next(data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 184, in __next__
    return self.fetching_function()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 265, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 280, in _fetch_next_batch
    batch = next(iterator)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 530, in __next__
    data = self._next_data()
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1224, in _next_data
    return self._process_data(data)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1250, in _process_data
    data.reraise()
  File "/opt/conda/lib/python3.8/site-packages/torch/_utils.py", line 457, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 287, in _worker_loop
    data = fetcher.fetch(index)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/workspace/slotaug/src/data/components/clevr6_aug.py", line 209, in __getitem__
    img_aug = transform_aug(img) # (3, H, W)
  File "/opt/conda/lib/python3.8/site-packages/torchvision/transforms/transforms.py", line 95, in __call__
    img = t(img)
  File "/opt/conda/lib/python3.8/site-packages/torchvision/transforms/transforms.py", line 474, in __call__
    return self.lambd(img)
  File "/workspace/slotaug/src/data/components/clevr6_aug.py", line 142, in <lambda>
    transforms.Lambda(lambda img: transforms.functional.rotate(img=img, angle=theta.item()*360, interpolation=2)),
AttributeError: 'float' object has no attribute 'item'

[2023-04-26 17:19:48,400][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcfr_is_slotaug/2023-04-26_17-19-21_dgx_gpu7
[2023-04-26 17:19:48,400][src.utils.utils][INFO] - Closing loggers...
[2023-04-26 17:19:48,400][src.utils.utils][INFO] - Closing wandb!
[2023-04-26 17:22:28,321][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-26 17:22:28,331][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-26 17:22:28,451][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-26 17:22:28,460][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-26 17:22:29,168][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpo0azomj6
[2023-04-26 17:22:29,169][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpo0azomj6/_remote_module_non_sriptable.py
[2023-04-26 17:22:29,207][__main__][INFO] - Instantiating callbacks...
[2023-04-26 17:22:29,207][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-26 17:22:29,212][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-26 17:22:29,213][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-26 17:22:29,214][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-26 17:22:29,215][__main__][INFO] - Instantiating loggers...
[2023-04-26 17:22:29,215][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-26 17:22:47,073][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-26 17:22:47,138][__main__][INFO] - Logging hyperparameters!
[2023-04-26 17:22:47,152][__main__][INFO] - Starting training!
[2023-04-27 06:01:16,063][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_is_slotaug/2023-04-25_16-31-59_dgx_gpu5
[2023-04-27 06:01:16,063][src.utils.utils][INFO] - Closing loggers...
[2023-04-27 06:01:16,064][src.utils.utils][INFO] - Closing wandb!
[2023-04-27 06:01:33,459][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-27 12:04:57,080][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-27 12:04:57,090][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-27 12:04:57,200][__main__][INFO] - Instantiating datamodule <src.data.clevrtex_aug_datamodule.ClevrTex6AugDataModule>
[2023-04-27 12:04:57,210][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
  File "/opt/conda/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 970, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'src.data.clevrtex_aug_datamodule.ClevrTex6AugDataModule'; 'src.data.clevrtex_aug_datamodule' is not a package

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/utils.py", line 653, in _locate
    raise ImportError(
ImportError: Error loading 'src.data.clevrtex_aug_datamodule.ClevrTex6AugDataModule':
ModuleNotFoundError("No module named 'src.data.clevrtex_aug_datamodule.ClevrTex6AugDataModule'; 'src.data.clevrtex_aug_datamodule' is not a package")
Are you sure that 'ClevrTex6AugDataModule' is importable from module 'src.data.clevrtex_aug_datamodule'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 53, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.data)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.data.clevrtex_aug_datamodule.ClevrTex6AugDataModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: data
[2023-04-27 12:04:57,212][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clvt6_stcf_is_slotaug/2023-04-27_12-04-56_dgx_gpu5
[2023-04-27 12:04:57,213][src.utils.utils][INFO] - Closing loggers...
[2023-04-27 12:05:30,774][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-27 12:05:30,783][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-27 12:05:30,891][__main__][INFO] - Instantiating datamodule <src.data.clevrtex_aug_datamodule.ClevrTex6AugDataModule>
[2023-04-27 12:05:30,896][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
  File "/opt/conda/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 970, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'src.data.clevrtex_aug_datamodule.ClevrTex6AugDataModule'; 'src.data.clevrtex_aug_datamodule' is not a package

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/utils.py", line 653, in _locate
    raise ImportError(
ImportError: Error loading 'src.data.clevrtex_aug_datamodule.ClevrTex6AugDataModule':
ModuleNotFoundError("No module named 'src.data.clevrtex_aug_datamodule.ClevrTex6AugDataModule'; 'src.data.clevrtex_aug_datamodule' is not a package")
Are you sure that 'ClevrTex6AugDataModule' is importable from module 'src.data.clevrtex_aug_datamodule'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 53, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.data)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.data.clevrtex_aug_datamodule.ClevrTex6AugDataModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: data
[2023-04-27 12:05:30,898][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clvt6_stcf_is_slotaug/2023-04-27_12-05-30_dgx_gpu5
[2023-04-27 12:05:30,898][src.utils.utils][INFO] - Closing loggers...
[2023-04-27 12:06:11,028][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-27 12:06:11,037][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-27 12:06:11,149][__main__][INFO] - Instantiating datamodule <src.data.clevrtex_aug_datamodule.ClevrTex6AugDataModule>
[2023-04-27 12:06:11,154][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
  File "/opt/conda/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 970, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'src.data.clevrtex_aug_datamodule.ClevrTex6AugDataModule'; 'src.data.clevrtex_aug_datamodule' is not a package

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/utils.py", line 653, in _locate
    raise ImportError(
ImportError: Error loading 'src.data.clevrtex_aug_datamodule.ClevrTex6AugDataModule':
ModuleNotFoundError("No module named 'src.data.clevrtex_aug_datamodule.ClevrTex6AugDataModule'; 'src.data.clevrtex_aug_datamodule' is not a package")
Are you sure that 'ClevrTex6AugDataModule' is importable from module 'src.data.clevrtex_aug_datamodule'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 53, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.data)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.data.clevrtex_aug_datamodule.ClevrTex6AugDataModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: data
[2023-04-27 12:06:11,156][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clvt6_stcf_is_slotaug/2023-04-27_12-06-10_dgx_gpu5
[2023-04-27 12:06:11,156][src.utils.utils][INFO] - Closing loggers...
[2023-04-27 12:07:34,813][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-27 12:07:34,822][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-27 12:07:34,931][__main__][INFO] - Instantiating datamodule <src.data.clevrtex6_aug_datamodule.ClevrTex6AugDataModule>
[2023-04-27 12:07:34,940][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-27 12:07:35,699][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpbkc4i1j5
[2023-04-27 12:07:35,700][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpbkc4i1j5/_remote_module_non_sriptable.py
[2023-04-27 12:07:35,743][__main__][INFO] - Instantiating callbacks...
[2023-04-27 12:07:35,744][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-27 12:07:35,749][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-27 12:07:35,750][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-27 12:07:35,751][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-27 12:07:35,752][__main__][INFO] - Instantiating loggers...
[2023-04-27 12:07:35,752][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-27 12:07:53,606][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-27 12:07:53,667][__main__][INFO] - Logging hyperparameters!
[2023-04-27 12:07:53,682][__main__][INFO] - Starting training!
[2023-04-27 12:07:57,607][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 121, in advance
    batch = next(data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 184, in __next__
    return self.fetching_function()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 265, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 280, in _fetch_next_batch
    batch = next(iterator)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 530, in __next__
    data = self._next_data()
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1224, in _next_data
    return self._process_data(data)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1250, in _process_data
    data.reraise()
  File "/opt/conda/lib/python3.8/site-packages/torch/_utils.py", line 457, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 287, in _worker_loop
    data = fetcher.fetch(index)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/workspace/slotaug/src/data/components/clevrtex6_aug.py", line 208, in __getitem__
    masks = F.one_hot(masks, self.max_num_masks).permute(2, 0, 1)
RuntimeError: Class values must be smaller than num_classes.

[2023-04-27 12:07:57,616][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clvt6_stcf_is_slotaug/2023-04-27_12-07-34_dgx_gpu5
[2023-04-27 12:07:57,617][src.utils.utils][INFO] - Closing loggers...
[2023-04-27 12:07:57,617][src.utils.utils][INFO] - Closing wandb!
[2023-04-27 12:34:30,321][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-27 12:34:30,331][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-27 12:34:30,455][__main__][INFO] - Instantiating datamodule <src.data.clevrtex6_aug_datamodule.ClevrTex6AugDataModule>
[2023-04-27 12:34:30,464][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-27 12:34:31,199][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpeobzoqm_
[2023-04-27 12:34:31,200][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpeobzoqm_/_remote_module_non_sriptable.py
[2023-04-27 12:34:31,243][__main__][INFO] - Instantiating callbacks...
[2023-04-27 12:34:31,243][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-27 12:34:31,248][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-27 12:34:31,249][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-27 12:34:31,250][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-27 12:34:31,251][__main__][INFO] - Instantiating loggers...
[2023-04-27 12:34:31,252][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-27 12:34:49,082][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-27 12:34:49,140][__main__][INFO] - Logging hyperparameters!
[2023-04-27 12:34:49,153][__main__][INFO] - Starting training!
[2023-04-28 08:09:45,996][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcfr_is_slotaug/2023-04-26_17-22-28_dgx_gpu7
[2023-04-28 08:09:45,997][src.utils.utils][INFO] - Closing loggers...
[2023-04-28 08:09:45,997][src.utils.utils][INFO] - Closing wandb!
[2023-04-28 08:10:02,048][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-28 09:35:11,933][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clvt6_stcf_is_slotaug/2023-04-27_12-34-30_dgx_gpu5
[2023-04-28 09:35:11,933][src.utils.utils][INFO] - Closing loggers...
[2023-04-28 09:35:11,934][src.utils.utils][INFO] - Closing wandb!
[2023-04-28 09:35:33,131][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-28 10:14:16,811][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-28 10:14:16,819][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-28 10:14:16,923][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-28 10:14:16,932][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-28 10:14:17,013][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_test_slotaug_test/2023-04-28_10-14-16_dgx_gpu7
[2023-04-28 10:14:17,014][src.utils.utils][INFO] - Closing loggers...
[2023-04-28 10:14:25,549][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-28 10:14:25,557][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-28 10:14:25,665][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-28 10:14:25,670][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-28 10:14:26,299][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp1p2m_mh9
[2023-04-28 10:14:26,300][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp1p2m_mh9/_remote_module_non_sriptable.py
[2023-04-28 10:14:26,341][__main__][INFO] - Instantiating callbacks...
[2023-04-28 10:14:26,342][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-28 10:14:26,346][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-28 10:14:26,347][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-28 10:14:26,348][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-28 10:14:26,349][__main__][INFO] - Instantiating loggers...
[2023-04-28 10:14:26,349][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-28 10:14:44,058][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-28 10:14:44,112][__main__][INFO] - Logging hyperparameters!
[2023-04-28 10:14:44,124][__main__][INFO] - Starting training!
[2023-04-28 10:14:54,753][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 156, in validation_step
    loss, outputs = self._shared_eval_step(batch, batch_idx)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 134, in _shared_eval_step
    loss_ori, loss_aug, outputs = self.model_step(batch)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 98, in model_step
    outputs = self.forward(img_ori, img_aug, insts_ori2aug, insts_aug2ori)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 89, in forward
    outputs = self.net(img_ori, img_aug, insts_ori2aug, insts_aug2ori)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
TypeError: forward() takes 4 positional arguments but 5 were given
[2023-04-28 10:14:54,758][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_test_slotaug_test/2023-04-28_10-14-25_dgx_gpu7
[2023-04-28 10:14:54,759][src.utils.utils][INFO] - Closing loggers...
[2023-04-28 10:14:54,759][src.utils.utils][INFO] - Closing wandb!
[2023-04-28 10:17:02,995][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-28 10:17:03,005][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-28 10:17:03,122][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-28 10:17:03,129][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-28 10:17:03,848][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp6opxi1gb
[2023-04-28 10:17:03,848][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp6opxi1gb/_remote_module_non_sriptable.py
[2023-04-28 10:17:03,890][__main__][INFO] - Instantiating callbacks...
[2023-04-28 10:17:03,891][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-28 10:17:03,895][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-28 10:17:03,896][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-28 10:17:03,897][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-28 10:17:03,898][__main__][INFO] - Instantiating loggers...
[2023-04-28 10:17:03,898][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-28 10:17:21,601][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-28 10:17:21,657][__main__][INFO] - Logging hyperparameters!
[2023-04-28 10:17:21,668][__main__][INFO] - Starting training!
[2023-04-28 10:17:32,191][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 156, in validation_step
    loss, outputs = self._shared_eval_step(batch, batch_idx)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 134, in _shared_eval_step
    loss_ori, loss_aug, outputs = self.model_step(batch)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 98, in model_step
    outputs = self.forward(img_ori, img_aug, insts_ori2aug, insts_aug2ori)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 89, in forward
    outputs = self.net(img_ori, img_aug, insts_ori2aug, insts_aug2ori)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
TypeError: forward() takes 4 positional arguments but 5 were given
[2023-04-28 10:17:32,196][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_test_slotaug_test/2023-04-28_10-17-02_dgx_gpu7
[2023-04-28 10:17:32,196][src.utils.utils][INFO] - Closing loggers...
[2023-04-28 10:17:32,196][src.utils.utils][INFO] - Closing wandb!
[2023-04-28 10:19:27,730][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-28 10:19:27,738][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-28 10:19:27,844][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-28 10:19:27,850][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-28 10:19:28,526][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp6jrwqhr_
[2023-04-28 10:19:28,526][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp6jrwqhr_/_remote_module_non_sriptable.py
[2023-04-28 10:19:28,567][__main__][INFO] - Instantiating callbacks...
[2023-04-28 10:19:28,568][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-28 10:19:28,572][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-28 10:19:28,573][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-28 10:19:28,574][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-28 10:19:28,575][__main__][INFO] - Instantiating loggers...
[2023-04-28 10:19:28,575][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-28 10:19:46,317][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-28 10:19:46,380][__main__][INFO] - Logging hyperparameters!
[2023-04-28 10:19:46,393][__main__][INFO] - Starting training!
[2023-04-28 10:26:12,040][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_test_slotaug_test/2023-04-28_10-19-27_dgx_gpu7
[2023-04-28 10:26:12,041][src.utils.utils][INFO] - Closing loggers...
[2023-04-28 10:26:12,041][src.utils.utils][INFO] - Closing wandb!
[2023-04-28 10:26:35,024][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-28 17:26:45,174][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-28 17:26:45,183][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-28 17:26:45,288][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-28 17:26:45,296][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-28 17:26:45,971][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp2y0u8_c6
[2023-04-28 17:26:45,971][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp2y0u8_c6/_remote_module_non_sriptable.py
[2023-04-28 17:26:46,023][__main__][INFO] - Instantiating callbacks...
[2023-04-28 17:26:46,024][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-28 17:26:46,028][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-28 17:26:46,028][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-28 17:26:46,029][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-28 17:26:46,030][__main__][INFO] - Instantiating loggers...
[2023-04-28 17:26:46,031][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-28 17:27:03,817][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-28 17:27:03,868][__main__][INFO] - Logging hyperparameters!
[2023-04-28 17:27:03,880][__main__][INFO] - Starting training!
[2023-04-28 17:27:55,892][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-28 17:27:55,900][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-28 17:27:56,015][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-28 17:27:56,022][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-28 17:27:56,682][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp9irp_f4n
[2023-04-28 17:27:56,683][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp9irp_f4n/_remote_module_non_sriptable.py
[2023-04-28 17:27:56,721][__main__][INFO] - Instantiating callbacks...
[2023-04-28 17:27:56,722][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-28 17:27:56,726][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-28 17:27:56,727][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-28 17:27:56,729][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-28 17:27:56,730][__main__][INFO] - Instantiating loggers...
[2023-04-28 17:27:56,730][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-28 17:28:14,646][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-28 17:28:14,721][__main__][INFO] - Logging hyperparameters!
[2023-04-28 17:28:14,740][__main__][INFO] - Starting training!
[2023-04-28 17:37:52,497][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stc_nis_naive/2023-04-28_17-27-55_dgx_gpu7
[2023-04-28 17:37:52,499][src.utils.utils][INFO] - Closing loggers...
[2023-04-28 17:37:52,499][src.utils.utils][INFO] - Closing wandb!
[2023-04-28 17:38:13,640][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-28 17:40:10,194][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-28 17:40:10,203][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-28 17:40:10,313][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-28 17:40:10,318][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-28 17:40:11,071][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpov_ttw0x
[2023-04-28 17:40:11,072][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpov_ttw0x/_remote_module_non_sriptable.py
[2023-04-28 17:40:11,119][__main__][INFO] - Instantiating callbacks...
[2023-04-28 17:40:11,120][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-28 17:40:11,124][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-28 17:40:11,125][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-28 17:40:11,127][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-28 17:40:11,128][__main__][INFO] - Instantiating loggers...
[2023-04-28 17:40:11,128][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-28 17:40:29,032][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-28 17:40:29,087][__main__][INFO] - Logging hyperparameters!
[2023-04-28 17:40:29,100][__main__][INFO] - Starting training!
[2023-04-29 06:02:33,063][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-29 06:02:33,072][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-29 06:02:33,187][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-29 06:02:33,194][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-29 06:02:33,967][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpjbbdkovu
[2023-04-29 06:02:33,968][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpjbbdkovu/_remote_module_non_sriptable.py
[2023-04-29 06:02:34,030][__main__][INFO] - Instantiating callbacks...
[2023-04-29 06:02:34,030][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-29 06:02:34,035][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-29 06:02:34,036][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-29 06:02:34,037][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-29 06:02:34,037][__main__][INFO] - Instantiating loggers...
[2023-04-29 06:02:34,038][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-29 06:02:51,887][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-29 06:02:51,944][__main__][INFO] - Logging hyperparameters!
[2023-04-29 06:02:51,957][__main__][INFO] - Starting training!
[2023-04-29 06:03:47,245][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_slotaug_test/2023-04-29_06-02-32_dgx_gpu3
[2023-04-29 06:03:47,246][src.utils.utils][INFO] - Closing loggers...
[2023-04-29 06:03:47,246][src.utils.utils][INFO] - Closing wandb!
[2023-04-29 06:04:09,741][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-29 06:04:25,552][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-29 06:04:25,561][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-29 06:04:25,675][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-29 06:04:25,681][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-29 06:04:26,412][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpqy87cj4c
[2023-04-29 06:04:26,413][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpqy87cj4c/_remote_module_non_sriptable.py
[2023-04-29 06:04:26,453][__main__][INFO] - Instantiating callbacks...
[2023-04-29 06:04:26,454][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-29 06:04:26,459][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-29 06:04:26,460][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-29 06:04:26,461][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-29 06:04:26,462][__main__][INFO] - Instantiating loggers...
[2023-04-29 06:04:26,462][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-29 06:04:44,188][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-29 06:04:44,260][__main__][INFO] - Logging hyperparameters!
[2023-04-29 06:04:44,274][__main__][INFO] - Starting training!
[2023-04-29 06:07:02,414][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_slotaug_test/2023-04-29_06-04-25_dgx_gpu3
[2023-04-29 06:07:02,416][src.utils.utils][INFO] - Closing loggers...
[2023-04-29 06:07:02,416][src.utils.utils][INFO] - Closing wandb!
[2023-04-29 06:07:19,118][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-29 06:07:31,292][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-29 06:07:31,301][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-29 06:07:31,424][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-29 06:07:31,431][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-29 06:07:32,200][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmphil2vgfe
[2023-04-29 06:07:32,201][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmphil2vgfe/_remote_module_non_sriptable.py
[2023-04-29 06:07:32,244][__main__][INFO] - Instantiating callbacks...
[2023-04-29 06:07:32,245][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-29 06:07:32,249][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-29 06:07:32,250][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-29 06:07:32,251][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-29 06:07:32,252][__main__][INFO] - Instantiating loggers...
[2023-04-29 06:07:32,252][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-29 06:07:50,096][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-29 06:07:50,155][__main__][INFO] - Logging hyperparameters!
[2023-04-29 06:07:50,168][__main__][INFO] - Starting training!
[2023-04-29 06:08:57,978][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_slotaug_test/2023-04-29_06-07-31_dgx_gpu3
[2023-04-29 06:08:57,979][src.utils.utils][INFO] - Closing loggers...
[2023-04-29 06:08:57,979][src.utils.utils][INFO] - Closing wandb!
[2023-04-29 06:09:08,417][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-29 06:09:25,290][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-29 06:09:25,300][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-29 06:09:25,423][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-29 06:09:25,430][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-29 06:09:26,183][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp7fvx8e5m
[2023-04-29 06:09:26,184][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp7fvx8e5m/_remote_module_non_sriptable.py
[2023-04-29 06:09:26,222][__main__][INFO] - Instantiating callbacks...
[2023-04-29 06:09:26,222][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-29 06:09:26,227][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-29 06:09:26,228][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-29 06:09:26,229][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-29 06:09:26,230][__main__][INFO] - Instantiating loggers...
[2023-04-29 06:09:26,230][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-29 06:09:44,078][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-29 06:09:44,137][__main__][INFO] - Logging hyperparameters!
[2023-04-29 06:09:44,150][__main__][INFO] - Starting training!
[2023-04-29 06:11:35,726][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_slotaug_test/2023-04-29_06-09-25_dgx_gpu3
[2023-04-29 06:11:35,728][src.utils.utils][INFO] - Closing loggers...
[2023-04-29 06:11:35,728][src.utils.utils][INFO] - Closing wandb!
[2023-04-29 06:11:46,680][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-29 06:13:59,827][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-29 06:13:59,837][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-29 06:13:59,952][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-29 06:13:59,957][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-29 06:14:00,710][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpwhju8q99
[2023-04-29 06:14:00,711][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpwhju8q99/_remote_module_non_sriptable.py
[2023-04-29 06:14:00,772][__main__][INFO] - Instantiating callbacks...
[2023-04-29 06:14:00,773][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-29 06:14:00,779][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-29 06:14:00,781][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-29 06:14:00,782][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-29 06:14:00,783][__main__][INFO] - Instantiating loggers...
[2023-04-29 06:14:00,784][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-29 06:14:18,607][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-29 06:14:18,690][__main__][INFO] - Logging hyperparameters!
[2023-04-29 06:14:18,704][__main__][INFO] - Starting training!
[2023-04-29 06:14:48,379][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_slotaug_test/2023-04-29_06-13-59_dgx_gpu3
[2023-04-29 06:14:48,380][src.utils.utils][INFO] - Closing loggers...
[2023-04-29 06:14:48,381][src.utils.utils][INFO] - Closing wandb!
[2023-04-29 06:15:03,283][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-29 06:15:10,958][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-29 06:15:10,967][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-29 06:15:11,082][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-29 06:15:11,088][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-29 06:15:11,823][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmps_bcyy_6
[2023-04-29 06:15:11,824][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmps_bcyy_6/_remote_module_non_sriptable.py
[2023-04-29 06:15:11,864][__main__][INFO] - Instantiating callbacks...
[2023-04-29 06:15:11,864][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-29 06:15:11,869][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-29 06:15:11,871][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-29 06:15:11,872][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-29 06:15:11,873][__main__][INFO] - Instantiating loggers...
[2023-04-29 06:15:11,873][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-29 06:15:29,711][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-29 06:15:29,774][__main__][INFO] - Logging hyperparameters!
[2023-04-29 06:15:29,787][__main__][INFO] - Starting training!
[2023-04-29 06:16:29,453][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1011, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/opt/conda/lib/python3.8/multiprocessing/queues.py", line 108, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1214, in _run_train
    self.fit_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 267, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.on_advance_end()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 250, in on_advance_end
    self._run_validation()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 308, in _run_validation
    self.val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 121, in advance
    batch = next(data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 184, in __next__
    return self.fetching_function()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 265, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 280, in _fetch_next_batch
    batch = next(iterator)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 530, in __next__
    data = self._next_data()
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1207, in _next_data
    idx, data = self._get_data()
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1173, in _get_data
    success, data = self._try_get_data()
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1024, in _try_get_data
    raise RuntimeError('DataLoader worker (pid(s) {}) exited unexpectedly'.format(pids_str)) from e
RuntimeError: DataLoader worker (pid(s) 70294, 70374) exited unexpectedly
[2023-04-29 06:16:29,461][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_slotaug_test/2023-04-29_06-15-10_dgx_gpu3
[2023-04-29 06:16:29,461][src.utils.utils][INFO] - Closing loggers...
[2023-04-29 06:16:29,462][src.utils.utils][INFO] - Closing wandb!
[2023-04-29 14:25:49,488][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_nis_naive/2023-04-28_17-26-45_dgx_gpu5
[2023-04-29 14:25:49,488][src.utils.utils][INFO] - Closing loggers...
[2023-04-29 14:25:49,489][src.utils.utils][INFO] - Closing wandb!
[2023-04-29 14:26:21,315][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-29 14:26:58,751][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-29 14:26:58,760][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-29 14:26:58,863][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-29 14:26:58,872][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-29 14:26:59,580][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpyf24rflv
[2023-04-29 14:26:59,581][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpyf24rflv/_remote_module_non_sriptable.py
[2023-04-29 14:26:59,644][__main__][INFO] - Instantiating callbacks...
[2023-04-29 14:26:59,644][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-29 14:26:59,648][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-29 14:26:59,649][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-29 14:26:59,650][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-29 14:26:59,651][__main__][INFO] - Instantiating loggers...
[2023-04-29 14:26:59,652][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-29 14:27:17,414][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-29 14:27:17,470][__main__][INFO] - Logging hyperparameters!
[2023-04-29 14:27:17,492][__main__][INFO] - Starting training!
[2023-04-29 14:27:28,307][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 421, in validation_step
    recons=outputs["recons_ori_revisited"][vis_idx].unsqueeze(0),
KeyError: 'recons_ori_revisited'
[2023-04-29 14:27:28,312][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_cycle_slot_v2/2023-04-29_14-26-58_dgx_gpu5
[2023-04-29 14:27:28,312][src.utils.utils][INFO] - Closing loggers...
[2023-04-29 14:27:28,312][src.utils.utils][INFO] - Closing wandb!
[2023-04-29 14:28:48,983][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-29 14:28:48,992][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-29 14:28:49,119][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-29 14:28:49,125][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-29 14:28:49,832][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpq_8rc7o3
[2023-04-29 14:28:49,833][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpq_8rc7o3/_remote_module_non_sriptable.py
[2023-04-29 14:28:49,888][__main__][INFO] - Instantiating callbacks...
[2023-04-29 14:28:49,888][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-29 14:28:49,893][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-29 14:28:49,894][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-29 14:28:49,895][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-29 14:28:49,896][__main__][INFO] - Instantiating loggers...
[2023-04-29 14:28:49,896][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-29 14:29:07,655][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-29 14:29:07,709][__main__][INFO] - Logging hyperparameters!
[2023-04-29 14:29:07,722][__main__][INFO] - Starting training!
[2023-04-29 14:29:27,718][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1214, in _run_train
    self.fit_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 267, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 213, in advance
    batch_output = self.batch_loop.run(kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 88, in advance
    outputs = self.optimizer_loop.run(optimizers, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 202, in advance
    result = self._run_optimization(kwargs, self._optimizers[self.optim_progress.optimizer_position])
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 249, in _run_optimization
    self._optimizer_step(optimizer, opt_idx, kwargs.get("batch_idx", 0), closure)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 370, in _optimizer_step
    self.trainer._call_lightning_module_hook(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1356, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/core/module.py", line 1742, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/core/optimizer.py", line 169, in step
    step_output = self._strategy.optimizer_step(self._optimizer, self._optimizer_idx, closure, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 234, in optimizer_step
    return self.precision_plugin.optimizer_step(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/plugins/precision/native_amp.py", line 75, in optimizer_step
    closure_result = closure()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 149, in __call__
    self._result = self.closure(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 135, in closure
    step_output = self._step_fn()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 419, in _training_step
    training_step_output = self.trainer._call_strategy_hook("training_step", *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in training_step
    return self.model.training_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 197, in training_step
    outputs = self.model_step(batch)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 148, in model_step
    outputs = self.forward(img_ori, img_aug, insts_ori2aug, insts_aug2ori)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 139, in forward
    outputs = self.net(img_ori, img_aug, insts_ori2aug, insts_aug2ori)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug/slotaug_ae.py", line 121, in forward
    x_aug2ori = self.decoder_cnn(slots_aug2ori)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slota/slota_utils.py", line 128, in forward
    x = self.deconvs(x)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/container.py", line 141, in forward
    input = module(input)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 925, in forward
    return F.conv_transpose2d(
RuntimeError: CUDA out of memory. Tried to allocate 896.00 MiB (GPU 0; 15.78 GiB total capacity; 12.55 GiB already allocated; 889.75 MiB free; 13.67 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2023-04-29 14:29:27,727][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_cycle_slot_v2/2023-04-29_14-28-48_dgx_gpu5
[2023-04-29 14:29:27,728][src.utils.utils][INFO] - Closing loggers...
[2023-04-29 14:29:27,728][src.utils.utils][INFO] - Closing wandb!
[2023-04-29 14:31:47,823][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-29 14:31:47,831][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-29 14:31:47,933][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-29 14:31:47,943][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-29 14:31:48,201][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpavkyy7t9
[2023-04-29 14:31:48,201][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpavkyy7t9/_remote_module_non_sriptable.py
[2023-04-29 14:31:48,250][__main__][INFO] - Instantiating callbacks...
[2023-04-29 14:31:48,250][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-29 14:31:48,255][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-29 14:31:48,256][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-29 14:31:48,257][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-29 14:31:48,258][__main__][INFO] - Instantiating loggers...
[2023-04-29 14:31:48,258][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-29 14:32:06,004][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-29 14:32:06,060][__main__][INFO] - Logging hyperparameters!
[2023-04-29 14:32:06,072][__main__][INFO] - Starting training!
[2023-04-29 14:32:35,909][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_no_bias/2023-04-28_17-40-10_dgx_gpu7
[2023-04-29 14:32:35,910][src.utils.utils][INFO] - Closing loggers...
[2023-04-29 14:32:35,910][src.utils.utils][INFO] - Closing wandb!
[2023-04-29 14:33:07,867][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-29 14:33:42,785][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-29 14:33:42,793][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-29 14:33:42,902][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-29 14:33:42,908][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-29 14:33:43,096][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpkz907r5m
[2023-04-29 14:33:43,096][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpkz907r5m/_remote_module_non_sriptable.py
[2023-04-29 14:33:43,151][__main__][INFO] - Instantiating callbacks...
[2023-04-29 14:33:43,152][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-29 14:33:43,156][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-29 14:33:43,157][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-29 14:33:43,159][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-29 14:33:43,160][__main__][INFO] - Instantiating loggers...
[2023-04-29 14:33:43,160][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-29 14:34:01,018][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-29 14:34:01,078][__main__][INFO] - Logging hyperparameters!
[2023-04-29 14:34:01,092][__main__][INFO] - Starting training!
[2023-04-30 02:39:44,076][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv10_stc_is_slotaug/2023-04-25_16-08-54_dgx_gpu6
[2023-04-30 02:39:44,077][src.utils.utils][INFO] - Closing loggers...
[2023-04-30 02:39:44,077][src.utils.utils][INFO] - Closing wandb!
[2023-04-30 02:39:55,320][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-30 02:51:03,549][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-30 02:51:03,558][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-30 02:51:03,677][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-30 02:51:03,689][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-30 02:51:04,487][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp553c22fj
[2023-04-30 02:51:04,487][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp553c22fj/_remote_module_non_sriptable.py
[2023-04-30 02:51:04,554][__main__][INFO] - Instantiating callbacks...
[2023-04-30 02:51:04,554][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-30 02:51:04,559][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-30 02:51:04,560][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-30 02:51:04,562][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-30 02:51:04,563][__main__][INFO] - Instantiating loggers...
[2023-04-30 02:51:04,563][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-30 02:51:22,352][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-30 02:51:22,408][__main__][INFO] - Logging hyperparameters!
[2023-04-30 02:51:22,423][__main__][INFO] - Starting training!
[2023-04-30 02:51:42,964][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1214, in _run_train
    self.fit_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 267, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 213, in advance
    batch_output = self.batch_loop.run(kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 88, in advance
    outputs = self.optimizer_loop.run(optimizers, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 202, in advance
    result = self._run_optimization(kwargs, self._optimizers[self.optim_progress.optimizer_position])
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 249, in _run_optimization
    self._optimizer_step(optimizer, opt_idx, kwargs.get("batch_idx", 0), closure)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 370, in _optimizer_step
    self.trainer._call_lightning_module_hook(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1356, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/core/module.py", line 1742, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/core/optimizer.py", line 169, in step
    step_output = self._strategy.optimizer_step(self._optimizer, self._optimizer_idx, closure, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 234, in optimizer_step
    return self.precision_plugin.optimizer_step(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/plugins/precision/native_amp.py", line 75, in optimizer_step
    closure_result = closure()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 149, in __call__
    self._result = self.closure(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 135, in closure
    step_output = self._step_fn()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 419, in _training_step
    training_step_output = self.trainer._call_strategy_hook("training_step", *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in training_step
    return self.model.training_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 149, in training_step
    model_step_outputs = self.model_step(batch)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 124, in model_step
    outputs = self.forward(img_ori, img_aug, insts_ori2aug, insts_aug2ori)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 115, in forward
    outputs = self.net(img_ori, img_aug, insts_ori2aug, insts_aug2ori)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug/slotaug_ae.py", line 89, in forward
    x_aug_ms = self.decoder_cnn(slots_aug_ms)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slota/slota_utils.py", line 128, in forward
    x = self.deconvs(x)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/container.py", line 141, in forward
    input = module(input)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/activation.py", line 98, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/functional.py", line 1442, in relu
    result = torch.relu(input)
RuntimeError: CUDA out of memory. Tried to allocate 896.00 MiB (GPU 0; 15.78 GiB total capacity; 13.74 GiB already allocated; 259.75 MiB free; 14.27 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2023-04-30 02:51:42,974][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_is_ms_2_cycle_no_ms_img_loss_w_1over10/2023-04-30_02-51-03_dgx_gpu6
[2023-04-30 02:51:42,974][src.utils.utils][INFO] - Closing loggers...
[2023-04-30 02:51:42,975][src.utils.utils][INFO] - Closing wandb!
[2023-04-30 04:57:08,241][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1214, in _run_train
    self.fit_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 267, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 187, in advance
    batch = next(data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 184, in __next__
    return self.fetching_function()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 265, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 280, in _fetch_next_batch
    batch = next(iterator)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 569, in __next__
    return self.request_next_batch(self.loader_iters)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 581, in request_next_batch
    return apply_to_collection(loader_iters, Iterator, next)
  File "/opt/conda/lib/python3.8/site-packages/lightning_utilities/core/apply_func.py", line 51, in apply_to_collection
    return function(data, *args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 530, in __next__
    data = self._next_data()
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1224, in _next_data
    return self._process_data(data)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1250, in _process_data
    data.reraise()
  File "/opt/conda/lib/python3.8/site-packages/torch/_utils.py", line 457, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 3.
Original Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 287, in _worker_loop
    data = fetcher.fetch(index)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/workspace/slotaug/src/data/components/clevr6_aug.py", line 185, in __getitem__
  File "/opt/conda/lib/python3.8/site-packages/torchvision/io/image.py", line 245, in read_image
    data = read_file(path)
  File "/opt/conda/lib/python3.8/site-packages/torchvision/io/image.py", line 47, in read_file
    data = torch.ops.image.read_file(path)
RuntimeError: [Errno 2] No such file or directory: '/workspace/slotaug/data/clevr_with_masks/CLEVR6/images/train/CLEVR_train_066668.png'

[2023-04-30 04:57:08,247][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stc_refactoring/2023-04-29_14-33-42_dgx_gpu7
[2023-04-30 04:57:08,248][src.utils.utils][INFO] - Closing loggers...
[2023-04-30 04:57:08,248][src.utils.utils][INFO] - Closing wandb!
[2023-04-30 04:57:08,266][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1214, in _run_train
    self.fit_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 267, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 187, in advance
    batch = next(data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 184, in __next__
    return self.fetching_function()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 265, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 280, in _fetch_next_batch
    batch = next(iterator)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 569, in __next__
    return self.request_next_batch(self.loader_iters)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 581, in request_next_batch
    return apply_to_collection(loader_iters, Iterator, next)
  File "/opt/conda/lib/python3.8/site-packages/lightning_utilities/core/apply_func.py", line 51, in apply_to_collection
    return function(data, *args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 530, in __next__
    data = self._next_data()
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1204, in _next_data
    return self._process_data(data)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1250, in _process_data
    data.reraise()
  File "/opt/conda/lib/python3.8/site-packages/torch/_utils.py", line 457, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 2.
Original Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 287, in _worker_loop
    data = fetcher.fetch(index)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/workspace/slotaug/src/data/components/clevr6_aug.py", line 185, in __getitem__
  File "/opt/conda/lib/python3.8/site-packages/torchvision/io/image.py", line 245, in read_image
    data = read_file(path)
  File "/opt/conda/lib/python3.8/site-packages/torchvision/io/image.py", line 47, in read_file
    data = torch.ops.image.read_file(path)
RuntimeError: [Errno 2] No such file or directory: '/workspace/slotaug/data/clevr_with_masks/CLEVR6/images/train/CLEVR_train_054856.png'

[2023-04-30 04:57:08,272][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stc_is_refactoring/2023-04-29_14-31-47_dgx_gpu5
[2023-04-30 04:57:08,273][src.utils.utils][INFO] - Closing loggers...
[2023-04-30 04:57:08,273][src.utils.utils][INFO] - Closing wandb!
[2023-04-30 04:57:09,893][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1214, in _run_train
    self.fit_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 267, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 187, in advance
    batch = next(data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 184, in __next__
    return self.fetching_function()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 265, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 280, in _fetch_next_batch
    batch = next(iterator)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 569, in __next__
    return self.request_next_batch(self.loader_iters)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 581, in request_next_batch
    return apply_to_collection(loader_iters, Iterator, next)
  File "/opt/conda/lib/python3.8/site-packages/lightning_utilities/core/apply_func.py", line 51, in apply_to_collection
    return function(data, *args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 530, in __next__
    data = self._next_data()
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1224, in _next_data
    return self._process_data(data)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1250, in _process_data
    data.reraise()
  File "/opt/conda/lib/python3.8/site-packages/torch/_utils.py", line 457, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 1.
Original Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 287, in _worker_loop
    data = fetcher.fetch(index)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/workspace/slotaug/src/data/components/clevr10_aug.py", line 197, in __getitem__
  File "/opt/conda/lib/python3.8/site-packages/torchvision/io/image.py", line 245, in read_image
    data = read_file(path)
  File "/opt/conda/lib/python3.8/site-packages/torchvision/io/image.py", line 47, in read_file
    data = torch.ops.image.read_file(path)
RuntimeError: [Errno 2] No such file or directory: '/workspace/slotaug/data/clevr_with_masks/CLEVR10/images/train/CLEVR_train_043904.png'

[2023-04-30 04:57:09,899][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv10_stcf_is_slotaug/2023-04-26_09-37-41_dgx_gpu4
[2023-04-30 04:57:09,900][src.utils.utils][INFO] - Closing loggers...
[2023-04-30 04:57:09,900][src.utils.utils][INFO] - Closing wandb!
[2023-04-30 05:01:24,023][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-30 05:01:24,031][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-30 05:01:24,129][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-30 05:01:24,137][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-30 05:01:24,728][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpwl31l_y7
[2023-04-30 05:01:24,729][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpwl31l_y7/_remote_module_non_sriptable.py
[2023-04-30 05:01:24,764][__main__][INFO] - Instantiating callbacks...
[2023-04-30 05:01:24,765][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-30 05:01:24,768][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-30 05:01:24,769][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-30 05:01:24,770][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-30 05:01:24,771][__main__][INFO] - Instantiating loggers...
[2023-04-30 05:01:24,771][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-30 05:01:42,494][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-30 05:01:42,544][__main__][INFO] - Logging hyperparameters!
[2023-04-30 05:01:42,556][__main__][INFO] - Starting training!
[2023-04-30 05:01:42,632][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1051, in _run
    self._call_setup_hook()  # allow user to setup lightning_module in accelerator environment
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1298, in _call_setup_hook
    self._call_lightning_datamodule_hook("setup", stage=fn)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1375, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/workspace/slotaug/src/data/clevr6_aug_datamodule.py", line 75, in setup
    self.data_train = CLEVR6Aug(
  File "/workspace/slotaug/src/data/components/clevr6_aug.py", line 35, in __init__
    open(os.path.join(self.scene_dir, f"CLEVR_{self.stage}_scenes.json"))
FileNotFoundError: [Errno 2] No such file or directory: '/workspace/slotaug/data/clevr_with_masks/CLEVR6/scenes/CLEVR_train_scenes.json'
[2023-04-30 05:01:42,635][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stc_is_serial/2023-04-30_05-01-23_dgx_gpu6
[2023-04-30 05:01:42,635][src.utils.utils][INFO] - Closing loggers...
[2023-04-30 05:01:42,635][src.utils.utils][INFO] - Closing wandb!
[2023-04-30 05:08:40,289][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-30 05:08:40,298][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-30 05:08:40,403][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-30 05:08:40,408][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-30 05:08:41,069][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmphjpgjdey
[2023-04-30 05:08:41,069][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmphjpgjdey/_remote_module_non_sriptable.py
[2023-04-30 05:08:41,106][__main__][INFO] - Instantiating callbacks...
[2023-04-30 05:08:41,106][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-30 05:08:41,111][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-30 05:08:41,112][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-30 05:08:41,113][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-30 05:08:41,114][__main__][INFO] - Instantiating loggers...
[2023-04-30 05:08:41,114][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-30 05:08:58,852][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-30 05:08:58,906][__main__][INFO] - Logging hyperparameters!
[2023-04-30 05:08:58,920][__main__][INFO] - Starting training!
[2023-04-30 05:10:40,263][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-30 05:10:40,271][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-30 05:10:40,379][__main__][INFO] - Instantiating datamodule <src.data.clevr10_aug_datamodule.CLEVR10AugDataModule>
[2023-04-30 05:10:40,387][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-30 05:10:41,135][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp5p_xkkm2
[2023-04-30 05:10:41,136][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp5p_xkkm2/_remote_module_non_sriptable.py
[2023-04-30 05:10:41,173][__main__][INFO] - Instantiating callbacks...
[2023-04-30 05:10:41,173][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-30 05:10:41,177][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-30 05:10:41,178][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-30 05:10:41,179][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-30 05:10:41,180][__main__][INFO] - Instantiating loggers...
[2023-04-30 05:10:41,180][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-30 05:10:58,823][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-30 05:10:58,873][__main__][INFO] - Logging hyperparameters!
[2023-04-30 05:10:58,885][__main__][INFO] - Starting training!
[2023-04-30 05:15:40,985][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-30 05:15:40,994][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-30 05:15:41,109][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-30 05:15:41,121][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-30 05:15:41,917][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpovk0fzea
[2023-04-30 05:15:41,918][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpovk0fzea/_remote_module_non_sriptable.py
[2023-04-30 05:15:41,974][__main__][INFO] - Instantiating callbacks...
[2023-04-30 05:15:41,975][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-30 05:15:41,979][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-30 05:15:41,980][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-30 05:15:41,981][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-30 05:15:41,982][__main__][INFO] - Instantiating loggers...
[2023-04-30 05:15:41,983][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-30 05:15:59,726][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-30 05:15:59,781][__main__][INFO] - Logging hyperparameters!
[2023-04-30 05:15:59,794][__main__][INFO] - Starting training!
[2023-04-30 05:17:26,939][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-30 05:17:26,949][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-30 05:17:27,076][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-30 05:17:27,085][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-30 05:17:27,908][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpivlq5k5t
[2023-04-30 05:17:27,909][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpivlq5k5t/_remote_module_non_sriptable.py
[2023-04-30 05:17:27,990][__main__][INFO] - Instantiating callbacks...
[2023-04-30 05:17:27,990][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-30 05:17:27,995][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-30 05:17:27,996][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-30 05:17:27,998][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-30 05:17:27,998][__main__][INFO] - Instantiating loggers...
[2023-04-30 05:17:27,999][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-30 05:17:45,878][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-30 05:17:45,937][__main__][INFO] - Logging hyperparameters!
[2023-04-30 05:17:45,950][__main__][INFO] - Starting training!
[2023-04-30 06:31:10,598][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1214, in _run_train
    self.fit_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 267, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 187, in advance
    batch = next(data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 184, in __next__
    return self.fetching_function()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 265, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 280, in _fetch_next_batch
    batch = next(iterator)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 569, in __next__
    return self.request_next_batch(self.loader_iters)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 581, in request_next_batch
    return apply_to_collection(loader_iters, Iterator, next)
  File "/opt/conda/lib/python3.8/site-packages/lightning_utilities/core/apply_func.py", line 51, in apply_to_collection
    return function(data, *args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 530, in __next__
    data = self._next_data()
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1224, in _next_data
    return self._process_data(data)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1250, in _process_data
    data.reraise()
  File "/opt/conda/lib/python3.8/site-packages/torch/_utils.py", line 457, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 3.
Original Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 287, in _worker_loop
    data = fetcher.fetch(index)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/workspace/slotaug/src/data/components/clevr10_aug.py", line 55, in __getitem__
    read_image(os.path.join(self.image_dir, filename), ImageReadMode.RGB)
  File "/opt/conda/lib/python3.8/site-packages/torchvision/io/image.py", line 245, in read_image
    data = read_file(path)
  File "/opt/conda/lib/python3.8/site-packages/torchvision/io/image.py", line 47, in read_file
    data = torch.ops.image.read_file(path)
RuntimeError: [Errno 2] No such file or directory: '/workspace/slotaug/data/clevr_with_masks/CLEVR10/images/train/CLEVR_train_010838.png'

[2023-04-30 06:31:10,603][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv10_stcf_is_slotaug/2023-04-30_05-10-40_dgx_gpu4
[2023-04-30 06:31:10,604][src.utils.utils][INFO] - Closing loggers...
[2023-04-30 06:31:10,604][src.utils.utils][INFO] - Closing wandb!
[2023-04-30 06:31:27,998][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1214, in _run_train
    self.fit_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 267, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 187, in advance
    batch = next(data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 184, in __next__
    return self.fetching_function()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 265, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 280, in _fetch_next_batch
    batch = next(iterator)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 569, in __next__
    return self.request_next_batch(self.loader_iters)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 581, in request_next_batch
    return apply_to_collection(loader_iters, Iterator, next)
  File "/opt/conda/lib/python3.8/site-packages/lightning_utilities/core/apply_func.py", line 51, in apply_to_collection
    return function(data, *args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 530, in __next__
    data = self._next_data()
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1224, in _next_data
    return self._process_data(data)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1250, in _process_data
    data.reraise()
  File "/opt/conda/lib/python3.8/site-packages/torch/_utils.py", line 457, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 2.
Original Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 287, in _worker_loop
    data = fetcher.fetch(index)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/workspace/slotaug/src/data/components/clevr6_aug.py", line 55, in __getitem__
    read_image(os.path.join(self.image_dir, filename), ImageReadMode.RGB)
  File "/opt/conda/lib/python3.8/site-packages/torchvision/io/image.py", line 245, in read_image
    data = read_file(path)
  File "/opt/conda/lib/python3.8/site-packages/torchvision/io/image.py", line 47, in read_file
    data = torch.ops.image.read_file(path)
RuntimeError: [Errno 2] No such file or directory: '/workspace/slotaug/data/clevr_with_masks/CLEVR6/images/train/CLEVR_train_015487.png'

[2023-04-30 06:31:28,005][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_is_serial/2023-04-30_05-15-40_dgx_gpu5
[2023-04-30 06:31:28,005][src.utils.utils][INFO] - Closing loggers...
[2023-04-30 06:31:28,006][src.utils.utils][INFO] - Closing wandb!
[2023-04-30 06:31:28,057][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1214, in _run_train
    self.fit_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 267, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 187, in advance
    batch = next(data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 184, in __next__
    return self.fetching_function()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 265, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 280, in _fetch_next_batch
    batch = next(iterator)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 569, in __next__
    return self.request_next_batch(self.loader_iters)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 581, in request_next_batch
    return apply_to_collection(loader_iters, Iterator, next)
  File "/opt/conda/lib/python3.8/site-packages/lightning_utilities/core/apply_func.py", line 51, in apply_to_collection
    return function(data, *args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 530, in __next__
    data = self._next_data()
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1224, in _next_data
    return self._process_data(data)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1250, in _process_data
    data.reraise()
  File "/opt/conda/lib/python3.8/site-packages/torch/_utils.py", line 457, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 2.
Original Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 287, in _worker_loop
    data = fetcher.fetch(index)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/workspace/slotaug/src/data/components/clevr6_aug.py", line 55, in __getitem__
    read_image(os.path.join(self.image_dir, filename), ImageReadMode.RGB)
  File "/opt/conda/lib/python3.8/site-packages/torchvision/io/image.py", line 245, in read_image
    data = read_file(path)
  File "/opt/conda/lib/python3.8/site-packages/torchvision/io/image.py", line 47, in read_file
    data = torch.ops.image.read_file(path)
RuntimeError: [Errno 2] No such file or directory: '/workspace/slotaug/data/clevr_with_masks/CLEVR6/images/train/CLEVR_train_001000.png'

[2023-04-30 06:31:28,064][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stc_serial/2023-04-30_05-17-26_dgx_gpu7
[2023-04-30 06:31:28,064][src.utils.utils][INFO] - Closing loggers...
[2023-04-30 06:31:28,065][src.utils.utils][INFO] - Closing wandb!
[2023-04-30 06:31:28,409][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1214, in _run_train
    self.fit_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 267, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 187, in advance
    batch = next(data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 184, in __next__
    return self.fetching_function()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 265, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 280, in _fetch_next_batch
    batch = next(iterator)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 569, in __next__
    return self.request_next_batch(self.loader_iters)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 581, in request_next_batch
    return apply_to_collection(loader_iters, Iterator, next)
  File "/opt/conda/lib/python3.8/site-packages/lightning_utilities/core/apply_func.py", line 51, in apply_to_collection
    return function(data, *args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 530, in __next__
    data = self._next_data()
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1224, in _next_data
    return self._process_data(data)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1250, in _process_data
    data.reraise()
  File "/opt/conda/lib/python3.8/site-packages/torch/_utils.py", line 457, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 3.
Original Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 287, in _worker_loop
    data = fetcher.fetch(index)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/workspace/slotaug/src/data/components/clevr6_aug.py", line 55, in __getitem__
    read_image(os.path.join(self.image_dir, filename), ImageReadMode.RGB)
  File "/opt/conda/lib/python3.8/site-packages/torchvision/io/image.py", line 245, in read_image
    data = read_file(path)
  File "/opt/conda/lib/python3.8/site-packages/torchvision/io/image.py", line 47, in read_file
    data = torch.ops.image.read_file(path)
RuntimeError: [Errno 2] No such file or directory: '/workspace/slotaug/data/clevr_with_masks/CLEVR6/images/train/CLEVR_train_004342.png'

[2023-04-30 06:31:28,415][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stc_is_serial/2023-04-30_05-08-40_dgx_gpu6
[2023-04-30 06:31:28,416][src.utils.utils][INFO] - Closing loggers...
[2023-04-30 06:31:28,416][src.utils.utils][INFO] - Closing wandb!
[2023-04-30 06:34:09,900][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-30 06:34:09,908][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-30 06:34:10,005][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-30 06:34:10,012][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-30 06:34:10,648][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpsr82n7q1
[2023-04-30 06:34:10,649][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpsr82n7q1/_remote_module_non_sriptable.py
[2023-04-30 06:34:10,685][__main__][INFO] - Instantiating callbacks...
[2023-04-30 06:34:10,685][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-30 06:34:10,689][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-30 06:34:10,690][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-30 06:34:10,691][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-30 06:34:10,692][__main__][INFO] - Instantiating loggers...
[2023-04-30 06:34:10,693][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-30 06:34:28,394][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-30 06:34:28,445][__main__][INFO] - Logging hyperparameters!
[2023-04-30 06:34:28,455][__main__][INFO] - Starting training!
[2023-04-30 06:34:35,625][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-30 06:34:35,634][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-30 06:34:35,735][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-30 06:34:35,738][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-30 06:34:36,444][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpkghclttm
[2023-04-30 06:34:36,445][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpkghclttm/_remote_module_non_sriptable.py
[2023-04-30 06:34:36,495][__main__][INFO] - Instantiating callbacks...
[2023-04-30 06:34:36,496][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-30 06:34:36,501][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-30 06:34:36,502][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-30 06:34:36,503][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-30 06:34:36,504][__main__][INFO] - Instantiating loggers...
[2023-04-30 06:34:36,505][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-30 06:34:54,220][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-30 06:34:54,277][__main__][INFO] - Logging hyperparameters!
[2023-04-30 06:34:54,287][__main__][INFO] - Starting training!
[2023-04-30 06:43:05,048][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-30 06:43:05,058][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-30 06:43:05,161][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-30 06:43:05,166][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-30 06:43:05,689][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_aug_slotaug/2023-04-30_06-43-04_dgx_gpu4
[2023-04-30 06:43:05,690][src.utils.utils][INFO] - Closing loggers...
[2023-04-30 06:43:35,296][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-30 06:43:35,304][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-30 06:43:35,417][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-30 06:43:35,421][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-30 06:43:36,124][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpkhinc_67
[2023-04-30 06:43:36,125][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpkhinc_67/_remote_module_non_sriptable.py
[2023-04-30 06:43:36,168][__main__][INFO] - Instantiating callbacks...
[2023-04-30 06:43:36,169][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-30 06:43:36,173][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-30 06:43:36,174][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-30 06:43:36,175][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-30 06:43:36,176][__main__][INFO] - Instantiating loggers...
[2023-04-30 06:43:36,177][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-30 06:43:53,902][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-30 06:43:53,954][__main__][INFO] - Logging hyperparameters!
[2023-04-30 06:43:53,965][__main__][INFO] - Starting training!
[2023-04-30 06:44:13,344][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1214, in _run_train
    self.fit_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 267, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 213, in advance
    batch_output = self.batch_loop.run(kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 88, in advance
    outputs = self.optimizer_loop.run(optimizers, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 202, in advance
    result = self._run_optimization(kwargs, self._optimizers[self.optim_progress.optimizer_position])
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 249, in _run_optimization
    self._optimizer_step(optimizer, opt_idx, kwargs.get("batch_idx", 0), closure)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 370, in _optimizer_step
    self.trainer._call_lightning_module_hook(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1356, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/core/module.py", line 1742, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/core/optimizer.py", line 169, in step
    step_output = self._strategy.optimizer_step(self._optimizer, self._optimizer_idx, closure, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 234, in optimizer_step
    return self.precision_plugin.optimizer_step(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/plugins/precision/native_amp.py", line 75, in optimizer_step
    closure_result = closure()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 149, in __call__
    self._result = self.closure(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 135, in closure
    step_output = self._step_fn()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 419, in _training_step
    training_step_output = self.trainer._call_strategy_hook("training_step", *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in training_step
    return self.model.training_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 151, in training_step
    model_step_outputs = self.model_step(batch)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 126, in model_step
    outputs = self.forward(img_ori, img_aug, insts_ori2aug, insts_aug2ori)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 117, in forward
    outputs = self.net(img_ori, img_aug, insts_ori2aug, insts_aug2ori)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug/slotaug_ae.py", line 89, in forward
    x_aug_ms = self.decoder_cnn(slots_aug_ms)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slota/slota_utils.py", line 128, in forward
    x = self.deconvs(x)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/container.py", line 141, in forward
    input = module(input)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/activation.py", line 98, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/functional.py", line 1442, in relu
    result = torch.relu(input)
RuntimeError: CUDA out of memory. Tried to allocate 896.00 MiB (GPU 0; 15.78 GiB total capacity; 13.75 GiB already allocated; 249.75 MiB free; 14.28 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2023-04-30 06:44:13,352][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_is_ms_2_cycle_no_ms_img_loss_curri_50_weight_1over10/2023-04-30_06-43-35_dgx_gpu4
[2023-04-30 06:44:13,354][src.utils.utils][INFO] - Closing loggers...
[2023-04-30 06:44:13,355][src.utils.utils][INFO] - Closing wandb!
[2023-04-30 06:47:20,862][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-30 06:47:20,871][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-30 06:47:20,975][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-30 06:47:20,979][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-30 06:47:21,702][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmprw5d06_t
[2023-04-30 06:47:21,702][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmprw5d06_t/_remote_module_non_sriptable.py
[2023-04-30 06:47:21,744][__main__][INFO] - Instantiating callbacks...
[2023-04-30 06:47:21,745][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-30 06:47:21,749][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-30 06:47:21,750][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-30 06:47:21,751][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-30 06:47:21,752][__main__][INFO] - Instantiating loggers...
[2023-04-30 06:47:21,753][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-30 06:47:39,527][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-30 06:47:39,601][__main__][INFO] - Logging hyperparameters!
[2023-04-30 06:47:39,615][__main__][INFO] - Starting training!
[2023-04-30 06:55:47,749][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-30 06:55:47,758][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-30 06:55:47,866][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-30 06:55:47,872][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-30 06:55:48,632][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmps3b3crt9
[2023-04-30 06:55:48,633][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmps3b3crt9/_remote_module_non_sriptable.py
[2023-04-30 06:55:48,713][__main__][INFO] - Instantiating callbacks...
[2023-04-30 06:55:48,713][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-30 06:55:48,718][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-30 06:55:48,719][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-30 06:55:48,720][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-30 06:55:48,721][__main__][INFO] - Instantiating loggers...
[2023-04-30 06:55:48,722][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-30 06:56:06,481][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-30 06:56:06,541][__main__][INFO] - Logging hyperparameters!
[2023-04-30 06:56:06,555][__main__][INFO] - Starting training!
[2023-04-30 06:56:25,560][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 262, in validation_step
    loss, outputs = self._shared_eval_step(batch, batch_idx)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 206, in _shared_eval_step
    model_step_outputs = self.model_step(batch)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 126, in model_step
    outputs = self.forward(img_ori, img_aug, insts_ori2aug, insts_aug2ori)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 117, in forward
    outputs = self.net(img_ori, img_aug, insts_ori2aug, insts_aug2ori)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug/slotaug_ae.py", line 79, in forward
    slotaug_outputs = self.slotaug(inputs=x, insts=insts_ori2aug)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug/slotaug.py", line 202, in forward
    dummy_insts_list = augment_insts(self.dummy_insts.repeat(B, 1, 1).to(insts.device), steps=random_multi_steps)
  File "/workspace/slotaug/src/models/components/slotaug/slotaug_utils.py", line 61, in augment_insts
    split_values = np.array(split_values) * np.array(noise_values)
  File "/opt/conda/lib/python3.8/site-packages/torch/_tensor.py", line 732, in __array__
    return self.numpy()
TypeError: can't convert cuda:0 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
[2023-04-30 06:56:25,565][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_is_ms_v2_2_weight_1over10/2023-04-30_06-55-47_dgx_gpu7
[2023-04-30 06:56:25,566][src.utils.utils][INFO] - Closing loggers...
[2023-04-30 06:56:25,566][src.utils.utils][INFO] - Closing wandb!
[2023-04-30 06:58:14,415][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_is_ms_2_cycle_no_ms_img_loss_curri_50_weight_1over10/2023-04-30_06-47-20_dgx_gpu4
[2023-04-30 06:58:14,416][src.utils.utils][INFO] - Closing loggers...
[2023-04-30 06:58:14,416][src.utils.utils][INFO] - Closing wandb!
[2023-04-30 06:58:16,453][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-30 06:58:16,462][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-30 06:58:16,568][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-30 06:58:16,571][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-30 06:58:17,297][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp8d0c1w3o
[2023-04-30 06:58:17,297][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp8d0c1w3o/_remote_module_non_sriptable.py
[2023-04-30 06:58:17,338][__main__][INFO] - Instantiating callbacks...
[2023-04-30 06:58:17,339][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-30 06:58:17,343][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-30 06:58:17,344][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-30 06:58:17,345][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-30 06:58:17,345][__main__][INFO] - Instantiating loggers...
[2023-04-30 06:58:17,346][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-30 06:58:27,051][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-30 06:58:27,059][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-30 06:58:27,169][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-30 06:58:27,173][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-30 06:58:27,846][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp9u7fcql2
[2023-04-30 06:58:27,848][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp9u7fcql2/_remote_module_non_sriptable.py
[2023-04-30 06:58:27,888][__main__][INFO] - Instantiating callbacks...
[2023-04-30 06:58:27,889][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-30 06:58:27,893][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-30 06:58:27,894][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-30 06:58:27,896][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-30 06:58:27,897][__main__][INFO] - Instantiating loggers...
[2023-04-30 06:58:27,897][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-30 06:58:35,077][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-30 06:58:35,132][__main__][INFO] - Logging hyperparameters!
[2023-04-30 06:58:35,143][__main__][INFO] - Starting training!
[2023-04-30 06:58:45,744][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-30 06:58:45,833][__main__][INFO] - Logging hyperparameters!
[2023-04-30 06:58:45,851][__main__][INFO] - Starting training!
[2023-04-30 06:58:46,195][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 262, in validation_step
    loss, outputs = self._shared_eval_step(batch, batch_idx)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 206, in _shared_eval_step
    model_step_outputs = self.model_step(batch)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 126, in model_step
    outputs = self.forward(img_ori, img_aug, insts_ori2aug, insts_aug2ori)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 117, in forward
    outputs = self.net(img_ori, img_aug, insts_ori2aug, insts_aug2ori)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug/slotaug_ae.py", line 79, in forward
    slotaug_outputs = self.slotaug(inputs=x, insts=insts_ori2aug)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug/slotaug.py", line 202, in forward
    dummy_insts_list = augment_insts(self.dummy_insts.repeat(B, 1, 1).to(insts.device), steps=random_multi_steps)
  File "/workspace/slotaug/src/models/components/slotaug/slotaug_utils.py", line 42, in augment_insts
    split_values = torch.tensor(split_values).to(insts.device) + torch.tensor(noise_values).to(insts.device)
ValueError: only one element tensors can be converted to Python scalars
[2023-04-30 06:58:46,201][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_is_ms_v2_2_weight_1over10/2023-04-30_06-58-16_dgx_gpu7
[2023-04-30 06:58:46,201][src.utils.utils][INFO] - Closing loggers...
[2023-04-30 06:58:46,201][src.utils.utils][INFO] - Closing wandb!
[2023-04-30 06:58:57,212][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 262, in validation_step
    loss, outputs = self._shared_eval_step(batch, batch_idx)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 206, in _shared_eval_step
    model_step_outputs = self.model_step(batch)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 126, in model_step
    outputs = self.forward(img_ori, img_aug, insts_ori2aug, insts_aug2ori)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 117, in forward
    outputs = self.net(img_ori, img_aug, insts_ori2aug, insts_aug2ori)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug/slotaug_ae.py", line 79, in forward
    slotaug_outputs = self.slotaug(inputs=x, insts=insts_ori2aug)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug/slotaug.py", line 202, in forward
    dummy_insts_list = augment_insts(self.dummy_insts.repeat(B, 1, 1).to(insts.device), steps=random_multi_steps)
  File "/workspace/slotaug/src/models/components/slotaug/slotaug_utils.py", line 42, in augment_insts
    split_values = torch.tensor(split_values).to(insts.device) + torch.tensor(noise_values).to(insts.device)
ValueError: only one element tensors can be converted to Python scalars
[2023-04-30 06:58:57,218][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_is_ms_2_cycle_no_ms_img_loss_curri_50_weight_1over10/2023-04-30_06-58-26_dgx_gpu4
[2023-04-30 06:58:57,219][src.utils.utils][INFO] - Closing loggers...
[2023-04-30 06:58:57,219][src.utils.utils][INFO] - Closing wandb!
[2023-04-30 07:01:00,724][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-30 07:01:00,732][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-30 07:01:00,837][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-30 07:01:00,840][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-30 07:01:01,567][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmplf_3d0ua
[2023-04-30 07:01:01,567][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmplf_3d0ua/_remote_module_non_sriptable.py
[2023-04-30 07:01:01,608][__main__][INFO] - Instantiating callbacks...
[2023-04-30 07:01:01,609][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-30 07:01:01,613][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-30 07:01:01,614][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-30 07:01:01,615][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-30 07:01:01,615][__main__][INFO] - Instantiating loggers...
[2023-04-30 07:01:01,616][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-30 07:01:19,302][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-30 07:01:19,379][__main__][INFO] - Logging hyperparameters!
[2023-04-30 07:01:19,391][__main__][INFO] - Starting training!
[2023-04-30 07:01:37,505][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 262, in validation_step
    loss, outputs = self._shared_eval_step(batch, batch_idx)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 206, in _shared_eval_step
    model_step_outputs = self.model_step(batch)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 126, in model_step
    outputs = self.forward(img_ori, img_aug, insts_ori2aug, insts_aug2ori)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 117, in forward
    outputs = self.net(img_ori, img_aug, insts_ori2aug, insts_aug2ori)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug/slotaug_ae.py", line 79, in forward
    slotaug_outputs = self.slotaug(inputs=x, insts=insts_ori2aug)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug/slotaug.py", line 202, in forward
    dummy_insts_list = augment_insts(self.dummy_insts.repeat(B, 1, 1).to(insts.device), steps=random_multi_steps)
  File "/workspace/slotaug/src/models/components/slotaug/slotaug_utils.py", line 42, in augment_insts
    augmented_values = torch.tensor(split_values).to(insts.device) + torch.tensor(noise_values).to(insts.device)
ValueError: only one element tensors can be converted to Python scalars
[2023-04-30 07:01:37,510][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_is_ms_v2_2_weight_1over10/2023-04-30_07-01-00_dgx_gpu7
[2023-04-30 07:01:37,511][src.utils.utils][INFO] - Closing loggers...
[2023-04-30 07:01:37,511][src.utils.utils][INFO] - Closing wandb!
[2023-04-30 07:03:13,103][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-30 07:03:13,111][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-30 07:03:13,216][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-30 07:03:13,219][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-30 07:03:13,933][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp2gymsl2d
[2023-04-30 07:03:13,933][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp2gymsl2d/_remote_module_non_sriptable.py
[2023-04-30 07:03:13,978][__main__][INFO] - Instantiating callbacks...
[2023-04-30 07:03:13,978][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-30 07:03:13,982][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-30 07:03:13,983][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-30 07:03:13,984][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-30 07:03:13,985][__main__][INFO] - Instantiating loggers...
[2023-04-30 07:03:13,985][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-30 07:03:31,803][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-30 07:03:31,856][__main__][INFO] - Logging hyperparameters!
[2023-04-30 07:03:31,867][__main__][INFO] - Starting training!
[2023-04-30 07:05:33,241][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-30 07:05:33,250][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-30 07:05:33,367][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-30 07:05:33,371][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-30 07:05:34,089][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpbopq0zst
[2023-04-30 07:05:34,089][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpbopq0zst/_remote_module_non_sriptable.py
[2023-04-30 07:05:34,129][__main__][INFO] - Instantiating callbacks...
[2023-04-30 07:05:34,130][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-30 07:05:34,134][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-30 07:05:34,135][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-30 07:05:34,136][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-30 07:05:34,137][__main__][INFO] - Instantiating loggers...
[2023-04-30 07:05:34,138][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-30 07:05:51,871][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-30 07:05:51,924][__main__][INFO] - Logging hyperparameters!
[2023-04-30 07:05:51,934][__main__][INFO] - Starting training!
[2023-04-30 10:24:18,946][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_is_ms_v2_2_weight_1over10/2023-04-30_07-03-12_dgx_gpu7
[2023-04-30 10:24:18,947][src.utils.utils][INFO] - Closing loggers...
[2023-04-30 10:24:18,947][src.utils.utils][INFO] - Closing wandb!
[2023-04-30 10:24:23,224][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-30 10:24:23,233][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-30 10:24:23,342][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-04-30 10:24:23,346][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-04-30 10:24:24,022][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp4exqyvke
[2023-04-30 10:24:24,023][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp4exqyvke/_remote_module_non_sriptable.py
[2023-04-30 10:24:24,064][__main__][INFO] - Instantiating callbacks...
[2023-04-30 10:24:24,064][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-30 10:24:24,069][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-30 10:24:24,070][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-30 10:24:24,071][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-04-30 10:24:24,072][__main__][INFO] - Instantiating loggers...
[2023-04-30 10:24:24,072][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-04-30 10:24:41,827][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-04-30 10:24:41,883][__main__][INFO] - Logging hyperparameters!
[2023-04-30 10:24:41,894][__main__][INFO] - Starting training!
[2023-05-01 03:51:19,032][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_is_serial/2023-04-30_06-34-09_dgx_gpu5
[2023-05-01 03:51:19,033][src.utils.utils][INFO] - Closing loggers...
[2023-05-01 03:51:19,034][src.utils.utils][INFO] - Closing wandb!
[2023-05-01 03:51:24,614][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-01 03:51:24,622][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-01 03:51:24,723][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-01 03:51:24,729][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-01 03:51:25,462][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp7irr6g0c
[2023-05-01 03:51:25,463][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp7irr6g0c/_remote_module_non_sriptable.py
[2023-05-01 03:51:25,516][__main__][INFO] - Instantiating callbacks...
[2023-05-01 03:51:25,517][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-01 03:51:25,521][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-01 03:51:25,522][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-01 03:51:25,523][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-01 03:51:25,524][__main__][INFO] - Instantiating loggers...
[2023-05-01 03:51:25,524][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-01 03:51:42,911][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stc_is_serial/2023-04-30_06-34-35_dgx_gpu6
[2023-05-01 03:51:42,912][src.utils.utils][INFO] - Closing loggers...
[2023-05-01 03:51:42,912][src.utils.utils][INFO] - Closing wandb!
[2023-05-01 03:51:43,302][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-01 03:51:43,395][__main__][INFO] - Logging hyperparameters!
[2023-05-01 03:51:43,406][__main__][INFO] - Starting training!
[2023-05-01 03:51:49,432][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-01 03:51:49,441][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-01 03:51:49,550][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-01 03:51:49,554][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-01 03:51:50,301][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpv0kavuif
[2023-05-01 03:51:50,301][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpv0kavuif/_remote_module_non_sriptable.py
[2023-05-01 03:51:50,341][__main__][INFO] - Instantiating callbacks...
[2023-05-01 03:51:50,341][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-01 03:51:50,346][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-01 03:51:50,347][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-01 03:51:50,349][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-01 03:51:50,350][__main__][INFO] - Instantiating loggers...
[2023-05-01 03:51:50,350][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-01 03:52:08,120][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-01 03:52:08,179][__main__][INFO] - Logging hyperparameters!
[2023-05-01 03:52:08,190][__main__][INFO] - Starting training!
[2023-05-01 10:34:42,514][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_is_ms_2_curri_50_weight_1over10/2023-04-30_07-05-33_dgx_gpu4
[2023-05-01 10:34:42,515][src.utils.utils][INFO] - Closing loggers...
[2023-05-01 10:34:42,515][src.utils.utils][INFO] - Closing wandb!
[2023-05-01 10:36:07,928][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-01 10:36:07,936][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-01 10:36:08,047][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-01 10:36:08,054][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-01 10:36:08,757][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
TypeError: __init__() got an unexpected keyword argument 'max_multi_steps'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 56, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.components.slotaug.slotaug_ae.SlotAugAutoEncoder':
TypeError("__init__() got an unexpected keyword argument 'max_multi_steps'")
full_key: model.net
[2023-05-01 10:36:08,759][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_is_serial_ms_2_weight_1over10/2023-05-01_10-36-07_dgx_gpu4
[2023-05-01 10:36:08,759][src.utils.utils][INFO] - Closing loggers...
[2023-05-01 10:36:28,305][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-01 10:36:28,315][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-01 10:36:28,438][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-01 10:36:28,443][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-01 10:36:29,222][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpai4twl5q
[2023-05-01 10:36:29,223][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpai4twl5q/_remote_module_non_sriptable.py
[2023-05-01 10:36:29,304][__main__][INFO] - Instantiating callbacks...
[2023-05-01 10:36:29,305][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-01 10:36:29,309][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-01 10:36:29,311][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-01 10:36:29,312][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-01 10:36:29,313][__main__][INFO] - Instantiating loggers...
[2023-05-01 10:36:29,313][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-01 10:36:47,071][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-01 10:36:47,149][__main__][INFO] - Logging hyperparameters!
[2023-05-01 10:36:47,167][__main__][INFO] - Starting training!
[2023-05-01 10:36:59,217][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 264, in validation_step
    loss, outputs = self._shared_eval_step(batch, batch_idx)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 208, in _shared_eval_step
    model_step_outputs = self.model_step(batch)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 128, in model_step
    outputs = self.forward(img_ori, img_aug, insts_ori2aug, insts_aug2ori)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 119, in forward
    outputs = self.net(img_ori, img_aug, insts_ori2aug, insts_aug2ori)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
TypeError: forward() missing 1 required positional argument: 'max_multi_steps'
[2023-05-01 10:36:59,224][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_is_serial_ms_2_weight_1over10/2023-05-01_10-36-28_dgx_gpu4
[2023-05-01 10:36:59,224][src.utils.utils][INFO] - Closing loggers...
[2023-05-01 10:36:59,225][src.utils.utils][INFO] - Closing wandb!
[2023-05-01 10:38:10,985][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-01 10:38:10,994][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-01 10:38:11,109][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-01 10:38:11,113][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-01 10:38:11,917][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp7f7yluh5
[2023-05-01 10:38:11,918][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp7f7yluh5/_remote_module_non_sriptable.py
[2023-05-01 10:38:12,001][__main__][INFO] - Instantiating callbacks...
[2023-05-01 10:38:12,001][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-01 10:38:12,007][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-01 10:38:12,008][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-01 10:38:12,009][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-01 10:38:12,010][__main__][INFO] - Instantiating loggers...
[2023-05-01 10:38:12,010][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-01 10:38:29,988][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-01 10:38:30,050][__main__][INFO] - Logging hyperparameters!
[2023-05-01 10:38:30,062][__main__][INFO] - Starting training!
[2023-05-02 01:09:11,045][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_is_ms_v2_2_weight_1over10/2023-04-30_10-24-23_dgx_gpu7
[2023-05-02 01:09:11,046][src.utils.utils][INFO] - Closing loggers...
[2023-05-02 01:09:11,046][src.utils.utils][INFO] - Closing wandb!
[2023-05-02 01:09:27,880][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-05-02 11:03:19,106][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-02 11:03:19,115][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-02 11:03:19,227][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-02 11:03:19,233][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-02 11:03:19,938][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmprvjcycac
[2023-05-02 11:03:19,938][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmprvjcycac/_remote_module_non_sriptable.py
[2023-05-02 11:03:19,998][__main__][INFO] - Instantiating callbacks...
[2023-05-02 11:03:19,999][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-02 11:03:20,004][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-02 11:03:20,005][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-02 11:03:20,006][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-02 11:03:20,007][__main__][INFO] - Instantiating loggers...
[2023-05-02 11:03:20,008][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-02 11:03:37,830][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-02 11:03:37,890][__main__][INFO] - Logging hyperparameters!
[2023-05-02 11:03:37,900][__main__][INFO] - Starting training!
[2023-05-02 11:04:01,832][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_is_serial_ms_2_weight_1over10/2023-05-01_10-38-10_dgx_gpu4
[2023-05-02 11:04:01,833][src.utils.utils][INFO] - Closing loggers...
[2023-05-02 11:04:01,834][src.utils.utils][INFO] - Closing wandb!
[2023-05-02 11:04:15,164][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-05-02 11:12:52,294][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-02 11:12:52,303][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-02 11:12:52,417][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-02 11:12:52,421][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-02 11:12:53,212][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmplwl2bt4y
[2023-05-02 11:12:53,213][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmplwl2bt4y/_remote_module_non_sriptable.py
[2023-05-02 11:12:53,287][__main__][INFO] - Instantiating callbacks...
[2023-05-02 11:12:53,287][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-02 11:12:53,292][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-02 11:12:53,293][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-02 11:12:53,294][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-02 11:12:53,295][__main__][INFO] - Instantiating loggers...
[2023-05-02 11:12:53,296][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-02 11:13:11,138][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-02 11:13:11,194][__main__][INFO] - Logging hyperparameters!
[2023-05-02 11:13:11,205][__main__][INFO] - Starting training!
[2023-05-02 16:06:29,243][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_is_serial/2023-05-01_03-51-24_dgx_gpu5
[2023-05-02 16:06:29,243][src.utils.utils][INFO] - Closing loggers...
[2023-05-02 16:06:29,244][src.utils.utils][INFO] - Closing wandb!
[2023-05-02 16:06:47,308][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-05-02 16:41:05,836][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stc_is_serial/2023-05-01_03-51-49_dgx_gpu6
[2023-05-02 16:41:05,837][src.utils.utils][INFO] - Closing loggers...
[2023-05-02 16:41:05,837][src.utils.utils][INFO] - Closing wandb!
[2023-05-02 16:41:17,338][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-05-02 16:48:02,469][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stc_is_v3/2023-05-02_11-12-52_dgx_gpu4
[2023-05-02 16:48:02,470][src.utils.utils][INFO] - Closing loggers...
[2023-05-02 16:48:02,471][src.utils.utils][INFO] - Closing wandb!
[2023-05-02 16:48:18,094][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-02 16:48:18,103][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-02 16:48:18,206][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-02 16:48:18,210][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-02 16:48:18,858][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpo1j9dw6q
[2023-05-02 16:48:18,859][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpo1j9dw6q/_remote_module_non_sriptable.py
[2023-05-02 16:48:18,898][__main__][INFO] - Instantiating callbacks...
[2023-05-02 16:48:18,898][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-02 16:48:18,903][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-02 16:48:18,904][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-02 16:48:18,905][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-02 16:48:18,906][__main__][INFO] - Instantiating loggers...
[2023-05-02 16:48:18,906][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-02 16:48:36,669][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-02 16:48:36,722][__main__][INFO] - Logging hyperparameters!
[2023-05-02 16:48:36,733][__main__][INFO] - Starting training!
[2023-05-03 05:44:15,925][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-03 05:44:15,933][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-03 05:44:16,044][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-03 05:44:16,047][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-03 05:44:16,775][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp3swp7bxs
[2023-05-03 05:44:16,776][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp3swp7bxs/_remote_module_non_sriptable.py
[2023-05-03 05:44:16,814][__main__][INFO] - Instantiating callbacks...
[2023-05-03 05:44:16,815][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-03 05:44:16,819][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-03 05:44:16,820][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-03 05:44:16,821][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-03 05:44:16,821][__main__][INFO] - Instantiating loggers...
[2023-05-03 05:44:16,822][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-03 05:44:34,543][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-03 05:44:34,597][__main__][INFO] - Logging hyperparameters!
[2023-05-03 05:44:34,607][__main__][INFO] - Starting training!
[2023-05-03 05:45:37,383][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-03 05:45:37,395][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-03 05:45:37,513][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-03 05:45:37,518][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-03 05:45:38,336][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpwoa2b4pw
[2023-05-03 05:45:38,338][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpwoa2b4pw/_remote_module_non_sriptable.py
[2023-05-03 05:45:38,399][__main__][INFO] - Instantiating callbacks...
[2023-05-03 05:45:38,399][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-03 05:45:38,405][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-03 05:45:38,406][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-03 05:45:38,408][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-03 05:45:38,409][__main__][INFO] - Instantiating loggers...
[2023-05-03 05:45:38,409][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-03 05:45:56,183][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-03 05:45:56,238][__main__][INFO] - Logging hyperparameters!
[2023-05-03 05:45:56,248][__main__][INFO] - Starting training!
[2023-05-03 12:41:06,146][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-03 12:41:06,155][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-03 12:41:06,265][__main__][INFO] - Instantiating datamodule <src.data.clevr6_datamodule.CLEVR6DataModule>
[2023-05-03 12:41:06,271][__main__][INFO] - Instantiating model <src.models.slota_ae_module.LitSlotAttentionAutoEncoder>
[2023-05-03 12:41:07,022][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpulwfbsrb
[2023-05-03 12:41:07,022][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpulwfbsrb/_remote_module_non_sriptable.py
[2023-05-03 12:41:07,036][__main__][INFO] - Instantiating callbacks...
[2023-05-03 12:41:07,036][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-03 12:41:07,042][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-03 12:41:07,043][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-03 12:41:07,044][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-03 12:41:07,045][__main__][INFO] - Instantiating loggers...
[2023-05-03 12:41:07,045][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-03 12:41:25,079][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-03 12:41:25,141][__main__][INFO] - Logging hyperparameters!
[2023-05-03 12:41:25,151][__main__][INFO] - Starting training!
[2023-05-03 12:41:43,447][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_arbi_crop_slota_ark/2023-05-03_12-41-05_dgx_gpu3
[2023-05-03 12:41:43,448][src.utils.utils][INFO] - Closing loggers...
[2023-05-03 12:41:43,449][src.utils.utils][INFO] - Closing wandb!
[2023-05-03 12:44:28,014][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-03 12:44:28,025][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-03 12:44:28,143][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-03 12:44:28,149][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-03 12:44:28,856][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpfzmph48u
[2023-05-03 12:44:28,857][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpfzmph48u/_remote_module_non_sriptable.py
[2023-05-03 12:44:28,900][__main__][INFO] - Instantiating callbacks...
[2023-05-03 12:44:28,901][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-03 12:44:28,906][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-03 12:44:28,907][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-03 12:44:28,908][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-03 12:44:28,909][__main__][INFO] - Instantiating loggers...
[2023-05-03 12:44:28,910][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-03 12:44:46,942][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-03 12:44:47,001][__main__][INFO] - Logging hyperparameters!
[2023-05-03 12:44:47,015][__main__][INFO] - Starting training!
[2023-05-03 12:44:55,137][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 121, in advance
    batch = next(data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 184, in __next__
    return self.fetching_function()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 265, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 280, in _fetch_next_batch
    batch = next(iterator)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 530, in __next__
    data = self._next_data()
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1224, in _next_data
    return self._process_data(data)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1250, in _process_data
    data.reraise()
  File "/opt/conda/lib/python3.8/site-packages/torch/_utils.py", line 457, in reraise
    raise exception
TypeError: Caught TypeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 287, in _worker_loop
    data = fetcher.fetch(index)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/workspace/slotaug/src/data/components/clevr6_aug.py", line 60, in __getitem__
    insts_ori2aug, transform_ori, transform_aug = get_transforms(
  File "/workspace/slotaug/src/data/components/data_utils.py", line 68, in get_transforms
    d_aug = torch.randint(-d_max, d_max, (2,))
TypeError: randint() received an invalid combination of arguments - got (float, float, tuple), but expected one of:
 * (int high, tuple of ints size, *, torch.Generator generator, Tensor out, torch.dtype dtype, torch.layout layout, torch.device device, bool requires_grad)
 * (int low, int high, tuple of ints size, *, torch.Generator generator, Tensor out, torch.dtype dtype, torch.layout layout, torch.device device, bool requires_grad)


[2023-05-03 12:44:55,145][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stc_is_arbi_crop_v3_w1over100/2023-05-03_12-44-27_dgx_gpu3
[2023-05-03 12:44:55,145][src.utils.utils][INFO] - Closing loggers...
[2023-05-03 12:44:55,145][src.utils.utils][INFO] - Closing wandb!
[2023-05-03 12:48:25,122][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-03 12:48:25,132][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-03 12:48:25,243][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-03 12:48:25,250][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-03 12:48:26,016][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpdobvfnf_
[2023-05-03 12:48:26,016][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpdobvfnf_/_remote_module_non_sriptable.py
[2023-05-03 12:48:26,062][__main__][INFO] - Instantiating callbacks...
[2023-05-03 12:48:26,063][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-03 12:48:26,068][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-03 12:48:26,069][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-03 12:48:26,070][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-03 12:48:26,071][__main__][INFO] - Instantiating loggers...
[2023-05-03 12:48:26,072][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-03 12:48:44,242][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-03 12:48:44,313][__main__][INFO] - Logging hyperparameters!
[2023-05-03 12:48:44,331][__main__][INFO] - Starting training!
[2023-05-03 12:49:05,751][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stc_is_arbi_crop_v3_w1over100/2023-05-03_12-48-24_dgx_gpu3
[2023-05-03 12:49:05,752][src.utils.utils][INFO] - Closing loggers...
[2023-05-03 12:49:05,753][src.utils.utils][INFO] - Closing wandb!
[2023-05-03 15:00:19,543][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-03 15:00:19,553][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-03 15:00:19,668][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-03 15:00:19,675][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-03 15:00:20,429][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpi5rvstqr
[2023-05-03 15:00:20,429][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpi5rvstqr/_remote_module_non_sriptable.py
[2023-05-03 15:00:20,504][__main__][INFO] - Instantiating callbacks...
[2023-05-03 15:00:20,504][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-03 15:00:20,509][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-03 15:00:20,510][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-03 15:00:20,511][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-03 15:00:20,512][__main__][INFO] - Instantiating loggers...
[2023-05-03 15:00:20,513][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-03 15:00:39,021][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-03 15:00:39,093][__main__][INFO] - Logging hyperparameters!
[2023-05-03 15:00:39,105][__main__][INFO] - Starting training!
[2023-05-03 15:01:02,328][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1214, in _run_train
    self.fit_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 267, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 187, in advance
    batch = next(data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 184, in __next__
    return self.fetching_function()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 265, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 280, in _fetch_next_batch
    batch = next(iterator)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 569, in __next__
    return self.request_next_batch(self.loader_iters)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 581, in request_next_batch
    return apply_to_collection(loader_iters, Iterator, next)
  File "/opt/conda/lib/python3.8/site-packages/lightning_utilities/core/apply_func.py", line 51, in apply_to_collection
    return function(data, *args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 530, in __next__
    data = self._next_data()
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1204, in _next_data
    return self._process_data(data)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1250, in _process_data
    data.reraise()
  File "/opt/conda/lib/python3.8/site-packages/torch/_utils.py", line 457, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 3.
Original Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 287, in _worker_loop
    data = fetcher.fetch(index)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/workspace/slotaug/src/data/components/clevr6_aug.py", line 60, in __getitem__
    insts_ori2aug, transform_ori, transform_aug = get_transforms(
  File "/workspace/slotaug/src/data/components/data_utils.py", line 69, in get_transforms
    d_aug = torch.randint(-d_max, d_max, (2,))
RuntimeError: random_ expects 'from' to be less than 'to', but got from=0 >= to=0

[2023-05-03 15:01:02,333][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stc_is_arbi_crop_v3_w1over100/2023-05-03_15-00-19_dgx_gpu3
[2023-05-03 15:01:02,334][src.utils.utils][INFO] - Closing loggers...
[2023-05-03 15:01:02,334][src.utils.utils][INFO] - Closing wandb!
[2023-05-03 15:04:02,532][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-03 15:04:02,541][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-03 15:04:02,651][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-03 15:04:02,657][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-03 15:04:03,357][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp6m0wrqr0
[2023-05-03 15:04:03,358][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp6m0wrqr0/_remote_module_non_sriptable.py
[2023-05-03 15:04:03,400][__main__][INFO] - Instantiating callbacks...
[2023-05-03 15:04:03,401][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-03 15:04:03,405][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-03 15:04:03,406][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-03 15:04:03,407][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-03 15:04:03,408][__main__][INFO] - Instantiating loggers...
[2023-05-03 15:04:03,409][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-03 15:04:21,361][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-03 15:04:21,433][__main__][INFO] - Logging hyperparameters!
[2023-05-03 15:04:21,445][__main__][INFO] - Starting training!
[2023-05-03 15:04:46,409][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stc_is_arbi_crop_v3_w1over100/2023-05-03_15-04-02_dgx_gpu3
[2023-05-03 15:04:46,411][src.utils.utils][INFO] - Closing loggers...
[2023-05-03 15:04:46,411][src.utils.utils][INFO] - Closing wandb!
[2023-05-03 15:05:07,358][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-03 15:05:07,369][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-03 15:05:07,492][__main__][INFO] - Instantiating datamodule <src.data.clevr6_datamodule.CLEVR6DataModule>
[2023-05-03 15:05:07,497][__main__][INFO] - Instantiating model <src.models.slota_ae_module.LitSlotAttentionAutoEncoder>
[2023-05-03 15:05:08,194][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpu7a77ht3
[2023-05-03 15:05:08,195][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpu7a77ht3/_remote_module_non_sriptable.py
[2023-05-03 15:05:08,207][__main__][INFO] - Instantiating callbacks...
[2023-05-03 15:05:08,207][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-03 15:05:08,212][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-03 15:05:08,213][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-03 15:05:08,214][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-03 15:05:08,215][__main__][INFO] - Instantiating loggers...
[2023-05-03 15:05:08,215][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-03 15:05:26,345][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-03 15:05:26,417][__main__][INFO] - Logging hyperparameters!
[2023-05-03 15:05:26,430][__main__][INFO] - Starting training!
[2023-05-03 15:18:17,166][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_arbi_crop_slota_ark/2023-05-03_15-05-07_dgx_gpu3
[2023-05-03 15:18:17,167][src.utils.utils][INFO] - Closing loggers...
[2023-05-03 15:18:17,167][src.utils.utils][INFO] - Closing wandb!
[2023-05-03 15:56:08,893][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-03 15:56:08,903][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-03 15:56:09,019][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-03 15:56:09,027][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-03 15:56:09,736][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpn92t557e
[2023-05-03 15:56:09,737][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpn92t557e/_remote_module_non_sriptable.py
[2023-05-03 15:56:09,774][__main__][INFO] - Instantiating callbacks...
[2023-05-03 15:56:09,775][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-03 15:56:09,779][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-03 15:56:09,780][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-03 15:56:09,781][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-03 15:56:09,783][__main__][INFO] - Instantiating loggers...
[2023-05-03 15:56:09,783][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-03 15:56:27,679][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-03 15:56:27,741][__main__][INFO] - Logging hyperparameters!
[2023-05-03 15:56:27,753][__main__][INFO] - Starting training!
[2023-05-03 15:56:41,123][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 205, in validation_step
    loss, outputs = self._shared_eval_step(batch, batch_idx)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 167, in _shared_eval_step
    model_step_outputs = self.model_step(batch)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 108, in model_step
    outputs = self.forward(img_ori, img_aug, insts_ori2aug, insts_aug2ori)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 99, in forward
    outputs = self.net(img_ori, img_aug, insts_ori2aug, insts_aug2ori)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug/slotaug_ae.py", line 80, in forward
    slotaug_outputs = self.slotaug(inputs_ori=x, inputs_aug=x_aug, insts_ori=insts_ori2aug, insts_aug=insts_aug2ori)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
TypeError: forward() got an unexpected keyword argument 'insts_ori'
[2023-05-03 15:56:41,128][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcfr_arbi_crop_cae2_v4_wope_w1over100/2023-05-03_15-56-08_dgx_gpu3
[2023-05-03 15:56:41,129][src.utils.utils][INFO] - Closing loggers...
[2023-05-03 15:56:41,129][src.utils.utils][INFO] - Closing wandb!
[2023-05-03 15:58:32,855][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-03 15:58:32,866][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-03 15:58:32,979][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-03 15:58:32,983][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-03 15:58:33,724][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmppfg48xq6
[2023-05-03 15:58:33,724][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmppfg48xq6/_remote_module_non_sriptable.py
[2023-05-03 15:58:33,764][__main__][INFO] - Instantiating callbacks...
[2023-05-03 15:58:33,765][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-03 15:58:33,769][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-03 15:58:33,770][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-03 15:58:33,772][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-03 15:58:33,773][__main__][INFO] - Instantiating loggers...
[2023-05-03 15:58:33,773][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-03 15:58:51,772][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-03 15:58:51,830][__main__][INFO] - Logging hyperparameters!
[2023-05-03 15:58:51,841][__main__][INFO] - Starting training!
[2023-05-03 15:59:04,958][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 205, in validation_step
    loss, outputs = self._shared_eval_step(batch, batch_idx)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 167, in _shared_eval_step
    model_step_outputs = self.model_step(batch)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 108, in model_step
    outputs = self.forward(img_ori, img_aug, insts_ori2aug, insts_aug2ori)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 99, in forward
    outputs = self.net(img_ori, img_aug, insts_ori2aug, insts_aug2ori)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug/slotaug_ae.py", line 80, in forward
    slotaug_outputs = self.slotaug(inputs_ori=x, inputs_aug=x_aug, insts_ori2aug=insts_ori2aug, insts_aug2ori=insts_aug2ori)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug/slotaug.py", line 170, in forward
    slots_ori = outputs["slots_ori"]
KeyError: 'slots_ori'
[2023-05-03 15:59:04,963][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcfr_arbi_crop_cae2_v4_wope_w1over100/2023-05-03_15-58-32_dgx_gpu3
[2023-05-03 15:59:04,964][src.utils.utils][INFO] - Closing loggers...
[2023-05-03 15:59:04,964][src.utils.utils][INFO] - Closing wandb!
[2023-05-03 16:00:10,849][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-03 16:00:10,858][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-03 16:00:10,970][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-03 16:00:10,974][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-03 16:00:11,703][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmplxnes7vb
[2023-05-03 16:00:11,703][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmplxnes7vb/_remote_module_non_sriptable.py
[2023-05-03 16:00:11,754][__main__][INFO] - Instantiating callbacks...
[2023-05-03 16:00:11,755][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-03 16:00:11,760][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-03 16:00:11,761][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-03 16:00:11,762][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-03 16:00:11,763][__main__][INFO] - Instantiating loggers...
[2023-05-03 16:00:11,763][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-03 16:00:29,629][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-03 16:00:29,701][__main__][INFO] - Logging hyperparameters!
[2023-05-03 16:00:29,715][__main__][INFO] - Starting training!
[2023-05-03 16:00:42,749][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 214, in validation_step
    recon_combined=outputs["recon_combined"][vis_idx].unsqueeze(0),
KeyError: 'recon_combined'
[2023-05-03 16:00:42,754][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcfr_arbi_crop_cae2_v4_wope_w1over100/2023-05-03_16-00-10_dgx_gpu3
[2023-05-03 16:00:42,754][src.utils.utils][INFO] - Closing loggers...
[2023-05-03 16:00:42,754][src.utils.utils][INFO] - Closing wandb!
[2023-05-03 16:01:08,852][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-03 16:01:08,861][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-03 16:01:08,980][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-03 16:01:08,984][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-03 16:01:09,718][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp0ajhjxq6
[2023-05-03 16:01:09,719][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp0ajhjxq6/_remote_module_non_sriptable.py
[2023-05-03 16:01:09,769][__main__][INFO] - Instantiating callbacks...
[2023-05-03 16:01:09,770][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-03 16:01:09,775][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-03 16:01:09,777][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-03 16:01:09,778][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-03 16:01:09,779][__main__][INFO] - Instantiating loggers...
[2023-05-03 16:01:09,779][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-03 16:01:27,750][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-03 16:01:27,807][__main__][INFO] - Logging hyperparameters!
[2023-05-03 16:01:27,818][__main__][INFO] - Starting training!
[2023-05-03 16:01:40,927][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 226, in validation_step
    gt_masks=batch["masks_ori2aug"][vis_idx].unsqueeze(0),
KeyError: 'masks_ori2aug'
[2023-05-03 16:01:40,932][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcfr_arbi_crop_cae2_v4_wope_w1over100/2023-05-03_16-01-08_dgx_gpu3
[2023-05-03 16:01:40,932][src.utils.utils][INFO] - Closing loggers...
[2023-05-03 16:01:40,932][src.utils.utils][INFO] - Closing wandb!
[2023-05-03 16:02:45,948][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-03 16:02:45,958][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-03 16:02:46,081][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-03 16:02:46,085][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-03 16:02:46,888][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpeez964as
[2023-05-03 16:02:46,889][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpeez964as/_remote_module_non_sriptable.py
[2023-05-03 16:02:46,941][__main__][INFO] - Instantiating callbacks...
[2023-05-03 16:02:46,941][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-03 16:02:46,946][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-03 16:02:46,947][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-03 16:02:46,948][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-03 16:02:46,948][__main__][INFO] - Instantiating loggers...
[2023-05-03 16:02:46,949][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-03 16:03:04,904][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-03 16:03:04,958][__main__][INFO] - Logging hyperparameters!
[2023-05-03 16:03:04,968][__main__][INFO] - Starting training!
[2023-05-03 16:03:30,801][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcfr_arbi_crop_cae2_v4_wope_w1over100/2023-05-03_16-02-45_dgx_gpu3
[2023-05-03 16:03:30,802][src.utils.utils][INFO] - Closing loggers...
[2023-05-03 16:03:30,802][src.utils.utils][INFO] - Closing wandb!
[2023-05-03 16:59:24,760][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-03 16:59:24,773][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-03 16:59:24,885][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-03 16:59:24,892][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-03 16:59:25,668][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpaj_g3wxh
[2023-05-03 16:59:25,669][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpaj_g3wxh/_remote_module_non_sriptable.py
[2023-05-03 16:59:25,719][__main__][INFO] - Instantiating callbacks...
[2023-05-03 16:59:25,719][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-03 16:59:25,724][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-03 16:59:25,725][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-03 16:59:25,727][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-03 16:59:25,728][__main__][INFO] - Instantiating loggers...
[2023-05-03 16:59:25,728][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-03 16:59:43,896][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-03 16:59:43,955][__main__][INFO] - Logging hyperparameters!
[2023-05-03 16:59:43,967][__main__][INFO] - Starting training!
[2023-05-03 17:00:17,925][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stc_arbi_crop_v4_wope_w1over100/2023-05-03_16-59-24_dgx_gpu3
[2023-05-03 17:00:17,926][src.utils.utils][INFO] - Closing loggers...
[2023-05-03 17:00:17,926][src.utils.utils][INFO] - Closing wandb!
[2023-05-03 17:13:02,503][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stc_is_v3/2023-05-02_16-48-17_dgx_gpu4
[2023-05-03 17:13:02,504][src.utils.utils][INFO] - Closing loggers...
[2023-05-03 17:13:02,505][src.utils.utils][INFO] - Closing wandb!
[2023-05-03 17:13:30,640][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-03 17:13:30,649][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-03 17:13:30,761][__main__][INFO] - Instantiating datamodule <src.data.clevr6_datamodule.CLEVR6DataModule>
[2023-05-03 17:13:30,766][__main__][INFO] - Instantiating model <src.models.slota_ae_module.LitSlotAttentionAutoEncoder>
[2023-05-03 17:13:31,564][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpsymqx4s7
[2023-05-03 17:13:31,565][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpsymqx4s7/_remote_module_non_sriptable.py
[2023-05-03 17:13:31,582][__main__][INFO] - Instantiating callbacks...
[2023-05-03 17:13:31,583][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-03 17:13:31,590][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-03 17:13:31,591][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-03 17:13:31,593][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-03 17:13:31,594][__main__][INFO] - Instantiating loggers...
[2023-05-03 17:13:31,594][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-03 17:13:49,658][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-03 17:13:49,721][__main__][INFO] - Logging hyperparameters!
[2023-05-03 17:13:49,732][__main__][INFO] - Starting training!
[2023-05-03 17:14:39,532][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_arbi_crop_slota_ark/2023-05-03_17-13-30_dgx_gpu4
[2023-05-03 17:14:39,533][src.utils.utils][INFO] - Closing loggers...
[2023-05-03 17:14:39,533][src.utils.utils][INFO] - Closing wandb!
[2023-05-03 17:15:54,207][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_is_v2/2023-05-02_11-03-18_dgx_gpu7
[2023-05-03 17:15:54,208][src.utils.utils][INFO] - Closing loggers...
[2023-05-03 17:15:54,208][src.utils.utils][INFO] - Closing wandb!
[2023-05-03 17:16:40,108][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-03 17:16:40,116][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-03 17:16:40,219][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-03 17:16:40,223][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-03 17:16:40,962][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp1lv73g_s
[2023-05-03 17:16:40,963][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp1lv73g_s/_remote_module_non_sriptable.py
[2023-05-03 17:16:41,003][__main__][INFO] - Instantiating callbacks...
[2023-05-03 17:16:41,003][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-03 17:16:41,009][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-03 17:16:41,010][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-03 17:16:41,011][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-03 17:16:41,012][__main__][INFO] - Instantiating loggers...
[2023-05-03 17:16:41,013][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-03 17:16:58,737][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-03 17:16:58,789][__main__][INFO] - Logging hyperparameters!
[2023-05-03 17:16:58,799][__main__][INFO] - Starting training!
[2023-05-03 17:19:36,677][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-03 17:19:36,686][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-03 17:19:36,795][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-03 17:19:36,798][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-03 17:19:37,535][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpn3r0s0n1
[2023-05-03 17:19:37,536][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpn3r0s0n1/_remote_module_non_sriptable.py
[2023-05-03 17:19:37,572][__main__][INFO] - Instantiating callbacks...
[2023-05-03 17:19:37,572][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-03 17:19:37,577][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-03 17:19:37,578][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-03 17:19:37,579][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-03 17:19:37,580][__main__][INFO] - Instantiating loggers...
[2023-05-03 17:19:37,580][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-03 17:19:43,837][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stc_is_v3_w1over100/2023-05-03_05-44-15_dgx_gpu5
[2023-05-03 17:19:43,838][src.utils.utils][INFO] - Closing loggers...
[2023-05-03 17:19:43,838][src.utils.utils][INFO] - Closing wandb!
[2023-05-03 17:19:55,392][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-03 17:19:55,448][__main__][INFO] - Logging hyperparameters!
[2023-05-03 17:19:55,458][__main__][INFO] - Starting training!
[2023-05-03 17:20:17,909][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcf_is_v3_1over100/2023-05-03_05-45-37_dgx_gpu6
[2023-05-03 17:20:17,910][src.utils.utils][INFO] - Closing loggers...
[2023-05-03 17:20:17,911][src.utils.utils][INFO] - Closing wandb!
[2023-05-03 17:20:23,892][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-03 17:20:23,901][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-03 17:20:24,007][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-03 17:20:24,011][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-03 17:20:24,726][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpw217j5tx
[2023-05-03 17:20:24,726][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpw217j5tx/_remote_module_non_sriptable.py
[2023-05-03 17:20:24,778][__main__][INFO] - Instantiating callbacks...
[2023-05-03 17:20:24,779][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-03 17:20:24,783][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-03 17:20:24,784][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-03 17:20:24,785][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-03 17:20:24,786][__main__][INFO] - Instantiating loggers...
[2023-05-03 17:20:24,787][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-03 17:20:35,049][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-03 17:20:35,058][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-03 17:20:35,163][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-03 17:20:35,166][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-03 17:20:35,874][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp1gck2j9p
[2023-05-03 17:20:35,874][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp1gck2j9p/_remote_module_non_sriptable.py
[2023-05-03 17:20:35,911][__main__][INFO] - Instantiating callbacks...
[2023-05-03 17:20:35,911][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-03 17:20:35,915][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-03 17:20:35,916][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-03 17:20:35,917][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-03 17:20:35,918][__main__][INFO] - Instantiating loggers...
[2023-05-03 17:20:35,919][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-03 17:20:42,656][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-03 17:20:42,707][__main__][INFO] - Logging hyperparameters!
[2023-05-03 17:20:42,717][__main__][INFO] - Starting training!
[2023-05-03 17:20:54,074][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-03 17:20:54,133][__main__][INFO] - Logging hyperparameters!
[2023-05-03 17:20:54,144][__main__][INFO] - Starting training!
[2023-05-04 08:24:52,232][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-04 08:24:52,242][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-04 08:24:52,358][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-04 08:24:52,362][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-04 08:24:53,063][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpoz4dybjk
[2023-05-04 08:24:53,064][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpoz4dybjk/_remote_module_non_sriptable.py
[2023-05-04 08:24:53,113][__main__][INFO] - Instantiating callbacks...
[2023-05-04 08:24:53,114][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-04 08:24:53,119][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-04 08:24:53,120][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-04 08:24:53,121][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-04 08:24:53,122][__main__][INFO] - Instantiating loggers...
[2023-05-04 08:24:53,122][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-04 08:25:11,133][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-04 08:25:11,191][__main__][INFO] - Logging hyperparameters!
[2023-05-04 08:25:11,203][__main__][INFO] - Starting training!
[2023-05-04 08:25:32,151][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcfr_arbi_crop_dcae2_v1_wope/2023-05-04_08-24-52_dgx_gpu3
[2023-05-04 08:25:32,152][src.utils.utils][INFO] - Closing loggers...
[2023-05-04 08:25:32,152][src.utils.utils][INFO] - Closing wandb!
[2023-05-04 08:28:28,300][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-04 08:28:28,309][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-04 08:28:28,422][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-04 08:28:28,426][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-04 08:28:29,150][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpogckcfop
[2023-05-04 08:28:29,150][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpogckcfop/_remote_module_non_sriptable.py
[2023-05-04 08:28:29,189][__main__][INFO] - Instantiating callbacks...
[2023-05-04 08:28:29,190][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-04 08:28:29,195][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-04 08:28:29,196][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-04 08:28:29,197][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-04 08:28:29,198][__main__][INFO] - Instantiating loggers...
[2023-05-04 08:28:29,198][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-04 08:28:47,272][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-04 08:28:47,328][__main__][INFO] - Logging hyperparameters!
[2023-05-04 08:28:47,340][__main__][INFO] - Starting training!
[2023-05-04 08:29:00,988][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 180, in validation_step
    loss, outputs = self._shared_eval_step(batch, batch_idx)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 151, in _shared_eval_step
    model_step_outputs = self.model_step(batch)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 102, in model_step
    outputs = self.forward(img_ori, img_aug, insts_ori2aug, insts_aug2ori)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 93, in forward
    outputs = self.net(img_ori, img_aug, insts_ori2aug, insts_aug2ori)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug/slotaug_ae.py", line 80, in forward
    slotaug_outputs = self.slotaug(inputs=x, insts=insts_ori2aug)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug/slotaug.py", line 194, in forward
    slots_aug = self.apply_insts(
  File "/workspace/slotaug/src/models/components/slotaug/slotaug.py", line 93, in apply_insts
    slots[..., self.pos_enc_dim:] = slots[..., self.pos_enc_dim:] + self.intrinsic_encoder(torch.cat([slots, intrinsic_insts], dim=-1)) # in_dim: D_slot + 11 / out_dim: D_slot
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/slotaug/src/models/components/slotaug/slotaug_utils.py", line 292, in forward
    return self.mlp(x)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/container.py", line 141, in forward
    input = module(input)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/linear.py", line 103, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (448x71 and 55x48)
[2023-05-04 08:29:00,995][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcfr_arbi_crop_dcae2_v1_wope/2023-05-04_08-28-28_dgx_gpu3
[2023-05-04 08:29:00,995][src.utils.utils][INFO] - Closing loggers...
[2023-05-04 08:29:00,995][src.utils.utils][INFO] - Closing wandb!
[2023-05-04 08:29:45,533][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-04 08:29:45,543][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-04 08:29:45,655][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-04 08:29:45,659][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-04 08:29:46,410][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpxr6_bmxx
[2023-05-04 08:29:46,410][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpxr6_bmxx/_remote_module_non_sriptable.py
[2023-05-04 08:29:46,459][__main__][INFO] - Instantiating callbacks...
[2023-05-04 08:29:46,459][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-04 08:29:46,464][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-04 08:29:46,465][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-04 08:29:46,466][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-04 08:29:46,467][__main__][INFO] - Instantiating loggers...
[2023-05-04 08:29:46,468][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-04 08:30:04,280][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-04 08:30:04,337][__main__][INFO] - Logging hyperparameters!
[2023-05-04 08:30:04,348][__main__][INFO] - Starting training!
[2023-05-04 08:31:07,836][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcfr_arbi_crop_dcae2_v1_wope/2023-05-04_08-29-45_dgx_gpu3
[2023-05-04 08:31:07,837][src.utils.utils][INFO] - Closing loggers...
[2023-05-04 08:31:07,837][src.utils.utils][INFO] - Closing wandb!
[2023-05-04 10:51:28,270][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcfr_arbi_crop_cae1_v4_wope_w1over100/2023-05-03_17-16-39_dgx_gpu7
[2023-05-04 10:51:28,271][src.utils.utils][INFO] - Closing loggers...
[2023-05-04 10:51:28,272][src.utils.utils][INFO] - Closing wandb!
[2023-05-04 10:52:43,843][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-04 10:52:43,853][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-04 10:52:43,961][__main__][INFO] - Instantiating datamodule <src.data.clevr6_datamodule.CLEVR6DataModule>
[2023-05-04 10:52:43,965][__main__][INFO] - Instantiating model <src.models.slota_ae_module.LitSlotAttentionAutoEncoder>
[2023-05-04 10:52:44,790][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp0q_kud3h
[2023-05-04 10:52:44,791][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp0q_kud3h/_remote_module_non_sriptable.py
[2023-05-04 10:52:44,804][__main__][INFO] - Instantiating callbacks...
[2023-05-04 10:52:44,804][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-04 10:52:44,809][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-04 10:52:44,810][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-04 10:52:44,812][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-04 10:52:44,813][__main__][INFO] - Instantiating loggers...
[2023-05-04 10:52:44,813][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-04 10:53:02,872][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-04 10:53:02,927][__main__][INFO] - Logging hyperparameters!
[2023-05-04 10:53:02,937][__main__][INFO] - Starting training!
[2023-05-04 11:21:28,476][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-04 11:21:28,486][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-04 11:21:28,597][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-04 11:21:28,600][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-04 11:21:29,327][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/utils.py", line 644, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.models.components.slotaug' has no attribute 'slotaug_ae'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
  File "/opt/conda/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 839, in exec_module
  File "<frozen importlib._bootstrap_external>", line 976, in get_code
  File "<frozen importlib._bootstrap_external>", line 906, in source_to_code
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/workspace/slotaug/src/models/components/slotaug/slotaug_ae.py", line 113
    <<<<<<< HEAD
    ^
SyntaxError: invalid syntax

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/utils.py", line 658, in _locate
    raise ImportError(
ImportError: Error loading 'src.models.components.slotaug.slotaug_ae.SlotAugAutoEncoder':
SyntaxError('invalid syntax', ('/workspace/slotaug/src/models/components/slotaug/slotaug_ae.py', 113, 1, '<<<<<<< HEAD\n'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 56, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.models.components.slotaug.slotaug_ae.SlotAugAutoEncoder', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: model.net
[2023-05-04 11:21:29,329][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcfr_arbi_crop_dis1_cae2_v4_wope/2023-05-04_11-21-28_dgx_gpu3
[2023-05-04 11:21:29,330][src.utils.utils][INFO] - Closing loggers...
[2023-05-04 11:22:03,615][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-04 11:22:03,624][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-04 11:22:03,737][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-04 11:22:03,741][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-04 11:22:04,465][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpfvy9uqw5
[2023-05-04 11:22:04,465][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpfvy9uqw5/_remote_module_non_sriptable.py
[2023-05-04 11:22:04,538][__main__][INFO] - Instantiating callbacks...
[2023-05-04 11:22:04,539][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-04 11:22:04,544][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-04 11:22:04,545][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-04 11:22:04,546][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-04 11:22:04,547][__main__][INFO] - Instantiating loggers...
[2023-05-04 11:22:04,547][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-04 11:22:22,356][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-04 11:22:22,426][__main__][INFO] - Logging hyperparameters!
[2023-05-04 11:22:22,438][__main__][INFO] - Starting training!
[2023-05-04 11:22:45,310][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcfr_arbi_crop_dis1_cae2_v4_wope/2023-05-04_11-22-03_dgx_gpu3
[2023-05-04 11:22:45,311][src.utils.utils][INFO] - Closing loggers...
[2023-05-04 11:22:45,312][src.utils.utils][INFO] - Closing wandb!
[2023-05-04 11:24:58,441][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_arbi_crop_slota_ark/2023-05-04_10-52-43_dgx_gpu7
[2023-05-04 11:24:58,443][src.utils.utils][INFO] - Closing loggers...
[2023-05-04 11:24:58,443][src.utils.utils][INFO] - Closing wandb!
[2023-05-04 11:25:10,237][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-04 11:25:10,246][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-04 11:25:10,356][__main__][INFO] - Instantiating datamodule <src.data.clevr6_datamodule.CLEVR6DataModule>
[2023-05-04 11:25:10,361][__main__][INFO] - Instantiating model <src.models.slota_ae_module.LitSlotAttentionAutoEncoder>
[2023-05-04 11:25:11,115][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpvo1nrwqy
[2023-05-04 11:25:11,116][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpvo1nrwqy/_remote_module_non_sriptable.py
[2023-05-04 11:25:11,128][__main__][INFO] - Instantiating callbacks...
[2023-05-04 11:25:11,129][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-04 11:25:11,134][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-04 11:25:11,135][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-04 11:25:11,136][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-04 11:25:11,137][__main__][INFO] - Instantiating loggers...
[2023-05-04 11:25:11,137][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-04 11:25:29,117][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-04 11:25:29,174][__main__][INFO] - Logging hyperparameters!
[2023-05-04 11:25:29,183][__main__][INFO] - Starting training!
[2023-05-04 11:25:36,933][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-04 11:25:36,943][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-04 11:25:37,070][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-04 11:25:37,075][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-04 11:25:37,836][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpeougvmnc
[2023-05-04 11:25:37,836][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpeougvmnc/_remote_module_non_sriptable.py
[2023-05-04 11:25:37,910][__main__][INFO] - Instantiating callbacks...
[2023-05-04 11:25:37,910][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-04 11:25:37,915][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-04 11:25:37,916][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-04 11:25:37,917][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-04 11:25:37,918][__main__][INFO] - Instantiating loggers...
[2023-05-04 11:25:37,919][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-04 11:25:55,951][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-04 11:25:56,015][__main__][INFO] - Logging hyperparameters!
[2023-05-04 11:25:56,033][__main__][INFO] - Starting training!
[2023-05-04 11:26:45,391][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcfr_arbi_crop_dis2_cae2_v4_wope/2023-05-04_11-25-36_dgx_gpu3
[2023-05-04 11:26:45,392][src.utils.utils][INFO] - Closing loggers...
[2023-05-04 11:26:45,392][src.utils.utils][INFO] - Closing wandb!
[2023-05-04 11:27:07,683][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-05-04 16:55:40,517][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-04 16:55:40,526][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-04 16:55:40,637][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-04 16:55:40,640][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-04 16:55:41,250][matplotlib.font_manager][INFO] - generated new fontManager
[2023-05-04 16:55:41,693][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp5ugyyqmf
[2023-05-04 16:55:41,693][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp5ugyyqmf/_remote_module_non_sriptable.py
[2023-05-04 16:55:41,769][__main__][INFO] - Instantiating callbacks...
[2023-05-04 16:55:41,770][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-04 16:55:41,776][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-04 16:55:41,778][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-04 16:55:41,779][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-04 16:55:41,781][__main__][INFO] - Instantiating loggers...
[2023-05-04 16:55:41,781][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-04 16:56:13,181][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-04 16:56:13,191][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-04 16:56:13,307][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-04 16:56:13,311][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-04 16:56:13,941][matplotlib.font_manager][INFO] - generated new fontManager
[2023-05-04 16:56:14,387][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpackcjwpc
[2023-05-04 16:56:14,387][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpackcjwpc/_remote_module_non_sriptable.py
[2023-05-04 16:56:14,431][__main__][INFO] - Instantiating callbacks...
[2023-05-04 16:56:14,432][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-04 16:56:14,436][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-04 16:56:14,437][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-04 16:56:14,439][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-04 16:56:14,440][__main__][INFO] - Instantiating loggers...
[2023-05-04 16:56:14,440][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-04 16:56:39,668][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-04 16:56:39,752][__main__][INFO] - Logging hyperparameters!
[2023-05-04 16:56:39,764][__main__][INFO] - Starting training!
[2023-05-04 16:56:52,125][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-04 16:56:52,199][__main__][INFO] - Logging hyperparameters!
[2023-05-04 16:56:52,218][__main__][INFO] - Starting training!
[2023-05-04 16:58:36,953][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcfr_arbi_crop_v3_wope/2023-05-04_16-55-40_dgx_gpu0
[2023-05-04 16:58:36,956][src.utils.utils][INFO] - Closing loggers...
[2023-05-04 16:58:36,956][src.utils.utils][INFO] - Closing wandb!
[2023-05-04 16:58:37,696][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcfr_arbi_crop_v2_wope/2023-05-04_16-56-12_dgx_gpu1
[2023-05-04 16:58:37,697][src.utils.utils][INFO] - Closing loggers...
[2023-05-04 16:58:37,697][src.utils.utils][INFO] - Closing wandb!
[2023-05-04 16:59:12,028][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-04 16:59:12,040][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-04 16:59:12,162][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-04 16:59:12,166][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-04 16:59:12,873][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpkh5p__s4
[2023-05-04 16:59:12,874][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpkh5p__s4/_remote_module_non_sriptable.py
[2023-05-04 16:59:12,938][__main__][INFO] - Instantiating callbacks...
[2023-05-04 16:59:12,938][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-04 16:59:12,943][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-04 16:59:12,944][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-04 16:59:12,945][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-04 16:59:12,946][__main__][INFO] - Instantiating loggers...
[2023-05-04 16:59:12,947][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-04 16:59:30,735][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-04 16:59:30,796][__main__][INFO] - Logging hyperparameters!
[2023-05-04 16:59:30,809][__main__][INFO] - Starting training!
[2023-05-04 16:59:33,075][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-04 16:59:33,084][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-04 16:59:33,200][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-04 16:59:33,204][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-04 16:59:34,057][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpz782o1uj
[2023-05-04 16:59:34,058][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpz782o1uj/_remote_module_non_sriptable.py
[2023-05-04 16:59:34,101][__main__][INFO] - Instantiating callbacks...
[2023-05-04 16:59:34,101][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-04 16:59:34,106][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-04 16:59:34,107][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-04 16:59:34,108][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-04 16:59:34,109][__main__][INFO] - Instantiating loggers...
[2023-05-04 16:59:34,110][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-04 16:59:52,099][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-04 16:59:52,173][__main__][INFO] - Logging hyperparameters!
[2023-05-04 16:59:52,185][__main__][INFO] - Starting training!
[2023-05-04 17:00:30,862][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-04 17:00:30,871][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-04 17:00:30,995][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-04 17:00:30,999][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-04 17:00:31,717][matplotlib.font_manager][INFO] - generated new fontManager
[2023-05-04 17:00:32,185][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpd121a0j_
[2023-05-04 17:00:32,186][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpd121a0j_/_remote_module_non_sriptable.py
[2023-05-04 17:00:32,244][__main__][INFO] - Instantiating callbacks...
[2023-05-04 17:00:32,245][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-04 17:00:32,250][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-04 17:00:32,251][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-04 17:00:32,252][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-04 17:00:32,253][__main__][INFO] - Instantiating loggers...
[2023-05-04 17:00:32,253][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-04 17:02:02,862][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-04 17:02:02,947][__main__][INFO] - Logging hyperparameters!
[2023-05-04 17:02:02,965][__main__][INFO] - Starting training!
[2023-05-04 17:02:36,430][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-04 17:02:36,441][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-04 17:02:36,569][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-04 17:02:36,573][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-04 17:02:37,422][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpt70hdct0
[2023-05-04 17:02:37,423][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpt70hdct0/_remote_module_non_sriptable.py
[2023-05-04 17:02:37,502][__main__][INFO] - Instantiating callbacks...
[2023-05-04 17:02:37,502][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-04 17:02:37,507][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-04 17:02:37,508][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-04 17:02:37,510][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-04 17:02:37,510][__main__][INFO] - Instantiating loggers...
[2023-05-04 17:02:37,511][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-04 17:03:04,077][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-04 17:03:04,172][__main__][INFO] - Logging hyperparameters!
[2023-05-04 17:03:04,186][__main__][INFO] - Starting training!
[2023-05-04 18:39:15,408][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcfr_arbi_crop_v4_wope/2023-05-04_17-02-36_dgx_gpu3
[2023-05-04 18:39:15,410][src.utils.utils][INFO] - Closing loggers...
[2023-05-04 18:39:15,410][src.utils.utils][INFO] - Closing wandb!
[2023-05-04 18:39:26,161][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-04 18:39:26,171][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-04 18:39:26,304][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-04 18:39:26,309][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-04 18:39:27,199][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp2ji5_0ty
[2023-05-04 18:39:27,200][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp2ji5_0ty/_remote_module_non_sriptable.py
[2023-05-04 18:39:27,286][__main__][INFO] - Instantiating callbacks...
[2023-05-04 18:39:27,286][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-04 18:39:27,291][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-04 18:39:27,292][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-04 18:39:27,293][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-04 18:39:27,294][__main__][INFO] - Instantiating loggers...
[2023-05-04 18:39:27,295][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-04 18:39:46,515][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-04 18:39:46,591][__main__][INFO] - Logging hyperparameters!
[2023-05-04 18:39:46,604][__main__][INFO] - Starting training!
[2023-05-04 18:55:37,481][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stc_arbi_crop_dis_v3_wope/2023-05-04_16-59-11_dgx_gpu0
[2023-05-04 18:55:37,482][src.utils.utils][INFO] - Closing loggers...
[2023-05-04 18:55:37,483][src.utils.utils][INFO] - Closing wandb!
[2023-05-04 18:55:47,816][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-04 18:55:47,827][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-04 18:55:47,953][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-04 18:55:47,957][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-04 18:55:48,769][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpq0piwjtd
[2023-05-04 18:55:48,770][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpq0piwjtd/_remote_module_non_sriptable.py
[2023-05-04 18:55:48,814][__main__][INFO] - Instantiating callbacks...
[2023-05-04 18:55:48,815][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-04 18:55:48,820][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-04 18:55:48,821][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-04 18:55:48,822][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-04 18:55:48,823][__main__][INFO] - Instantiating loggers...
[2023-05-04 18:55:48,823][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-04 18:55:58,588][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcfr_arbi_crop_dis_v2_wope/2023-05-04_16-59-32_dgx_gpu1
[2023-05-04 18:55:58,589][src.utils.utils][INFO] - Closing loggers...
[2023-05-04 18:55:58,589][src.utils.utils][INFO] - Closing wandb!
[2023-05-04 18:56:06,868][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-04 18:56:06,926][__main__][INFO] - Logging hyperparameters!
[2023-05-04 18:56:06,939][__main__][INFO] - Starting training!
[2023-05-04 18:56:09,306][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-04 18:56:09,317][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-04 18:56:09,443][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-04 18:56:09,447][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-04 18:56:10,293][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpoo6unor4
[2023-05-04 18:56:10,294][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpoo6unor4/_remote_module_non_sriptable.py
[2023-05-04 18:56:10,349][__main__][INFO] - Instantiating callbacks...
[2023-05-04 18:56:10,350][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-04 18:56:10,356][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-04 18:56:10,357][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-04 18:56:10,358][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-04 18:56:10,359][__main__][INFO] - Instantiating loggers...
[2023-05-04 18:56:10,359][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-04 18:56:28,532][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-04 18:56:28,613][__main__][INFO] - Logging hyperparameters!
[2023-05-04 18:56:28,629][__main__][INFO] - Starting training!
[2023-05-04 18:56:35,773][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcfr_arbi_crop_dis_v1_wope/2023-05-04_17-00-30_dgx_gpu2
[2023-05-04 18:56:35,774][src.utils.utils][INFO] - Closing loggers...
[2023-05-04 18:56:35,774][src.utils.utils][INFO] - Closing wandb!
[2023-05-04 18:56:45,392][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-04 18:56:45,402][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-04 18:56:45,531][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-04 18:56:45,535][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-04 18:56:46,301][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpmiy3n3f1
[2023-05-04 18:56:46,302][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpmiy3n3f1/_remote_module_non_sriptable.py
[2023-05-04 18:56:46,373][__main__][INFO] - Instantiating callbacks...
[2023-05-04 18:56:46,374][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-04 18:56:46,379][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-04 18:56:46,380][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-04 18:56:46,381][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-04 18:56:46,382][__main__][INFO] - Instantiating loggers...
[2023-05-04 18:56:46,382][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-04 18:57:04,602][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-04 18:57:04,686][__main__][INFO] - Logging hyperparameters!
[2023-05-04 18:57:04,705][__main__][INFO] - Starting training!
[2023-05-04 23:01:03,146][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/slotaug/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1214, in _run_train
    self.fit_loop.run()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 267, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 213, in advance
    batch_output = self.batch_loop.run(kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 88, in advance
    outputs = self.optimizer_loop.run(optimizers, kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 202, in advance
    result = self._run_optimization(kwargs, self._optimizers[self.optim_progress.optimizer_position])
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 249, in _run_optimization
    self._optimizer_step(optimizer, opt_idx, kwargs.get("batch_idx", 0), closure)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 370, in _optimizer_step
    self.trainer._call_lightning_module_hook(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1356, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/core/module.py", line 1742, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/core/optimizer.py", line 169, in step
    step_output = self._strategy.optimizer_step(self._optimizer, self._optimizer_idx, closure, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 234, in optimizer_step
    return self.precision_plugin.optimizer_step(
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/plugins/precision/native_amp.py", line 75, in optimizer_step
    closure_result = closure()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 149, in __call__
    self._result = self.closure(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 135, in closure
    step_output = self._step_fn()
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 419, in _training_step
    training_step_output = self.trainer._call_strategy_hook("training_step", *kwargs.values())
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in training_step
    return self.model.training_step(*args, **kwargs)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 151, in training_step
    model_step_outputs = self.model_step(batch)
  File "/workspace/slotaug/src/models/slotaug_ae_module.py", line 130, in model_step
    matched_idxs = matching_pairs(obj_pos_filtered_aug, obj_pos_filtered_ori2aug) # (B, K)
  File "/workspace/slotaug/src/models/components/slotaug/slotaug_utils.py", line 138, in matching_pairs
    return matching_pairs_(tgt, src)
  File "/workspace/slotaug/src/models/components/slotaug/slotaug_utils.py", line 143, in matching_pairs_
    matched_idxs = np.array([linear_sum_assignment(cost_map[i])[1] for i in range(len(tgt))]) # [B, K]
  File "/workspace/slotaug/src/models/components/slotaug/slotaug_utils.py", line 143, in <listcomp>
    matched_idxs = np.array([linear_sum_assignment(cost_map[i])[1] for i in range(len(tgt))]) # [B, K]
ValueError: matrix contains invalid numeric entries
[2023-05-04 23:01:03,151][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcfr_arbi_crop_v4_wope/2023-05-04_18-39-25_dgx_gpu3
[2023-05-04 23:01:03,152][src.utils.utils][INFO] - Closing loggers...
[2023-05-04 23:01:03,152][src.utils.utils][INFO] - Closing wandb!
[2023-05-05 05:21:28,131][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcfr_arbi_crop_cae1_v2_wope/2023-05-03_17-20-23_dgx_gpu5
[2023-05-05 05:21:28,131][src.utils.utils][INFO] - Closing loggers...
[2023-05-05 05:21:28,131][src.utils.utils][INFO] - Closing wandb!
[2023-05-05 05:58:30,403][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcfr_arbi_crop_cae1_v3_wope_w1over100/2023-05-03_17-20-34_dgx_gpu6
[2023-05-05 05:58:30,404][src.utils.utils][INFO] - Closing loggers...
[2023-05-05 05:58:30,404][src.utils.utils][INFO] - Closing wandb!
[2023-05-05 06:34:07,991][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcfr_arbi_crop_cae1_v1_wope/2023-05-03_17-19-36_dgx_gpu4
[2023-05-05 06:34:07,992][src.utils.utils][INFO] - Closing loggers...
[2023-05-05 06:34:07,992][src.utils.utils][INFO] - Closing wandb!
[2023-05-05 09:48:25,061][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stc_arbi_crop_v3_wope/2023-05-04_18-55-47_dgx_gpu0
[2023-05-05 09:48:25,062][src.utils.utils][INFO] - Closing loggers...
[2023-05-05 09:48:25,062][src.utils.utils][INFO] - Closing wandb!
[2023-05-05 09:48:30,342][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-05 09:48:30,351][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-05 09:48:30,469][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-05-05 09:48:30,476][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-05-05 09:48:31,185][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp126e739k
[2023-05-05 09:48:31,186][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp126e739k/_remote_module_non_sriptable.py
[2023-05-05 09:48:31,225][__main__][INFO] - Instantiating callbacks...
[2023-05-05 09:48:31,226][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-05 09:48:31,230][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-05 09:48:31,231][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-05 09:48:31,232][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-05 09:48:31,233][__main__][INFO] - Instantiating loggers...
[2023-05-05 09:48:31,233][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-05 09:48:48,990][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-05 09:48:49,052][__main__][INFO] - Logging hyperparameters!
[2023-05-05 09:48:49,068][__main__][INFO] - Starting training!
[2023-05-05 12:24:18,524][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_arbi_crop_slota_ark/2023-05-04_11-25-10_dgx_gpu7
[2023-05-05 12:24:18,524][src.utils.utils][INFO] - Closing loggers...
[2023-05-05 12:24:18,525][src.utils.utils][INFO] - Closing wandb!
[2023-05-05 12:24:35,932][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-05-05 13:11:35,086][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stc_arbi_crop_v3_wope/2023-05-05_09-48-30_dgx_gpu0
[2023-05-05 13:11:35,087][src.utils.utils][INFO] - Closing loggers...
[2023-05-05 13:11:35,088][src.utils.utils][INFO] - Closing wandb!
[2023-05-05 13:11:40,410][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcfr_arbi_crop_v2_wope/2023-05-04_18-56-09_dgx_gpu1
[2023-05-05 13:11:40,411][src.utils.utils][INFO] - Closing loggers...
[2023-05-05 13:11:40,411][src.utils.utils][INFO] - Closing wandb!
[2023-05-05 13:11:44,682][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stcfr_arbi_crop_v1_wope/2023-05-04_18-56-45_dgx_gpu2
[2023-05-05 13:11:44,683][src.utils.utils][INFO] - Closing loggers...
[2023-05-05 13:11:44,684][src.utils.utils][INFO] - Closing wandb!
[2023-05-05 17:05:56,738][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-05 17:05:56,746][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-05 17:05:56,841][__main__][INFO] - Instantiating datamodule <src.data.clevr6_datamodule.CLEVR6DataModule>
[2023-05-05 17:05:56,844][__main__][INFO] - Instantiating model <src.models.slota_ae_module.LitSlotAttentionAutoEncoder>
[2023-05-05 17:05:57,503][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpi5e_o9os
[2023-05-05 17:05:57,503][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpi5e_o9os/_remote_module_non_sriptable.py
[2023-05-05 17:05:57,514][__main__][INFO] - Instantiating callbacks...
[2023-05-05 17:05:57,514][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-05 17:05:57,518][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-05 17:05:57,519][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-05 17:05:57,520][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-05 17:05:57,521][__main__][INFO] - Instantiating loggers...
[2023-05-05 17:05:57,521][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-05 17:06:04,462][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-05 17:06:04,469][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-05 17:06:04,564][__main__][INFO] - Instantiating datamodule <src.data.clevr6_datamodule.CLEVR6DataModule>
[2023-05-05 17:06:04,567][__main__][INFO] - Instantiating model <src.models.slota_ae_module.LitSlotAttentionAutoEncoder>
[2023-05-05 17:06:05,160][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpmfkyk6zd
[2023-05-05 17:06:05,161][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpmfkyk6zd/_remote_module_non_sriptable.py
[2023-05-05 17:06:05,171][__main__][INFO] - Instantiating callbacks...
[2023-05-05 17:06:05,172][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-05 17:06:05,176][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-05 17:06:05,177][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-05 17:06:05,178][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-05 17:06:05,178][__main__][INFO] - Instantiating loggers...
[2023-05-05 17:06:05,179][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-05 17:06:15,257][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-05 17:06:15,307][__main__][INFO] - Logging hyperparameters!
[2023-05-05 17:06:15,317][__main__][INFO] - Starting training!
[2023-05-05 17:06:22,825][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-05 17:06:22,873][__main__][INFO] - Logging hyperparameters!
[2023-05-05 17:06:22,882][__main__][INFO] - Starting training!
[2023-05-05 17:07:43,831][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-05 17:07:43,840][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-05 17:07:43,942][__main__][INFO] - Instantiating datamodule <src.data.clevr6_datamodule.CLEVR6DataModule>
[2023-05-05 17:07:43,945][__main__][INFO] - Instantiating model <src.models.slota_ae_module.LitSlotAttentionAutoEncoder>
[2023-05-05 17:07:44,596][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpu2wik66c
[2023-05-05 17:07:44,597][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpu2wik66c/_remote_module_non_sriptable.py
[2023-05-05 17:07:44,608][__main__][INFO] - Instantiating callbacks...
[2023-05-05 17:07:44,608][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-05 17:07:44,613][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-05 17:07:44,614][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-05 17:07:44,615][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-05 17:07:44,616][__main__][INFO] - Instantiating loggers...
[2023-05-05 17:07:44,616][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-05 17:07:51,000][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-05 17:07:51,013][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-05 17:07:51,126][__main__][INFO] - Instantiating datamodule <src.data.clevr6_datamodule.CLEVR6DataModule>
[2023-05-05 17:07:51,129][__main__][INFO] - Instantiating model <src.models.slota_ae_module.LitSlotAttentionAutoEncoder>
[2023-05-05 17:07:51,839][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmppunidpoi
[2023-05-05 17:07:51,839][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmppunidpoi/_remote_module_non_sriptable.py
[2023-05-05 17:07:51,851][__main__][INFO] - Instantiating callbacks...
[2023-05-05 17:07:51,851][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-05 17:07:51,855][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-05 17:07:51,856][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-05 17:07:51,857][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-05 17:07:51,858][__main__][INFO] - Instantiating loggers...
[2023-05-05 17:07:51,858][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-05 17:08:02,324][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-05 17:08:02,383][__main__][INFO] - Logging hyperparameters!
[2023-05-05 17:08:02,392][__main__][INFO] - Starting training!
[2023-05-05 17:08:09,779][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-05 17:08:09,844][__main__][INFO] - Logging hyperparameters!
[2023-05-05 17:08:09,856][__main__][INFO] - Starting training!
[2023-05-06 16:58:00,059][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_arbi_crop_slota_ark/2023-05-05_17-06-04_dgx_gpu5
[2023-05-06 16:58:00,059][src.utils.utils][INFO] - Closing loggers...
[2023-05-06 16:58:00,060][src.utils.utils][INFO] - Closing wandb!
[2023-05-06 16:58:15,255][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-05-06 17:26:41,079][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_arbi_crop_slota_ark_no_res/2023-05-05_17-07-43_dgx_gpu6
[2023-05-06 17:26:41,080][src.utils.utils][INFO] - Closing loggers...
[2023-05-06 17:26:41,080][src.utils.utils][INFO] - Closing wandb!
[2023-05-06 17:26:57,604][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-05-06 17:45:54,894][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_arbi_crop_slota_ark/2023-05-05_17-05-56_dgx_gpu4
[2023-05-06 17:45:54,895][src.utils.utils][INFO] - Closing loggers...
[2023-05-06 17:45:54,895][src.utils.utils][INFO] - Closing wandb!
[2023-05-06 17:46:10,348][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-05-06 17:49:21,119][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_arbi_crop_slota_ark_no_res/2023-05-05_17-07-50_dgx_gpu7
[2023-05-06 17:49:21,120][src.utils.utils][INFO] - Closing loggers...
[2023-05-06 17:49:21,120][src.utils.utils][INFO] - Closing wandb!
[2023-05-06 17:49:30,486][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-06-04 07:01:18,784][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-04 07:01:18,793][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-04 07:01:18,890][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-06-04 07:01:18,897][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-06-04 07:01:19,798][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpppbv6ox6
[2023-06-04 07:01:19,799][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpppbv6ox6/_remote_module_non_sriptable.py
[2023-06-04 07:01:19,840][__main__][INFO] - Instantiating callbacks...
[2023-06-04 07:01:19,840][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-06-04 07:01:19,844][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-06-04 07:01:19,845][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-06-04 07:01:19,846][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-06-04 07:01:19,847][__main__][INFO] - Instantiating loggers...
[2023-06-04 07:01:19,847][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-06-04 07:01:27,950][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-06-04 07:01:28,058][__main__][INFO] - Logging hyperparameters!
[2023-06-04 07:01:28,070][__main__][INFO] - Starting training!
[2023-06-04 07:01:44,425][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stc_1000e_v3_1_10/2023-06-04_07-01-18_dgx_all
[2023-06-04 07:01:44,426][src.utils.utils][INFO] - Closing loggers...
[2023-06-04 07:01:44,427][src.utils.utils][INFO] - Closing wandb!
[2023-06-04 07:22:47,320][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-04 07:22:47,329][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-04 07:22:47,426][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-06-04 07:22:47,429][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-06-04 07:22:48,079][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpls9e48sk
[2023-06-04 07:22:48,080][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpls9e48sk/_remote_module_non_sriptable.py
[2023-06-04 07:22:48,109][__main__][INFO] - Instantiating callbacks...
[2023-06-04 07:22:48,109][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-06-04 07:22:48,114][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-06-04 07:22:48,114][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-06-04 07:22:48,115][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-06-04 07:22:48,116][__main__][INFO] - Instantiating loggers...
[2023-06-04 07:22:48,117][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-06-04 07:22:54,690][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-06-04 07:22:54,789][__main__][INFO] - Logging hyperparameters!
[2023-06-04 07:22:54,799][__main__][INFO] - Starting training!
[2023-06-04 07:23:08,742][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stc_1000e_v3_1_10/2023-06-04_07-22-47_dgx_all
[2023-06-04 07:23:08,742][src.utils.utils][INFO] - Closing loggers...
[2023-06-04 07:23:08,743][src.utils.utils][INFO] - Closing wandb!
[2023-06-04 07:23:23,395][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-06-04 07:23:23,405][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-06-04 07:23:23,504][__main__][INFO] - Instantiating datamodule <src.data.clevr6_aug_datamodule.CLEVR6AugDataModule>
[2023-06-04 07:23:23,507][__main__][INFO] - Instantiating model <src.models.slotaug_ae_module.LitSlotAugAutoEncoder>
[2023-06-04 07:23:24,204][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpm0xfae3h
[2023-06-04 07:23:24,205][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpm0xfae3h/_remote_module_non_sriptable.py
[2023-06-04 07:23:24,232][__main__][INFO] - Instantiating callbacks...
[2023-06-04 07:23:24,232][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-06-04 07:23:24,237][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-06-04 07:23:24,237][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-06-04 07:23:24,238][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-06-04 07:23:24,239][__main__][INFO] - Instantiating loggers...
[2023-06-04 07:23:24,240][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-06-04 07:23:30,285][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-06-04 07:23:30,402][__main__][INFO] - Logging hyperparameters!
[2023-06-04 07:23:30,412][__main__][INFO] - Starting training!
[2023-06-04 07:23:45,385][src.utils.utils][INFO] - Output dir: /workspace/slotaug/logs/train/runs/clv6_stc_1000e_v3_1_10/2023-06-04_07-23-23_dgx_all
[2023-06-04 07:23:45,386][src.utils.utils][INFO] - Closing loggers...
[2023-06-04 07:23:45,386][src.utils.utils][INFO] - Closing wandb!
